<!doctype html><html lang=zh dir=ltr>
<head prefix="og: http://ogp.me/ns#">
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<title>《Unity Shader入门精要》随书彩色插图 – 我的学习博客</title>
<script defer src=/js/fuse.min.32195737929df2c8096e855a5789cbb3f1331224d9169e8705493e7008f47df8.js></script>
<script src=/js/enquire.min.dfb99dee1e029d51d6cfb672d847929890b1585402de17f5ed092edd72a688b4.js></script>
<script defer src=/js/lazysizes.min.fb649fcae62177dfe63e67081ddceb830b5ce1f05a4184e9bbb7d87ac4b8f4e5.js></script>
<script defer src=/js/helper/getParents.min.ccd45f158c1b17849307ba913a72beac239c410f2b6e648496a79842da84e55b.js></script>
<script defer src=/js/helper/fadeinout.min.1d13d3e810c3940e80cbba6216a1c76fbf42b5431fc83537ea6997863802362b.js></script>
<script defer src=/js/helper/closest.min.js></script>
<script>"use strict";window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),String.prototype.includes||(String.prototype.includes=function(b,a){'use strict';if(b instanceof RegExp)throw TypeError('first argument must not be a RegExp');return a===void 0&&(a=0),this.indexOf(b,a)!==-1}),Document.prototype.append=Element.prototype.append=function(){this.appendChild(_mutation(arguments))};function _mutation(a){if(!a.length)throw new Error('DOM Exception 8');if(a.length===1)return typeof a[0]=='string'?document.createTextNode(a[0]):a[0];for(var c=document.createDocumentFragment(),e=a.length,d=-1,b;++d<e;)b=a[d],c.appendChild(typeof b=='string'?document.createTextNode(b):b);return c}String.prototype.startsWith||(String.prototype.startsWith=function(b,a){return a=a||0,this.indexOf(b,a)===a}),document.addEventListener('DOMContentLoaded',function(){var z=document.querySelector('.navbar__burger'),J,F,G,N,U,f,d,V,r,ae,Z,Q,o,g,y,k,b,s,t,P,O,e,C,h,D,B,ai,A,aj,at,ar,ab,aq,E,ap,ao,ah,an,i,j,c,am,S,T,ak,w,W,X,ag,x,n,Y,q,av,au,a,aw,R,m,L,K,I,v,p,u;z?z.addEventListener('click',function(c){var a=document.querySelector('.navbarm__collapse'),b;a&&(b=a.getAttribute('data-open'),b==='true'?(a.setAttribute('data-open','false'),a.style.maxHeight=0,z.classList.remove('is-active')):(a.setAttribute('data-open','true'),a.style.maxHeight=a.scrollHeight+"px",z.classList.add('is-active')))}):null,J=document.querySelectorAll('.single__contents > table');for(let a=0;a<J.length;a++)F=J[a],G=document.createElement('div'),G.className='table-wrapper',F.parentElement.replaceChild(G,F),G.appendChild(F);N=document.querySelectorAll('.footnote-ref'),U=document.querySelectorAll('.footnote-backref'),N?N.forEach(function(a,c){a.onmouseenter=function(){b.classList.contains('scrolling')&&b.classList.remove('scrolling')},a.onmouseleave=function(){b.classList.contains('scrolling')||setTimeout(function(){b.classList.add('scrolling')},100)},a.onclick=function(){b.classList.contains('scrolling')||(b.classList.remove('navbar--show'),b.classList.remove('navbar--hide'),b.classList.add('navbar--hide'))}}):null,U?U.forEach(function(a,c){a.onmouseenter=function(){b.classList.contains('scrolling')&&b.classList.remove('scrolling')},a.onmouseleave=function(){b.classList.contains('scrolling')||setTimeout(function(){b.classList.add('scrolling')},100)},a.onclick=function(){b.classList.contains('scrolling')||(b.classList.remove('navbar--show'),b.classList.remove('navbar--hide'),b.classList.add('navbar--hide'))}}):null,f=document.querySelector('.summary__container'),d=document.querySelector('.search-result'),V=document.querySelector('.search-result__close'),V?V.addEventListener('click',function(a){d.setAttribute('data-display','none'),f.setAttribute('data-display','block')}):null,document.querySelectorAll('.tab')?document.querySelectorAll('.tab').forEach(function(a,d){var e=a.getAttribute('id'),f=a,b=a.querySelectorAll('.tab__link'),c=a.querySelectorAll('.tab__content'),g=[];b&&b.length>0?b.forEach(function(b,d,a){b.onclick=function(e){for(var b=0;b<a.length;b++)d===parseInt(b,10)?a[b].classList.contains('active')||(a[b].classList.add('active'),c[b].style.display='block'):(a[b].classList.remove('active'),c[b].style.display='none')}}):null}):null,document.querySelectorAll('.codetab')?document.querySelectorAll('.codetab').forEach(function(a,d){var e=a.getAttribute('id'),f=a,b=a.querySelectorAll('.codetab__link'),c=a.querySelectorAll('.codetab__content'),g=[];b&&b.length>0?b.forEach(function(b,d,a){b.onclick=function(e){for(var b=0;b<a.length;b++)d===parseInt(b,10)?a[b].classList.contains('active')||(a[b].classList.add('active'),c[b].style.display='block'):(a[b].classList.remove('active'),c[b].style.display='none')}}):null}):null,r=document.getElementById("gtt"),r.style.display="none",r.addEventListener('click',function(){window.document.documentMode?document.documentElement.scrollTop=0:af(250)});function af(a){var b=-window.scrollY/(a/15),c=setInterval(function(){window.scrollY!=0?window.scrollBy(0,b):clearInterval(c)},15)}ae=function(){document.body.scrollTop>250||document.documentElement.scrollTop>250?r.style.display="block":r.style.display="none"},Z=document.querySelectorAll('.expand__button');for(let a=0;a<Z.length;a++)Z[a].addEventListener("click",function(){var a=this.nextElementSibling;a.style.maxHeight?(a.style.maxHeight=null,this.querySelector('svg').classList.add('expand-icon__right'),this.querySelector('svg').classList.remove('expand-icon__down')):(a.style.maxHeight=a.scrollHeight+"px",this.querySelector('svg').classList.remove('expand-icon__right'),this.querySelector('svg').classList.add('expand-icon__down'))});Q=window.pageYOffset||document.documentElement.scrollTop,o=document.querySelector('.toc'),g=o?o.querySelector('#TableOfContents'):null,y=document.getElementById('toggle-toc'),k=document.querySelector('.single__contents'),b=document.querySelector('.navbar'),s=document.querySelector('.toc__flexbox'),t=document.querySelector('.toc__flexbox--outer'),P=document.querySelectorAll('.expand__content'),O=document.querySelectorAll('.box'),e=null,C=JSON.parse("true"),h=JSON.parse('["h2","h3","h4"]'),h?h=h.toString():h="h1, h2, h3, h4, h5, h6",k&&k.querySelectorAll(".tab")?k.querySelectorAll(".tab").forEach(function(a){a.querySelectorAll(h).forEach(function(a){e=Array.isArray(e)?e.concat(a.getAttribute('id')):[a.getAttribute('id')]})}):null,P?P.forEach(function(a){a.querySelectorAll(h).forEach(function(a){e=Array.isArray(e)?e.concat(a.getAttribute('id')):[a.getAttribute('id')]})}):null,O?O.forEach(function(a){a.querySelectorAll(h).forEach(function(a){e=Array.isArray(e)?e.concat(a.getAttribute('id')):[a.getAttribute('id')]})}):null,window.onscroll=function(){ae();var a=window.pageYOffset||document.documentElement.scrollTop;if(a>Q){if(a<250?r.style.display="none":r.style.display="block",a<45)return null;b.classList.contains('scrolling')&&(b.classList.contains('navbar--hide')?b.classList.contains('navbar--show')&&b.classList.remove('navbar--show'):b.classList.add('navbar--hide')),k&&(k.querySelectorAll(h).length>0?k.querySelectorAll(h).forEach(function(c){var b,a;if(y&&!y.checked)return null;if(e&&e.includes(c.getAttribute('id')))return null;document.documentElement.scrollTop>=c.offsetTop&&g&&(b=c.getAttribute('id'),o.querySelectorAll('a').forEach(function(a){a.classList.remove('active')}),o.querySelector('a[href="#'+b+'"]')?o.querySelector('a[href="#'+b+'"]').classList.add('active'):null,!1===C||(g.querySelectorAll('ul')?g.querySelectorAll('ul').forEach(function(a){a.querySelectorAll('li').forEach(function(a){a.querySelectorAll('ul').forEach(function(a){a.style.display='none'})})}):null),a=g.querySelector("[href='#"+b+"']"),a&&a.nextElementSibling&&(a.nextElementSibling.style.display='block'),getParents(a,'ul')?getParents(a,'ul').forEach(function(a){a.style.display='block'}):null)}):(s&&(s.setAttribute('data-position',''),s.classList.contains('hide')||s.classList.add('hide')),t&&(t.setAttribute('data-position',''),t.classList.contains('hide')||t.classList.add('hide'))))}else a<250&&(r.style.display="none"),b.classList.contains('scrolling')&&(b.classList.contains('navbar--hide')?b.classList.remove('navbar--hide'):b.classList.contains('navbar--show')||b.classList.add('navbar--show')),k&&(k.querySelectorAll(h).length>0?k.querySelectorAll(h).forEach(function(c){var b,a;if(y&&!y.checked)return null;if(e&&e.includes(c.getAttribute('id')))return null;document.documentElement.scrollTop>=c.offsetTop&&g&&(b=c.getAttribute('id'),o.querySelectorAll('a').forEach(function(a){a.classList.remove('active')}),o.querySelector('a[href="#'+b+'"]')?o.querySelector('a[href="#'+b+'"]').classList.add('active'):null,!1===C||(g.querySelectorAll('ul')?g.querySelectorAll('ul').forEach(function(a){a.querySelectorAll('li').forEach(function(a){a.querySelectorAll('ul').forEach(function(a){a.style.display='none'})})}):null),a=g.querySelector("[href='#"+b+"']"),a&&a.nextElementSibling&&(a.nextElementSibling.style.display='block'),getParents(a,'ul')?getParents(a,'ul').forEach(function(a){a.style.display='block'}):null)}):(s&&!s.classList.contains('hide')&&s.classList.add('hide'),t&&!t.classList.contains('hide')&&t.classList.add('hide'))),g&&document.documentElement.scrollTop<250&&(!1===C||(g.querySelector('ul')?g.querySelector('ul').querySelectorAll('li').forEach(function(a){a.querySelectorAll('ul').forEach(function(a){a.style.display='none'})}):null));Q=a<=0?0:a},D=localStorage.getItem('theme'),B=document.getElementById('root'),ai=document.querySelectorAll('.select-theme'),A=document.querySelectorAll('.select-theme__item'),aj=JSON.parse('"dark"'),at=JSON.parse('"light"'),ar=JSON.parse('"hacker"'),ab=JSON.parse('"solarized"'),aq=JSON.parse('"kimbie"'),E=function(a){var b=document.getElementsByName('msapplication-TileColor')[0],c=document.getElementsByName('theme-color')[0],d=document.getElementsByName('msapplication-navbutton-color')[0],e=document.getElementsByName('apple-mobile-web-app-status-bar-style')[0];a.includes('dark')?(b.setAttribute('content','#fcfcfa'),c.setAttribute('content','#403E41'),d.setAttribute('content','#403E41'),e.setAttribute('content','#403E41')):a.includes('light')?(b.setAttribute('content','#555'),c.setAttribute('content','#eee'),d.setAttribute('content','#eee'),e.setAttribute('content','#eee')):a.includes('hacker')?(b.setAttribute('content','#e3cd26'),c.setAttribute('content','#252526'),d.setAttribute('content','#252526'),e.setAttribute('content','#252526')):a.includes('solarized')?(b.setAttribute('content','#d3af86'),c.setAttribute('content','#51412c'),d.setAttribute('content','#51412c'),e.setAttribute('content','#51412c')):a.includes('kimbie')&&(b.setAttribute('content','#586e75'),c.setAttribute('content','#eee8d5'),d.setAttribute('content','#eee8d5'),e.setAttribute('content','#eee8d5'))},ap=function(a){if(a===aj)return'dark';if(a===at)return'light';if(a===ar)return'hacker';if(a===ab)return'solarized';if(a===aq)return'kimbie'},D?(A?A.forEach(function(a){a.text.trim()===D?a.classList.add('is-active'):a.classList.remove('is-active')}):null,E(D)):E(B.className),A?A.forEach(function(a,b){a.addEventListener('click',function(c){var a=ap(c.target.text.trim()),b,d;localStorage.setItem('theme',a),E(a),B.removeAttribute('class'),B.classList.add('theme__'+a),ai.forEach(function(b){b.querySelectorAll('a').forEach(function(b){b.classList&&(b.text.trim()===a?b.classList.contains('is-active')||b.classList.add('is-active'):b.classList.contains('is-active')&&b.classList.remove('is-active'))})}),window.mermaid&&(a==="dark"||a==="hacker"?(mermaid.initialize({theme:'dark'}),location.reload()):(mermaid.initialize({theme:'default'}),location.reload())),b=document.getElementById('utterances'),b&&b.querySelector('iframe').contentWindow.postMessage({type:'set-theme',theme:a==="dark"||a==="hacker"?'photon-dark':a==='kimbie'?'github-dark-orange':'github-light'},'https://utteranc.es'),d=document.querySelectorAll('.twitter-timeline'),d&&window.postMessage({type:'set-twitter-theme',theme:a==='light'||a==='solarized'?'light':'dark'})})}):null,ao=JSON.parse('"https://yslinwe.github.io"'),ah=JSON.parse('"https://yslinwe.github.io/posts/unity-shader%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%E9%9A%8F%E4%B9%A6%E5%BD%A9%E8%89%B2%E6%8F%92%E5%9B%BE/"'),an=JSON.parse('""'),i=null,j=null,c=null,am=JSON.parse("true"),S=JSON.parse("100"),T=JSON.parse("0.4"),ak=JSON.parse("true"),w=JSON.parse("true"),W=JSON.parse('"main"'),X=JSON.parse('"posts"'),ag=JSON.parse('"page"'),x=null,am&&function(){var a=new XMLHttpRequest;X==="publication"&&ag!=="page"?a.open('GET',ah+"index.json"):a.open('GET',ao+an+"/index.json"),a.setRequestHeader('Content-Type','application/json; charset=utf-8'),a.onload=function(){a.status===200?(x=new Fuse(JSON.parse(a.response.toString('utf-8')),{keys:X.includes('publication')?['title','abstract']:ak?['title','description','content']:['title','description'],includeMatches:w,shouldSort:!0,threshold:T||.4,location:0,distance:S||100,maxPatternLength:32,minMatchCharLength:1,isCaseSensitive:!1,findAllMatches:!1,useExtendedSearch:!1}),window.fuse=x):console.error('['+a.status+']Error:',a.statusText)},a.send()}();function ac(e,a){var b=document.createElement('li'),c,d;b.className='search-result__item',c=document.createElement('a'),c.innerHTML=a.item.title,c.setAttribute('class','search-result__item--title'),c.setAttribute('href',a.item.permalink),d=document.createElement('div'),d.setAttribute('class','search-result__item--desc'),a.item.description?d.innerHTML=a.item.description:a.item.content&&(d.innerHTML=a.item.content.substring(0,225)),b.appendChild(c),b.appendChild(d),e.appendChild(b)}function al(f,a){var e=document.createElement('li'),b,d,c;if(e.className='search-result__item',b=null,d=document.createElement('a'),d.innerHTML=a.item.title,d.setAttribute('class','search-result__item--title'),d.setAttribute('href',a.item.uri),a.matches&&a.matches.length){for(c=0;c<a.matches.length;c++)'title'===a.matches[c].key&&(d=document.createElement('a'),d.innerHTML=l(a.matches[c].value,a.matches[c].indices),d.setAttribute('class','search-result__item--title'),d.setAttribute('href',a.item.uri)),'description'===a.matches[c].key?(b=document.createElement('div'),b.setAttribute('class','search-result__item--desc'),b.innerHTML=l(a.item.description,a.matches[c].indices)):'content'===a.matches[c].key?b||(b=document.createElement('div'),b.setAttribute('class','search-result__item--desc'),b.innerHTML=l(a.item.content.substring(0,150),a.matches[c].indices)):a.item.description?(b=document.createElement('div'),b.setAttribute('class','search-result__item--desc'),b.innerHTML=a.item.description):(b=document.createElement('div'),b.setAttribute('class','search-result__item--desc'),b.innerHTML=a.item.content.substring(0,150));e.appendChild(d),b&&e.appendChild(b),e&&f.appendChild(e)}}function H(d,c){var a,b;for(i=document.getElementById('search-results'),j=document.getElementById('search-menu'),i.setAttribute('class','dropdown is-active'),a=document.createElement('ul'),a.setAttribute('class','dropdown-content search-content'),c.length?c.forEach(function(b){var e=document.createElement('li'),c=document.createElement('a'),f,d;c.setAttribute('href',b.uri),c.setAttribute('class','dropdown-item'),c.appendChild(e),f=document.createElement('div'),f.innerHTML=b.title,f.setAttribute('class','menu-item__title'),d=document.createElement('div'),d.setAttribute('class','menu-item__desc'),b.description?d.innerHTML=b.description:b.content&&(d.innerHTML=b.content.substring(0,150)),e.appendChild(f),e.appendChild(d),a.appendChild(c)}):(b=document.createElement('li'),b.setAttribute('class','dropdown-item'),b.innerText='No results found',a.appendChild(b));j.hasChildNodes();)j.removeChild(j.lastChild);j.appendChild(a)}function $(d,c){var a,b;for(i=document.getElementById('search-results'),j=document.getElementById('search-menu'),i.setAttribute('class','dropdown is-active'),a=document.createElement('ul'),a.setAttribute('class','dropdown-content search-content'),c.length?c.forEach(function(b){var g=document.createElement('li'),e=document.createElement('a'),c=null,f,d;if(e.setAttribute('href',b.item.uri),e.setAttribute('class','dropdown-item'),e.appendChild(g),f=document.createElement('div'),f.innerHTML=b.item.title,f.setAttribute('class','menu-item__title'),b.matches&&b.matches.length){for(d=0;d<b.matches.length;d++)'title'===b.matches[d].key&&(f.innerHTML=l(b.matches[d].value,b.matches[d].indices)),'description'===b.matches[d].key?(c=document.createElement('div'),c.setAttribute('class','menu-item__desc'),c.innerHTML=l(b.item.description,b.matches[d].indices)):'content'===b.matches[d].key?c||(c=document.createElement('div'),c.setAttribute('class','menu-item__desc'),c.innerHTML=l(b.item.content.substring(0,150),b.matches[d].indices)):b.item.description?(c=document.createElement('div'),c.setAttribute('class','menu-item__desc'),c.innerHTML=b.item.description):(c=document.createElement('div'),c.setAttribute('class','menu-item__desc'),c.innerHTML=b.item.content.substring(0,150));g.appendChild(f),c&&g.appendChild(c),a.appendChild(e)}}):(b=document.createElement('li'),b.setAttribute('class','dropdown-item'),b.innerText='No results found',a.appendChild(b));j.hasChildNodes();)j.removeChild(j.lastChild);j.appendChild(a)}function _(e,c){var a,d;i=document.getElementById('search-mobile-results'),a=document.createElement('div'),a.setAttribute('class','mobile-search__content'),c.length>0?c.forEach(function(b){var c=document.createElement('a');c.setAttribute('href',b.uri),c.innerHTML='<div class="mobile-search__item"><div class="mobile-search__item--title">📄 '+b.title+'</div><div class="mobile-search__item--desc">'+(b.description?b.description:b.content)+'</div></div>',a.appendChild(c)}):(d=document.createElement('span'),a.appendChild(d));let b=document.getElementById('search-mobile-results');while(b.firstChild)b.removeChild(b.firstChild);i.appendChild(a)}function ad(e,c){var a,d;i=document.getElementById('search-mobile-results'),a=document.createElement('div'),a.setAttribute('class','mobile-search__content'),c.length?c.forEach(function(b){var e=document.createElement('li'),g=document.createElement('a'),c=null,f,d;if(g.setAttribute('href',b.item.uri),g.appendChild(e),e.setAttribute('class','mobile-search__item'),f=document.createElement('div'),f.innerHTML=b.item.title,f.setAttribute('class','mobile-search__item--title'),b.matches&&b.matches.length){for(d=0;d<b.matches.length;d++)'title'===b.matches[d].key&&(f.innerHTML=l(b.matches[d].value,b.matches[d].indices)),'description'===b.matches[d].key?(c=document.createElement('div'),c.setAttribute('class','mobile-search__item--desc'),c.innerHTML=l(b.item.description,b.matches[d].indices)):'content'===b.matches[d].key?c||(c=document.createElement('div'),c.setAttribute('class','mobile-search__item--desc'),c.innerHTML=l(b.item.content.substring(0,150),b.matches[d].indices)):b.item.description?(c=document.createElement('div'),c.setAttribute('class','mobile-search__item--desc'),c.innerHTML=b.item.description):(c=document.createElement('div'),c.setAttribute('class','mobile-search__item--desc'),c.innerHTML=b.item.content.substring(0,150));e.appendChild(f),c&&e.appendChild(c),a.appendChild(g)}}):(d=document.createElement('span'),a.appendChild(d));let b=document.getElementById('search-mobile-results');while(b.firstChild)b.removeChild(b.firstChild);i.appendChild(a)}function l(a,d){if(!d)return a;var b='',c=0;return d.forEach(function(d){if(d[0]===d[1])return null;b+=''+a.substring(c,d[0])+'<span class="search__highlight">'+a.substring(d[0],d[1]+1)+'</span>'+'',c=d[1]+1}),b+=a.substring(c),b}n=document.getElementById('search'),Y=document.getElementById('search-mobile'),q=document.getElementById('search-results'),n?n.addEventListener('input',function(b){var a,e;if(!b.target.value|window.innerWidth<770)return q?q.setAttribute('class','dropdown'):null,d?d.setAttribute('data-display','none'):null,f?f.setAttribute('data-display','block'):null,null;c=b.target.value,a=x.search(b.target.value),W==="main"?w?aa(c,a):M(c,a):(w?$(c,a):H(c,a),e=q.querySelectorAll('.dropdown-item'),e?e.forEach(function(a){a.addEventListener('mousedown',function(a){a.target.click()})}):null)}):null,n?n.addEventListener('blur',function(){if(window.innerWidth<770)return null;q?q.setAttribute('class','dropdown'):null}):null,n?n.addEventListener('click',function(b){var a,d;if(window.innerWidth<770)return null;if(!b.target.value)return q?q.setAttribute('class','dropdown'):null,null;c=b.target.value,a=x.search(b.target.value),W==="main"?w?aa(c,a):M(c,a):(w?$(c,a):H(c,a),d=q.querySelectorAll('.dropdown-item'),d?d.forEach(function(a){a.addEventListener('mousedown',function(a){a.target.click()})}):null)}):null,av=document.getElementById("search-menu"),au=document.querySelector('#search-menu .dropdown-item.is-active'),a=null,aw=null,R=350,n?n.addEventListener('keydown',function(c){var b,e;if(window.innerWidth<770)return null;if(c.key==='Escape'&&(d?d.setAttribute('data-display','none'):null,f?f.setAttribute('data-display','block'):null),b=document.querySelectorAll('#search-menu .dropdown-item'),e=c.which||c.keyCode,!b||!b.length)return null;if(c.key==='ArrowDown'||e===40){a===null?(a=0,b[a].classList.remove('is-active')):(b[a].classList.remove('is-active'),a=a===b.length-1?0:a+1),b[a].classList.add('is-active');let c=b[a].offsetTop+b[a].clientHeight-R;c>0?document.querySelector(".search-content").scrollTop+=b[a].getBoundingClientRect().height:a===0&&(document.querySelector(".search-content").scrollTop=0)}else if(c.key==='ArrowUp'||e===38){a===null?(a=b.length-1,b[a].classList.remove('is-active')):(b[a].classList.remove('is-active'),a=a===0?b.length-1:a-1),b[a].classList.add('is-active');let c=b[a].offsetTop+b[a].clientHeight-R;c<0?document.querySelector(".search-content").scrollTop-=b[a].getBoundingClientRect().height:document.querySelector(".search-content").scrollTop=c+b[a].getBoundingClientRect().height}else c.key==='Enter'||e===13?b[a]&&b[a].getAttribute('href')&&(location.href=b[a].getAttribute('href')):(c.key==='Escape'||e===27)&&(c.target.value=null,i&&i.classList.remove('is-active'))}):null,Y?Y.addEventListener('input',function(a){if(!a.target.value){let a=document.getElementById('search-mobile-results');while(a.firstChild)a.removeChild(a.firstChild);return null}c=a.target.value;var b=x.search(a.target.value);_(c,b),w?ad(c,b):_(c,b)}):null,m=document.querySelector('#search-mobile'),L=document.querySelector('.mobile-search'),K=document.querySelectorAll('.navbar-search'),I=document.querySelector('#search-mobile-close'),v=document.querySelector('#search-mobile-container'),p=document.querySelector('#search-mobile-results'),u=document.querySelector('html'),L&&(L.style.display='none'),K?K.forEach(function(a,b){a.addEventListener('click',function(){v&&(v.style.display='block'),m&&m.focus(),u&&(u.style.overflowY='hidden')})}):null,I?I.addEventListener('click',function(){if(v&&(v.style.display='none'),m&&(m.value=''),p)while(p.firstChild)p.removeChild(p.firstChild);u&&(u.style.overflowY='visible')}):null,m?m.addEventListener('keydown',function(a){var b=a.which||a.keyCode;if(a.key==='Escape'||b===27){if(v&&(v.style.display='none'),m&&(m.value=''),p)while(p.firstChild)p.removeChild(p.firstChild);u&&(u.style.overflowY='visible')}}):null;function M(e,a){var g=document.querySelector('.search-result__body'),b=g.querySelector('ul'),c=document.createElement('ul');e?a&&a&&a.length&&(a.forEach(function(a){ac(c,a)}),d?d.setAttribute('data-display','block'):null,f?f.setAttribute('data-display','none'):null):(d?d.setAttribute('data-display','none'):null,f?f.setAttribute('data-display','block'):null),b.parentNode.replaceChild(c,b)}function aa(e,a){var g=document.querySelector('.search-result__body'),b=g.querySelector('ul'),c=document.createElement('ul');e?a&&a&&a.length&&(a.forEach(function(a){al(c,a)}),d?d.setAttribute('data-display','block'):null,f?f.setAttribute('data-display','none'):null):(d?d.setAttribute('data-display','none'):null,f?f.setAttribute('data-display','block'):null),b.parentNode.replaceChild(c,b)}})</script>
<link rel=stylesheet href=/css/main.min.css>
<meta name=description content="好好学习，天天向上。">
<meta name=keywords content="Unity Shader入门精要">
<meta name=created content="2021-06-04T00:00:00+0000">
<meta name=modified content="2021-06-04T00:00:00+0000">
<meta property="article:published_time" content="2021-06-04T00:00:00+0000">
<meta name=author content="冯乐乐">
<meta property="article:author" content="https://yslinwe.github.io/posts/unity-shader%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%E9%9A%8F%E4%B9%A6%E5%BD%A9%E8%89%B2%E6%8F%92%E5%9B%BE/@冯乐乐">
<meta property="og:site_name" content="我的学习博客">
<meta property="og:title" content="《Unity Shader入门精要》随书彩色插图">
<meta property="og:url" content="https://yslinwe.github.io/posts/unity-shader%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%E9%9A%8F%E4%B9%A6%E5%BD%A9%E8%89%B2%E6%8F%92%E5%9B%BE/">
<meta property="og:type" content="article">
<meta property="og:description" content="好好学习，天天向上。">
<meta name=generator content="Hugo 0.89.3">
<meta name=msapplication-TileColor content="#fff">
<meta name=theme-color content="#fff">
<meta name=msapplication-navbutton-color content="#fff">
<meta name=apple-mobile-web-app-status-bar-style content="#fff">
<link rel=canonical href=https://yslinwe.github.io/posts/unity-shader%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%E9%9A%8F%E4%B9%A6%E5%BD%A9%E8%89%B2%E6%8F%92%E5%9B%BE/>
<link rel=manifest href=/manifest.json>
<link rel=apple-touch-icon sizes=57x57 href=/favicon/apple-icon-57x57.png>
<link rel=apple-touch-icon sizes=60x60 href=/favicon/apple-icon-60x60.png>
<link rel=apple-touch-icon sizes=72x72 href=/favicon/apple-icon-72x72.png>
<link rel=apple-touch-icon sizes=76x76 href=/favicon/apple-icon-76x76.png>
<link rel=apple-touch-icon sizes=114x114 href=/favicon/apple-icon-114x114.png>
<link rel=apple-touch-icon sizes=120x120 href=/favicon/apple-icon-120x120.png>
<link rel=apple-touch-icon sizes=144x144 href=/favicon/apple-icon-144x144.png>
<link rel=apple-touch-icon sizes=152x152 href=/favicon/apple-icon-152x152.png>
<link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-icon-180x180.png>
<link rel=icon type=image/png sizes=192x192 href=/favicon/android-icon-192x192.png>
<link rel=icon type=image/png sizes=192x192 href=/favicon/android-icon-512x512.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png>
<link rel=icon type=image/png sizes=96x96 href=/favicon/favicon-96x96.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png>
<meta name=msapplication-TileColor content="#ffffff">
<meta name=msapplication-TileImage content="/ms-icon-144x144.png">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","headline":"《Unity Shader入门精要》随书彩色插图","datePublished":"2021-06-04T00:00:00Z","dateModified":"2021-06-04T00:00:00Z","url":"https://yslinwe.github.io/posts/unity-shader%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%E9%9A%8F%E4%B9%A6%E5%BD%A9%E8%89%B2%E6%8F%92%E5%9B%BE/","description":"Unity Shader入门精要","keywords":["Unity Shader入门精要"],"author":{"@type":"Person","name":"冯乐乐"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://yslinwe.github.io"},"publisher":{"@type":"Organization","name":"我的学习博客","url":"https://yslinwe.github.io"}}</script>
</head>
<body id=root class=theme__dark>
<script>var localTheme=localStorage.getItem('theme');localTheme&&(document.getElementById('root').className='theme__'+localTheme)</script>
<div id=container>
<div class=wrapper data-type=posts data-kind=page>
<nav class="navbar scrolling" role=navigation aria-label="main navigation" data-dir=ltr>
<div class=navbar__brand>
<a href=/ title=主页 rel=home class=navbar__logo-link>
<img src=/logo.png alt=Home class=navbar__logo>
</a>
<a href=/ title=主页 rel=home class=navbar__title-link>
<h6 class=navbar__title>我的学习博客</h6>
</a>
</div>
<div class="theme theme-mobile" data-ani=true>
<div class=dropdown>
<button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" data-ani=true><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentcolor" d="M6.34 7.93c-3.12 3.12-3.12 8.19.0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19.0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41.0L6.34 7.93zM12 19.59c-1.6.0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg>
</button>
<div class="dropdown-content select-theme">
<a href=# class="dropdown-item select-theme__item is-active">
dark
</a>
<a href=# class="dropdown-item select-theme__item">
light
</a>
<a href=# class="dropdown-item select-theme__item">
hacker
</a>
<a href=# class="dropdown-item select-theme__item">
solarized
</a>
<a href=# class="dropdown-item select-theme__item">
kimbie
</a>
</div>
</div>
</div>
<div class="mobile-search__btn navbar-search" data-ani=true><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentcolor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49.0s.41-1.08.0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
</div>
<div id=search-mobile-container class="mobile-search hide" data-dir=ltr>
<div class=mobile-search__top>
<input id=search-mobile type=text aria-label="Mobile Search" placeholder=搜索 class=mobile-search__top--input>
<div id=search-mobile-close class=mobile-search__top--icon><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path opacity=".87" fill="none" d="M0 0h24v24H0V0z"/><path fill="currentcolor" d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41.0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.59-13L12 10.59 8.41 7 7 8.41 10.59 12 7 15.59 8.41 17 12 13.41 15.59 17 17 15.59 13.41 12 17 8.41z"/></svg>
</div>
</div>
<div id=search-mobile-results class=mobile-search__body>
</div>
</div>
<a role=button class=navbar__burger aria-label=menu aria-expanded=false data-ani=true>
<span aria-hidden=true></span>
<span aria-hidden=true></span>
<span aria-hidden=true></span>
</a>
<div class=navbarm__collapse data-open=false>
<ul dir=ltr>
<li class=navbarm__menu--item>
<a href=/about>关于</a>
</li>
<li class=navbarm__menu--item>
<a href=/archive>历史</a>
</li>
<li class=navbarm__menu--item>
<a href=/presentation>PPT</a>
</li>
<li class=navbarm__menu--item>
<a href=/gallery>
艺术<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path fill="currentcolor" d="M8.12 9.29 12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41.0s.39 1.02.0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41.0L6.7 10.7c-.39-.39-.39-1.02.0-1.41.39-.38 1.03-.39 1.42.0z"/></svg>
</a>
</li>
<li class="navbarm__menu--item navbarm__menu--subitem">
<a href=/gallery/photo>图片</a>
</li>
<li class="navbarm__menu--item navbarm__menu--subitem">
<a href=/gallery/video>视频</a>
</li>
<li class="navbarm__menu--item active">
<a href=/posts>博客</a>
</li>
<li class="navbarm__menu--item active">
<a href=/posts>
算法学习<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path fill="currentcolor" d="M8.12 9.29 12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41.0s.39 1.02.0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41.0L6.7 10.7c-.39-.39-.39-1.02.0-1.41.39-.38 1.03-.39 1.42.0z"/></svg>
</a>
</li>
<li class="navbarm__menu--item navbarm__menu--subitem">
<a href=/posts/%e5%89%91%e6%8c%87offer%e7%9b%ae%e5%bd%95>剑指offer</a>
</li>
<li class=navbarm__menu--item>
<a href=/tags class=navbarm__menu--term data-index=0>
标签
</a>
</li>
<li class=navbarm__menu--item>
<a href=/categories class=navbarm__menu--term data-index=1>
分类
</a>
</li>
<li class=navbarm__menu--item>
<a href=/series class=navbarm__menu--term data-index=2>
系列
</a>
</li>
</ul>
</div>
<div class=navbar__menu>
<div class=theme data-ani=true>
<div class=dropdown>
<button class="dropdown-trigger navbar__slide-down" aria-label="Select Theme Button" data-ani=true><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M24 0H0v24h24V0z"/><path fill="currentcolor" d="M6.34 7.93c-3.12 3.12-3.12 8.19.0 11.31C7.9 20.8 9.95 21.58 12 21.58s4.1-.78 5.66-2.34c3.12-3.12 3.12-8.19.0-11.31l-4.95-4.95c-.39-.39-1.02-.39-1.41.0L6.34 7.93zM12 19.59c-1.6.0-3.11-.62-4.24-1.76C6.62 16.69 6 15.19 6 13.59s.62-3.11 1.76-4.24L12 5.1v14.49z"/></svg>
</button>
<div class="dropdown-content select-theme">
<a href=# class="dropdown-item select-theme__item is-active">
dark
</a>
<a href=# class="dropdown-item select-theme__item">
light
</a>
<a href=# class="dropdown-item select-theme__item">
hacker
</a>
<a href=# class="dropdown-item select-theme__item">
solarized
</a>
<a href=# class="dropdown-item select-theme__item">
kimbie
</a>
</div>
</div>
</div>
<a href=/about class="navbar__menu-item navbar__slide-down" dir=ltr data-ani=true>关于</a>
<a href=/archive class="navbar__menu-item navbar__slide-down" dir=ltr data-ani=true>历史</a>
<a href=/presentation class="navbar__menu-item navbar__slide-down" dir=ltr data-ani=true>PPT</a>
<div class="navbar__dropdown navbar__slide-down" data-ani=true>
<a href=/gallery class=navbar__menu-item dir=ltr>
艺术<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path fill="currentcolor" d="M8.12 9.29 12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41.0s.39 1.02.0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41.0L6.7 10.7c-.39-.39-.39-1.02.0-1.41.39-.38 1.03-.39 1.42.0z"/></svg>
</a>
<div class=navbar__dropdown--content>
<a href=/gallery/photo class=navbar__dropdown--item dir=ltr>图片</a>
<a href=/gallery/video class=navbar__dropdown--item dir=ltr>视频</a>
</div>
</div>
<a href=/posts class="navbar__menu-item navbar__slide-down active" dir=ltr data-ani=true>博客</a>
<div class="navbar__dropdown navbar__slide-down" data-ani=true>
<a href=/posts class="navbar__menu-item active" dir=ltr>
算法学习<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path fill="currentcolor" d="M8.12 9.29 12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41.0s.39 1.02.0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41.0L6.7 10.7c-.39-.39-.39-1.02.0-1.41.39-.38 1.03-.39 1.42.0z"/></svg>
</a>
<div class=navbar__dropdown--content>
<a href=/posts/%e5%89%91%e6%8c%87offer%e7%9b%ae%e5%bd%95 class=navbar__dropdown--item dir=ltr>剑指offer</a>
</div>
</div>
</div>
</nav>
<main class="single__main main-main">
<nav class="breadcrumb hide" aria-label=breadcrumbs>
<script>document.querySelector('.breadcrumb').classList.remove('hide')</script>
<ol>
<li>
<a href=https://yslinwe.github.io/ class=capitalize>我的学习博客</a>
</li>
<li>
<a href=https://yslinwe.github.io/posts/ class=capitalize>博客</a>
</li>
<li class=is-active>
<span>《Unity Shader入门精要》随书彩色插图</span>
</li>
</ol>
</nav>
<div class=single>
<div class=single__nojs>Please enable Javascript to view the contents</div>
<script>document.querySelector('.single').classList.remove('hide'),document.querySelector('.single__nojs').classList.add('hide')</script>
<h2 class=single__title data-ani=true>《Unity Shader入门精要》随书彩色插图</h2>
<h3 class=single__subtitle></h3>
<div class=single__meta>
<div class=single__infos>
<time class=single__info title=创建日期>📅&nbsp;2021年06月04日 </time>
&nbsp;&#183;&nbsp; <span class=single__info title=阅读时长> ☕&nbsp;43&nbsp;分钟 </span>
&nbsp;&#183;&nbsp; <span class=single__info title=作者>✍️&nbsp;冯乐乐</span>
<span class=single__info>
</span>
</div>
<ul class="single__tags caption">
🏷️
<li><a href=https://yslinwe.github.io/tags/unity-shader%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81/ class=single__tag title="Unity Shader入门精要">#Unity Shader入门精要</a></li>
</ul>
</div>
<article class=single__contents data-dir=ltr data-ani=true>
<hr>
<p>说明：本页面是书籍《Unity Shader入门精要》的随书彩图集锦，包含了书中所有的插图，使用时可通过图片编号进行搜索。<br>
作者：冯乐乐<br>
邮箱：lelefeng1992@gmail.com</p>
<hr>
<h3 id=前言>前言</h3>
<p><img src=http://static.zybuluo.com/candycat/x27bgzdj1cmfbzxa43z8t5qw/shadertoy.png alt=shadertoy.png-286.5kB></p>
<h3 id=第2章-渲染流水线>第2章 渲染流水线</h3>
<p><img src=http://static.zybuluo.com/candycat/zqt40itigpzl8qkn30m433g6/%E6%B5%81%E6%B0%B4%E7%BA%BF.png alt=流水线.png-83.4kB><br>
图2.1　真实生活中的流水线</p>
<p><img src=http://static.zybuluo.com/candycat/c0opg7bab4cwzyok5vek52hs/%E6%A6%82%E5%BF%B5%E6%B5%81%E6%B0%B4%E7%BA%BF.png alt=概念流水线.png-16.9kB><br>
图2.2 渲染流水线中的三个概念阶段</p>
<p><img src=http://static.zybuluo.com/candycat/qwr4r6aglmod38w2k1e0dq7h/CopyDataToGPU.png alt=CopyDataToGPU.png-86.5kB><br>
图2.3 渲染所需的数据（两张纹理以及3个网格）从硬盘最终加载到显存中。在渲染时，GPU可以快速访问这些数据</p>
<p><img src=http://static.zybuluo.com/candycat/gld5mfj5o10kardzyn10p5a6/SetRenderState.png alt=SetRenderState.png-157.1kB><br>
图2.4 在同一状态下渲染三个网格。由于没有更改渲染状态，因此三个网格的外观看起来像是同一种材质的物体。</p>
<p><img src=http://static.zybuluo.com/candycat/5nuo5d8oh1c8sxexr3d7e935/DrawCall.png alt=DrawCall.png-59.1kB><br>
图2.5 CPU通过调用Draw Call来告诉GPU开始进行一个渲染过程。一个Draw Call会指向本次调用需要渲染的图元列表</p>
<p><img src=http://static.zybuluo.com/candycat/jundxsf604yuoy2zr3r1qkzp/GPU%E6%B5%81%E6%B0%B4%E7%BA%BF.png alt=GPU流水线.png-82.2kB><br>
图2.6 GPU的渲染流水线实现。颜色表示了不同阶段的可配置性或可编程性：绿色表示该流水线阶段是完全可编程控制的，黄色表示该流水线阶段可以配置但不是可编程的，蓝色表示该流水线阶段是由GPU固定实现的，开发者没有任何控制权。实线表示该shader必须由开发者编程实现，虚线表示该Shader是可选的</p>
<p><img src=http://static.zybuluo.com/candycat/07rjqb1pkfipxiizr1nsywuf/VertexShaderProcess.png alt=VertexShaderProcess.png-43kB><br>
图2.7 GPU在每个输入的网格顶点上都会调用顶点着色器。顶点着色器必须进行顶点的坐标变换，需要时还可以计算和输出顶点的颜色。例如，我们可能需要进行逐顶点的光照</p>
<p><img src=http://static.zybuluo.com/candycat/2zpu3oh7n6kpy4rosqtjugcy/Vertex%20Shader.png alt="Vertex Shader.png-34.9kB"><br>
图2.8 顶点着色器会将模型顶点的位置变换到齐次裁剪坐标空间下，进行输出后再由硬件做透视除法得到NDC下的坐标</p>
<p><img src=http://static.zybuluo.com/candycat/08cvo0uahel9ygds4xkwrczp/Clipping.png alt=Clipping.png-25.5kB><br>
图2.9 只有在单位立方体的图元才需要被继续处理。因此，完全在单位立方体外部的图元（红色三角形）被舍弃，完全在单位立方体内部的图元（绿色三角形）将被保留。和单位立方体相交的图元（黄色三角形）会被裁剪，新的顶点会被生成，原来在外部的顶点会被舍弃</p>
<p><img src=http://static.zybuluo.com/candycat/7xtfj07anrw60g4y7cadkd8h/ScreenMapping.png alt=ScreenMapping.png-22.6kB><br>
图2.10 屏幕映射将x、y坐标从（-1, 1）范围转换到屏幕坐标系中</p>
<p><img src=http://static.zybuluo.com/candycat/ul58wnwn76vj0gm20m3xsi9g/Screen%20Mapping_OpenGL_DirectX.png alt="Screen Mapping_OpenGL_DirectX.png-26.9kB"><br>
图2.11 OpenGL和DirectX的屏幕坐标系差异。对于一张512*512大小的图像，在OpenGL中其（0, 0）点在左下角，而在DirectX中其(0, 0)点在左上角</p>
<p><img src=http://static.zybuluo.com/candycat/1ltkl388mkbbzbfgzm28f6gy/TriangleSetupAndTraversal.png alt=TriangleSetupAndTraversal.png-80kB><br>
图2.12 三角形遍历的过程。根据几何阶段输出的顶点信息，最终得到该三角网格覆盖的像素位置。对应像素会生成一个片元，而片元中的状态是对三个顶点的信息进行插值得到的。例如，对图2.12中三个顶点的深度进行插值得到其重心位置对应的片元的深度值为-10.0</p>
<p><img src=http://static.zybuluo.com/candycat/lowfuoi0r43oxfgxkp9darur/FragmentShader.png alt=FragmentShader.png-42.4kB><br>
图2.13 根据上一步插值后的片元信息，片元着色器计算该片元的输出颜色</p>
<p><img src=http://static.zybuluo.com/candycat/epejev04t6vudwsyo2el8rp0/Per-fragment%20Operations.png alt="Per-fragment Operations.png-23.1kB"><br>
图2.14 逐片元操作阶段所做的操作。只有通过了所有的测试后，新生成的片元才能和颜色缓冲区中已经存在的像素颜色进行混合，最后再写入颜色缓冲区中</p>
<p><img src=http://static.zybuluo.com/candycat/28t2ora2kenj1uudwfgfig95/Stencil%20Test_Depth%20Test.png alt="Stencil Test_Depth Test.png-93.5kB"><br>
图2.15 模板测试和深度测试的简化流程图。</p>
<p><img src=http://static.zybuluo.com/candycat/k7q79qcgoqkw8myu1lpuy7he/Blending.png alt=Blending.png-67.6kB><br>
图2.16 混合操作的简化流程图</p>
<p><img src=http://static.zybuluo.com/candycat/kqngym2i5cvgo5bnkpfjabpi/why_early_depth_test.png alt=why_early_depth_test.png-18.7kB><br>
图2.17 图示场景中包含了两个对象：球和长方体，绘制顺序是先绘制球（在屏幕上显示为圆），再绘制长方体（在屏幕上显示为长方形）。如果深度测试在片元着色器之后执行，那么在渲染长方体时，虽然它的大部分区域都被遮挡在球的后面，即它所覆盖的绝大部分片元根本无法通过深度测试，但是我们仍然需要对这些片元执行片元着色器，造成了很大的性能浪费</p>
<p><img src=http://static.zybuluo.com/candycat/4x54y4f2kjlhil8wq7oi1fpa/OpenGL%E5%92%8CDirectX.png alt=OpenGL和DirectX.png-56.1kB><br>
图2.18 CPU、OpenGL/DirectX、显卡驱动和GPU之间的关系</p>
<p><img src=http://static.zybuluo.com/candycat/h9oh7t35lbjrgogxywarmu55/CommandBuffer.png alt=CommandBuffer.png-49.9kB><br>
图2.19 命令缓冲区。CPU通过图像编程接口向命令缓冲区中添加命令，而GPU从中读取命令并执行。黄色方框内的命令就是Draw Call，而红色方框内的命令用于改变渲染状态。我们使用红色方框来表示改变渲染状态的命令， 是因为这些命令往往更加耗时</p>
<p><img src=http://static.zybuluo.com/candycat/pef7ujj1xdzmzwdwz3n261rz/SmallCommand.png alt=SmallCommand.png-107.7kB><br>
图2.20 命令缓冲区中的虚线方框表示GPU已经完成的命令。此时，命令缓冲区中没有可以执行的命令了，GPU处于空闲状态，而CPU还没有准备好下一个渲染命令。</p>
<p><img src=http://static.zybuluo.com/candycat/d6cxj75dc7hnzwd2jlcqlj4j/Batching.png alt=Batching.png-70.3kB><br>
图2.21 利用批处理，CPU在RAM把多个网格合并成一个更大的网格，再发送给GPU，然后在一个Draw Call中渲染它们。但要注意的是，使用批处理合并的网格将会使用同一种渲染状态。也就是说，如果网格之间需要使用不同的渲染状态，那么就无法使用批处理技术</p>
<h3 id=第3章-unity-shader基础>第3章 Unity Shader基础</h3>
<p><img src=http://static.zybuluo.com/candycat/hojqrwubqu22k9jo0ues60hd/material_shader.png alt=material_shader.png-125.8kB><br>
图3.1 Unity Shader和材质。首先创建需要的Unity Shader和材质，然后把Unity Shader赋给材质，并在材质面板上调整属性（如使用的纹理、漫反射系数等）。最后，将材质赋给相应的模型来查看最终的渲染效果</p>
<p><img src=http://static.zybuluo.com/candycat/fupmmv6n7raqei37v4jj6su1/mesh_renderer.png alt=mesh_renderer.png-41kB><br>
图3.2 将材质直接拖曳到模型的Mesh Renderer组件中</p>
<p><img src=http://static.zybuluo.com/candycat/936v924ooiux4x9v9l6nw7w2/material_inspector.png alt=material_inspector.png-119.4kB><br>
图3.3 材质提供了一种可视化的方式来调整着色器中使用的参数</p>
<p><img src=http://static.zybuluo.com/candycat/dwq288k4s50acnc7sx2wz9fp/shader_import_settings.png alt=shader_import_settings.png-38kB><br>
图3.4 Unity Shader的导入设置面板</p>
<p><img src=http://static.zybuluo.com/candycat/wvudje920on69gto9p9jq6bo/shader_compile_code.png alt=shader_compile_code.png-35.9kB><br>
图3.5 Gompile and show code下拉列表</p>
<p><img src=http://static.zybuluo.com/candycat/mfyfmiwipc220l4v8iowww6k/shaderlab_abstract.png alt=shaderlab_abstract.png-63.4kB><br>
图3.6 Unity Shader为控制渲染过程提供了一层抽象。如果没有使用Unity Shader（左图），开发者需要和很多文件和设置打交道，才能让画面呈现出想要的效果；而在Unity Shader的帮助下（右图），开发者只需要使用ShaderLab来编写Unity Shader文件就可以完成所有的工作</p>
<p><img src=http://static.zybuluo.com/candycat/7u7q53pfa4pbtapi9wz9b6f7/shader_name.png alt=shader_name.png-55.5kB><br>
图3.7 在Unity Shader的名称定义中利用 斜杠来组织在材质面板中的位置</p>
<p><img src=http://static.zybuluo.com/candycat/izzjwk3okp3r41uok617ry8t/shaderlab_properties.png alt=shaderlab_properties.png-33.2kB><br>
图3.8 不同属性类型在材质 面板中的显示结果</p>
<p><img src=http://static.zybuluo.com/candycat/55s9cmdps9zqm738ls4ibuho/shader_compile_code.png alt=shader_compile_code.png-35.9kB><br>
图3.9 在Unity Shader的导入设置面板中可以通过Compile and show code按钮来查看Unity对CG片段编译后的代码。通过单击Compile and show code按钮右端的倒三角可以打开下拉菜单，在这个下拉菜单中可以选择编译的平台种类，如只为当前的显卡设备编译特定的汇编代码，或为所有的平台编译汇编代码，我们也可以自定义选择编译到哪些平台上</p>
<h3 id=第4章-学习shader所需的数学基础>第4章 学习Shader所需的数学基础</h3>
<p><img src=http://static.zybuluo.com/candycat/tdhtbh0rhx1dw94fbegmfxg9/little_cow.png alt=little_cow.png-293.5kB><br>
图4.1 我们的农场游戏。我们的主角妞妞是一头长得最壮、好奇心很强的奶牛</p>
<p><img src=http://static.zybuluo.com/candycat/u6pb6kylub8zxfwxotxs3cbm/cartersian_fly.png alt=cartersian_fly.png-28kB><br>
图4.2 传说，笛卡尔坐标系来源于笛卡尔对天花板上一只苍蝇的运动轨迹的观察。笛卡尔发现，可以使用苍蝇距不同墙面的距离来描述它的当前位置</p>
<p><img src=http://static.zybuluo.com/candycat/in4byrrfu29pr19hhfmzaqsw/2d_cartesian.png alt=2d_cartesian.png-36.4kB><br>
图4.3 一个二维笛卡尔坐标系</p>
<p><img src=http://static.zybuluo.com/candycat/s4twn4lnbvlac7ci3mwwbe4d/2d_cartesian_opengl_directx.png alt=2d_cartesian_opengl_directx.png-33.1kB><br>
图4.4 在屏幕映射时，OpenGL和DirectX使用了不同方向的二维笛卡尔坐标系</p>
<p><img src=http://static.zybuluo.com/candycat/9n615pcahnqo38xx5dm8vxpi/cow_cartesian.png alt=cow_cartesian.png-211.8kB><br>
图4.5 笛卡尔坐标系可以让妞妞精确表述自己的位置</p>
<p><img src=http://static.zybuluo.com/candycat/tp39jr06yzo8u4gdzp0z1qqs/3d_cartesian.png alt=3d_cartesian.png-22.7kB><br>
图4.6 一个三维笛卡尔坐标系</p>
<p><img src=http://static.zybuluo.com/candycat/7vdjcritmzv94yosp538yq7w/left_hand.png alt=left_hand.png-40.5kB><br>
图4.7 左手坐标系</p>
<p><img src=http://static.zybuluo.com/candycat/5llpe09e7f8mtdu7h49s88r1/right_hand.png alt=right_hand.png-40kB><br>
图4.8 右手坐标系</p>
<p><img src=http://static.zybuluo.com/candycat/w5i9lq84fphxch5x8tjtzqo2/left_right_hand_rule.png alt=left_right_hand_rule.png-75.3kB><br>
图4.9 用左手法则和右手法则来判断旋转正方向</p>
<p><img src=http://static.zybuluo.com/candycat/i65z04v7mbcufxsjkx7n0n67/cow_left_right.png alt=cow_left_right.png-254.3kB><br>
图4.10 为了移动到新的位置，妞妞需要首先向某个方向平移1个单位，再向另一个方向平移4个单位，最后再向一个方向旋转60°</p>
<p><img src=http://static.zybuluo.com/candycat/janos0r95h321yeoeufigdog/cow_left_right_hand.png alt=cow_left_right_hand.png-295.8kB><br>
图4.11 左图和右图分别表示了在左手坐标系和右手坐标系中描述妞妞这次运动的结果，得到的数学描述是不同的</p>
<p><img src=http://static.zybuluo.com/candycat/7xx63gosl0504rj16wdcnare/unity_cartesian.png alt=unity_cartesian.png-173.2kB><br>
图4.12 在模型空间和世界空间中，Unity使用的是左手坐标系。图中，球的坐标轴显示了它在模型空间中的3个坐标轴（红色为x轴，绿色是y轴，蓝色是z轴）</p>
<p><img src=http://static.zybuluo.com/candycat/lrhkf34n8p5fz7mzyro7r72m/unity_camera_cartesian.png alt=unity_camera_cartesian.png-25.1kB><br>
图4.13 在Unity中，观察空间使用的是右手坐标系，摄像机的前向是z轴的负方向， z轴越小，物体的深度越大，离摄像机越远</p>
<p><img src=http://static.zybuluo.com/candycat/t5slprvqvmndc1yve7x0lquo/exercise_3.png alt=exercise_3.png-130.8kB><br>
图4.14 摄像机的位置是（0, 1, -10），球体的位置是（0, 1, 0）</p>
<p><img src=http://static.zybuluo.com/candycat/8e49l43g2xhp9wfs6r526226/vector.png alt=vector.png-8.9kB><br>
图4.15 一个二维向量以及它的头和尾</p>
<p><img src=http://static.zybuluo.com/candycat/jwojplbtid4z6xiuw7dso9t0/point_vector.png alt=point_vector.png-16.1kB><br>
图4.16 点和矢量之间的关系</p>
<p><img src=http://static.zybuluo.com/candycat/py5slc3wo9v78lpb25xcdas0/vector_scalar.png alt=vector_scalar.png-53.9kB><br>
图4.17 二维矢量和一些标量的乘法和除法</p>
<p><img src=http://static.zybuluo.com/candycat/2y7rr3t5j8bct6ocnlvpydp6/vector_add_sub.png alt=vector_add_sub.png-52.8kB><br>
图4.18 二维矢量的加法和减法</p>
<p><img src=http://static.zybuluo.com/candycat/051rzkws7n2ii9wep4b04t8f/vector_displacement.png alt=vector_displacement.png-22.5kB><br>
图4.19 使用矢量减法来计算从点a到点b的位移</p>
<p><img src=http://static.zybuluo.com/candycat/lk35xmttonr0qliblc5v5lpu/vector_magnitude.png alt=vector_magnitude.png-8.2kB><br>
图4.20 矢量的模</p>
<p><img src=http://static.zybuluo.com/candycat/mqfl49yeebwbqtc23i755qux/unit_vector.png alt=unit_vector.png-30.7kB><br>
图4.21 二维空间的单位矢量都会落在单位圆上</p>
<p><img src=http://static.zybuluo.com/candycat/rlo1hwsdb334yi9i9vimdtko/projection.png alt=projection.png-17.7kB><br>
图4.22 矢量b在单位矢量a方向上的投影</p>
<p><img src=http://static.zybuluo.com/candycat/wet7zoq1bssb0u8gm63zfmx6/dot_sign.png alt=dot_sign.png-22.9kB><br>
图4.23 点积的符号</p>
<p><img src=http://static.zybuluo.com/candycat/xnouckzvbcb59nqcanijjpx7/dot_cos.png alt=dot_cos.png-14.1kB><br>
图4.24 两个单位矢量进行点积</p>
<p><img src=http://static.zybuluo.com/candycat/yrl5ol849v5h8892l4bqlgrh/vector_cross_diagram.png alt=vector_cross_diagram.png-32.1kB><br>
图4.25 三维矢量叉积的计算规律。不同颜色的线表示了计算结果矢量中对应颜色的分量的计算路径。以红色为例，即结果矢量的第一个分量，它是从第一个矢量的y分量出发乘以第二个矢量的z分量，再减去第一个矢量的z分量和第二矢量的y分量的乘积</p>
<p><img src=http://static.zybuluo.com/candycat/fh9vcn0q1g5te175pqg9beu3/vector_cross_length.png alt=vector_cross_length.png-13kB><br>
图4.26 使用矢量a和矢量b构建一个平行四边形</p>
<p><img src=http://static.zybuluo.com/candycat/0d3l6dqc7q6d3h6vxkqjqo99/vector_cross.png alt=vector_cross.png-27.2kB><br>
图4.27 分别使用左手坐标系和右手坐标系得到的叉积结果</p>
<p><img src=http://static.zybuluo.com/candycat/t6i0a60k7rd05a5url0wljcl/vector_cross_right_hand.png alt=vector_cross_right_hand.png-46.6kB><br>
图4.28 使用右手法则判断右手坐标系中a×b的方向</p>
<p><img src=http://static.zybuluo.com/candycat/5oy7iqjnkyi69v1d2sayhxf0/exercise_cross.png alt=exercise_cross.png-26.1kB><br>
图4.29 三角形的三个顶点位于xy平面上，人眼位于z轴负方向，向z轴正方向观察</p>
<p><img src=http://static.zybuluo.com/candycat/u6urub3wacveq0qcr6112we5/matrix_mul.png alt=matrix_mul.png-25kB><br>
图4.30 计算c23的过程</p>
<p><img src=http://static.zybuluo.com/candycat/ncg6g1ragp0bfufbm2m3ir2m/niuniu.png alt=niuniu.png-273.2kB><br>
图4.31 场景中的妞妞（左图）和屏幕上的妞妞（右图）。妞妞想知道，自己的鼻子是如何被画到屏幕上的</p>
<p><img src=http://static.zybuluo.com/candycat/o85jqc1fw9rt10f0n485y9vt/object_space.png alt=object_space.png-84.5kB><br>
图4.32 在我们的农场游戏中，每个奶牛都有自己的模型坐标系。在模型坐标系中妞妞鼻子的位置是(0, 2, 4, 1)</p>
<p><img src=http://static.zybuluo.com/candycat/drp1660u59nwnw8d2hvb0rrg/unity_transform.png alt=unity_transform.png-151.9kB><br>
图4.33 Unity的Transform组件可以调节模型的位置.如果Transform有父节点，如图中的“Mesh”，那么Position将是在其父节点（这里是“Cow”）的模型空间中的位置；如果没有父节点，Position就是在世界空间中的位置</p>
<p><img src=http://static.zybuluo.com/candycat/ozup3egxnxqp21otm4z6jzhx/world_space.png alt=world_space.png-378.7kB><br>
图4.34 农场游戏中的世界空间。世界空间的原点被放置在农场的中心。左下角显示了妞妞在世界空间中所做的变换。我们想要把妞妞的鼻子从模型空间变换到世界空间中</p>
<p><img src=http://static.zybuluo.com/candycat/8q0v8m4wwkm2h9homadyeear/camera_space.png alt=camera_space.png-346.2kB><br>
图4.35 农场游戏中摄像机的观察空间。观察空间的原点位于摄像机处。注意在观察空间中，摄像机的前向是z轴的负方向（图中只画出了z轴正方向），这是因为Unity在观察空间中使用了右手坐标系。左下角显示了摄像机在世界空间中所做的变换。我们想要把妞妞的鼻子从世界空间变换到观察空间中</p>
<p><img src=http://static.zybuluo.com/candycat/wqkekwazaaordawbq21nj7hz/camera_projection.png alt=camera_projection.png-299.3kB><br>
图4.36 透视投影（左图）和正交投影（右图）。左下角分别显示了当前摄像机的投影模式和相关属性</p>
<p><img src=http://static.zybuluo.com/candycat/b6wiym3nlkwimvnvgjgohhbz/camera_frustum.png alt=camera_frustum.png-301.2kB><br>
图4.37 视锥体和裁剪平面。左图显示了透视投影的视锥体，右图显示了正交投影的视锥体</p>
<p><img src=http://static.zybuluo.com/candycat/j6w23tgb5a1acjq6mr73ietq/projection_frustum.png alt=projection_frustum.png-67.3kB><br>
图4.38 透视摄像机的参数对透视投影视锥体的影响</p>
<p><img src=http://static.zybuluo.com/candycat/tddwy4107pnswnbxydxc2rsp/projection_matrix0.png alt=projection_matrix0.png-135.1kB><br>
图4.39 在透视投影中，投影矩阵对顶点进行了缩放。图3.38中标注了4个关键点经过投影矩阵变换后的结果。从这些结果可以看出x、y、z和w分量的范围发生的变化</p>
<p><img src=http://static.zybuluo.com/candycat/0r3xdlarpzqf94nfb304qihx/orthographic_frustum.png alt=orthographic_frustum.png-33.5kB><br>
图4.40 正交摄像机的参数对正交投影视锥体的影响</p>
<p><img src=http://static.zybuluo.com/candycat/2j2ea1iexjim88y8towjkjlz/orthographic_matrix0.png alt=orthographic_matrix0.png-129.6kB><br>
图4.41 在正交投影中，投影矩阵对顶点进行了缩放。图中标注了4个关键点经过投影矩阵变换后的结果。从这些结果可以看出x、y、z和w分量范围发生的变化</p>
<p><img src=http://static.zybuluo.com/candycat/si6bqxafh76xku3i0bxp91lq/cow_camera.png alt=cow_camera.png-180.1kB><br>
图4.42 农场游戏使用的摄像机参数和游戏画面的横纵比</p>
<p><img src=http://static.zybuluo.com/candycat/7ozeba0c8nex3o4zr9z9nt4v/projection_matrix1.png alt=projection_matrix1.png-131kB><br>
图4.43 经过齐次除法后，透视投影的裁剪空间会变换到一个立方体</p>
<p><img src=http://static.zybuluo.com/candycat/8921u8zbn1m38conxbed0nz5/orthographic_matrix1.png alt=orthographic_matrix1.png-105.6kB><br>
图4.44 经过齐次除法后，正交投影的裁剪空间会变换到一个立方体</p>
<p><img src=http://static.zybuluo.com/candycat/z0ibvp779phr1hb0l902n1qy/vertex_conversion.png alt=vertex_conversion.png-100.9kB><br>
图4.45 渲染流水线中顶点的空间变换过程</p>
<p><img src=http://static.zybuluo.com/candycat/jxcomxjmrye6rczmlyw550wt/space_handness.png alt=space_handness.png-75.6kB><br>
图4.46 Unity中各个坐标空间的旋向性</p>
<p><img src=http://static.zybuluo.com/candycat/cjevn0tuacb13ssus1sj8ceo/normal_tangent.png alt=normal_tangent.png-167.3kB><br>
图4.47 顶点的切线和法线。切线和法线互相垂直</p>
<p><img src=http://static.zybuluo.com/candycat/80ofuzudfjzrrl8r1gcxinse/transform_normal.png alt=transform_normal.png-40.6kB><br>
图4.48 进行非统一缩放时，如果使用和变换顶点相同的变换矩阵来变换法线，就会得到错误的结果，即变换后的法线方向与平面不再垂直</p>
<p><img src=http://static.zybuluo.com/candycat/9puxwch79e92gzv5xfrsh3qm/screen_coord.png alt=screen_coord.png-9kB><br>
图4.49 由片元的像素位置得到的图像</p>
<p><img src=http://static.zybuluo.com/candycat/zvcl27rgm897ir8w18m1bii2/difference_between_left_right.png alt=difference_between_left_right.png-54.6kB><br>
图4.50 图中两个坐标系的x轴和y轴是重合的，区别仅在于z轴的方向。左手坐标系的（0, 0, 1）点和右手坐标系中的（0, 0, 1）点是不同的，但它们旋转后的点却对应到了同一点</p>
<p><img src=http://static.zybuluo.com/candycat/akhas8nqu68ps3rd1kuhi0hf/difference_between_left_right_2.png alt=difference_between_left_right_2.png-59.4kB><br>
图4.51 绝对空间中的同一点，在左手和右手坐标系中进行同样角度的旋转，其旋转方向是不一样的。在左手坐标系中将按顺时针方向旋转，在右手坐标系中将按逆时针方向旋转</p>
<p><img src=http://static.zybuluo.com/candycat/tw8il4lajuaf6dxx7l0yj9zd/exercise_cross2.png alt=exercise_cross2.png-34.4kB><br>
图4.52 在左手坐标系中，如果叉积结果为负，那么3点的顺序是顺时针方向</p>
<h3 id=第5章-开始unity-shader学习之旅>第5章 开始Unity Shader学习之旅</h3>
<p><img src=http://static.zybuluo.com/candycat/9b4lok82evuyq772bhbnnl6x/new_scene.png alt=new_scene.png-74.3kB><br>
图5.1 在Unity 5中新建一个场景得到的效果</p>
<p><img src=http://static.zybuluo.com/candycat/4se9aphevcooho5wm1bsqxm0/simple_shader.png alt=simple_shader.png-25.4kB><br>
图5.2 用一个最简单的顶点/片元着色器得到一个白色的球</p>
<p><img src=http://static.zybuluo.com/candycat/umffe4syp5ttjtilp9ydyd2k/cginclude.png alt=cginclude.png-27kB><br>
图5.3 Unity的内置着色器</p>
<p><img src=http://static.zybuluo.com/candycat/yao0f655aycbk2kehmleei2p/false_color.png alt=false_color.png-192.9kB><br>
图5.4 用假彩色对Unity Shader进行调试</p>
<p><img src=http://static.zybuluo.com/candycat/tx3a01nq92yshsc1y72n6s4j/color_picker.png alt=color_picker.png-53.8kB><br>
图5.5 使用颜色拾取器来查看调试信息</p>
<p><img src=http://static.zybuluo.com/candycat/dx8svpr4bxtegcns8e50lgf6/frame_debugger.png alt=frame_debugger.png-218.7kB><br>
图5.6 帧调试器</p>
<p><img src=http://static.zybuluo.com/candycat/11gb131ywty31xni4smc77ol/frame_debugger_0.png alt=frame_debugger_0.png-164.5kB><br>
图5.7 单击Knot的深度图渲染事件，在Game视图会显示该事件的效果，在Hierarchy视图中会高亮显示Knot对象，在帧调试器的右侧窗口会显示出该事件的细节</p>
<p><img src=http://static.zybuluo.com/candycat/ninmtxykcrk7oywzvxirhn04/2d_cartesian_opengl_directx.png alt=2d_cartesian_opengl_directx.png-33.1kB><br>
图5.8 OpenGL和DirectX使用了不同的屏幕空间坐标</p>
<h3 id=第6章-unity中的基础光照>第6章 Unity中的基础光照</h3>
<p><img src=http://static.zybuluo.com/candycat/tzgu5oq816ojbkjo4y05rvij/irradiance.png alt=irradiance.png-60.3kB><br>
图6.1 在左图中，光是垂直照射到物体表面，因此光线之间的垂直距离保持不变；而在右图中，光是斜着照射到物体表面，在物体表面光线之间的距离是d/cosθ，因此单位面积上接收到的光线数目要少于左图</p>
<p><img src=http://static.zybuluo.com/candycat/7gu6p5xdmzngz53iaa011joy/scattering.png alt=scattering.png-37.1kB><br>
图6.2 散射时，光线会发生折射和反射现象。对于不透明物体，折射的光线会在物体内部继续传播，最终有一部分光线会重新从物体表面被发射出去</p>
<p><img src=http://static.zybuluo.com/candycat/51iph9ayl3l22w3xuzeumwxf/specular.png alt=specular.png-31.2kB><br>
图6.3 使用Phong模型计算高光反射</p>
<p><img src=http://static.zybuluo.com/candycat/nntler7jilkso6zufrbw447c/Blinn.png alt=Blinn.png-32.1kB><br>
图6.4 Blinn模型</p>
<p><img src=http://static.zybuluo.com/candycat/4pgo8idyb8gsjlq5xbynoj8d/ambient.png alt=ambient.png-35.3kB><br>
图6.5 在Unity的Window -> Lighting面板中，我们可以通过Ambient Source/Ambient Color/Ambient Intensity来控制场景中的环境光的颜色和强度</p>
<p><img src=http://static.zybuluo.com/candycat/tow3hbf8of391rb7sumri3sy/diffuse_vertex_level.png alt=diffuse_vertex_level.png-40.4kB><br>
图6.6 逐顶点的漫反射光照效果</p>
<p><img src=http://static.zybuluo.com/candycat/6vlfiln2hnmhndp3m5uma9bs/diffuse_pixel_level.png alt=diffuse_pixel_level.png-40.1kB><br>
图6.7 逐像素的漫反射光照效果</p>
<p><img src=http://static.zybuluo.com/candycat/kc9sg9dsvf7i23my26yii8gt/diffuse_compare_all.png alt=diffuse_compare_all.png-86.9kB><br>
图6.8 逐顶点漫反射光照、逐像素漫反射光照、半兰伯特光照的对比效果</p>
<p><img src=http://static.zybuluo.com/candycat/zldeemd0807hp485mkgp6qkr/reflect.png alt=reflect.png-9.2kB><br>
图6.9 CG的reflect函数</p>
<p><img src=http://static.zybuluo.com/candycat/zw9y4jmxj7pivjakhb2tjcnm/specular_vertex_level.png alt=specular_vertex_level.png-41.5kB><br>
图6.10 逐顶点的高光反射光照效果</p>
<p><img src=http://static.zybuluo.com/candycat/ze75kza2bpckowcdfcuqsqx6/specular_pixel_level.png alt=specular_pixel_level.png-40.8kB><br>
图6.11 逐像素的高光反射光照效果</p>
<p><img src=http://static.zybuluo.com/candycat/5d2r1xz062iykspwapu0txq1/specular_compare_all.png alt=specular_compare_all.png-82.5kB><br>
图6.12 逐顶点的高光反射光照、逐像素的高光反射光照（Phong光照模型）和Blinn-Phong高光反射光照的对比结果</p>
<h3 id=第7章-基础纹理>第7章 基础纹理</h3>
<p><img src=http://static.zybuluo.com/candycat/rcl2u5im3ef0pb1esf4pvz06/texture_coordinate.png alt=texture_coordinate.png-349.3kB><br>
图7.1 Unity中的纹理坐标</p>
<p><img src=http://static.zybuluo.com/candycat/90xmbvepdh5lywclqutr989j/single_texture.png alt=single_texture.png-71.3kB><br>
图7.2 使用单张纹理</p>
<p><img src=http://static.zybuluo.com/candycat/p60yfqpxafslgw0b8m3t2vd6/texture_tiling_offset.png alt=texture_tiling_offset.png-16.9kB><br>
图7.3 调节纹理的平铺（缩放）和偏移（平移）属性</p>
<p><img src=http://static.zybuluo.com/candycat/nfnonexamcr821gvsqfwm0rc/texture_properties.png alt=texture_properties.png-29kB><br>
图7.4 纹理的属性</p>
<p><img src=http://static.zybuluo.com/candycat/fs3ikv46cf3h1rumombx5toy/wrap_mode.png alt=wrap_mode.png-68.9kB><br>
图7.5 Wrap Mode决定了当纹理坐标超过[0, 1]范围后将会如何被平铺</p>
<p><img src=http://static.zybuluo.com/candycat/3pu5fg044fhfd9zcvhmx1mue/texture_offset.png alt=texture_offset.png-68.4kB><br>
图7.6 偏移（Offset）属性决定了纹理坐标的偏移量</p>
<p><img src=http://static.zybuluo.com/candycat/e15n8gjm48ldr8eoavr7p7k1/magnification.png alt=magnification.png-256.2kB><br>
图7.7 在放大纹理时，分别使用三种Filter Mode得到的结果</p>
<p><img src=http://static.zybuluo.com/candycat/jtlnp9o3hnkv4sapauejzudg/mipmap.png alt=mipmap.png-35.9kB><br>
图7.8 在Advanced模式下可以设置多级渐远纹理的相关属性</p>
<p><img src=http://static.zybuluo.com/candycat/jphpd33ux984u48qtrebzb93/minification.png alt=minification.png-271.9kB><br>
图7.9 从上到下： Point滤波 + 多级渐远纹理技术，Bilinear滤波 + 多级渐远纹理技术，Trilinear滤波 + 多级渐远纹理技术</p>
<p><img src=http://static.zybuluo.com/candycat/3tqq3cu9wdo0z874ukzje19h/texture_quality.png alt=texture_quality.png-31.7kB><br>
图7.10 选择纹理的最大尺寸和纹理模式</p>
<p><img src=http://static.zybuluo.com/candycat/679mbns3qqorjgdlzjd9f64w/heightmap.png alt=heightmap.png-134.5kB><br>
图7.11 高度图</p>
<p><img src=http://static.zybuluo.com/candycat/fpgdxhkx2vrfag4wpxkubh08/tangent_space.png alt=tangent_space.png-165.3kB><br>
图7.12 模型顶点的切线空间。其中，原点对应了顶点坐标，x轴是切线方向（t），y轴是副切线方向（b），z轴是法线方向（n）</p>
<p><img src=http://static.zybuluo.com/candycat/cn4bj1pud3ttm5mrlfa4l891/object_tangent_space_normal.png alt=object_tangent_space_normal.png-320.3kB><br>
图7.13 左图：模型空间下的法线纹理。右图：切线空间下的法线纹理</p>
<p><img src=http://static.zybuluo.com/candycat/xwv6ca3g9fdhlnu1a48lw1o4/normal_map.png alt=normal_map.png-92.2kB><br>
图7.14 使用法线纹理</p>
<p><img src=http://static.zybuluo.com/candycat/ewkjgj08b94xafdzgroq7wgh/bump_scale.png alt=bump_scale.png-140.5kB><br>
图7.15 使用Bump Scale属性来调整模型的凹凸程度</p>
<p><img src=http://static.zybuluo.com/candycat/98ol95g0rx90mbdan3fiw4n7/texture_type_normal.png alt=texture_type_normal.png-29.8kB><br>
图7.16 当使用UnpackNormal函数计算法线纹理中的法线方向时，需要把纹理类型标识为Normal map</p>
<p><img src=http://static.zybuluo.com/candycat/nd93fm3dgv4obtkxjo6dg2sg/texture_type_heightmap.png alt=texture_type_heightmap.png-293.4kB><br>
图7.17 当勾选了Create from Grayscale后，Unity会根据高度图来生成一张切线空间下的法线纹理</p>
<p><img src=http://static.zybuluo.com/candycat/lqani27ay2sk4r52hgvz7fx1/ramp_texture.png alt=ramp_texture.png-119.2kB><br>
图7.18 使用不同的渐变纹理控制漫反射光照，左下角给出了每张图使用的渐变纹理</p>
<p><img src=http://static.zybuluo.com/candycat/0wnw5wpwv2stmazzurh32jpt/ramp_texture_wrap_mode.png alt=ramp_texture_wrap_mode.png-114.2kB><br>
图7.19 Wrap Mode分别为Repeat和Clamp模式的效果对比</p>
<p><img src=http://static.zybuluo.com/candycat/h82ljkimcijox5hwj7ftpymy/mask_specular.png alt=mask_specular.png-142.4kB><br>
图7.20 使用高光遮罩纹理。从左到右：只包含漫反射，未使用遮罩的高光反射，使用遮罩的高光反射</p>
<p><img src=http://static.zybuluo.com/candycat/bu4eyurnenwal307dwbhzp2r/mask.png alt=mask.png-671.4kB><br>
图7.21 本节使用的高光遮罩纹理</p>
<h3 id=第8章-透明效果>第8章 透明效果</h3>
<p><img src=http://static.zybuluo.com/candycat/48l0aapqc57v0gn367tk2akx/render_order_0.png alt=render_order_0.png-10.7kB><br>
图8.1 场景中有两个物体，其中A（黄色）是半透明物体，B（紫色）是不透明物体</p>
<p><img src=http://static.zybuluo.com/candycat/5k524ddo8qib31j6s4mhkekh/render_order_1.png alt=render_order_1.png-10.5kB><br>
图8.2 场景中有两个物体，其中A和B都是半透明物体</p>
<p><img src=http://static.zybuluo.com/candycat/sl85989h54upaju75zstyv0y/render_order_3.png alt=render_order_3.png-15.3kB><br>
图8.3 循环重叠的半透明物体总是无法得到正确的半透明效果</p>
<p><img src=http://static.zybuluo.com/candycat/hi3bbsss5t48uvmi83uzjle8/render_order_2.png alt=render_order_2.png-30.4kB><br>
图8.4 使用哪个深度对物体进行排序。红色点分别标明了网格上距离摄像机最近的点、最远的点以及网格中点</p>
<p><img src=http://static.zybuluo.com/candycat/fq123k86x5alcbccjmv7gogl/transparent_texture.png alt=transparent_texture.png-71.9kB><br>
图8.5 一张透明纹理，其中每个方格的透明度都不同</p>
<p><img src=http://static.zybuluo.com/candycat/w3n0yyn3rfwc0wv4dw7i02d2/alpha_test.png alt=alpha_test.png-55.9kB><br>
图8.6 透明度测试</p>
<p><img src=http://static.zybuluo.com/candycat/a4hmfr1eltd6shzthle7ed5q/alpha_test_0.png alt=alpha_test_0.png-166.4kB><br>
图8.7 随着Alpha cutoff参数的增大，更多的像素由于不满足透明度测试条件而被剔除</p>
<p><img src=http://static.zybuluo.com/candycat/0voinls84at3n3mg77a13tdu/alpha_blend.png alt=alpha_blend.png-55.1kB><br>
图8.8 透明度混合</p>
<p><img src=http://static.zybuluo.com/candycat/5a1af3bgca3z399huyud2kwr/alpha_blend_0.png alt=alpha_blend_0.png-138.7kB><br>
图8.9 随着Alpha Scale参数的增大，模型变得越来越透明</p>
<p><img src=http://static.zybuluo.com/candycat/4thev7v5xczq02bz824witrf/transparent_order_wrong.png alt=transparent_order_wrong.png-94.7kB><br>
图8.10 当模型网格之间有互相交叉的结构时，往往会得到错误的半透明效果</p>
<p><img src=http://static.zybuluo.com/candycat/1vknx9ilky82q0kmqnxns8aj/alpha_blend_zwrite.png alt=alpha_blend_zwrite.png-87.9kB><br>
图8.11 开启了深度写入的半透明效果</p>
<p><img src=http://static.zybuluo.com/candycat/uvoq8qpet472e7fquzdu479t/blend.png alt=blend.png-74.1kB><br>
图8.12 不同混合状态设置得到的效果</p>
<p><img src=http://static.zybuluo.com/candycat/zcu57h732mubbea9ib45wx9u/alpha_test_both_sided.png alt=alpha_test_both_sided.png-60.7kB><br>
图8.13 双面渲染的透明度测试的物体</p>
<p><img src=http://static.zybuluo.com/candycat/4tq24631e9aug7xswikf9awc/alpha_blend_both_sided.png alt=alpha_blend_both_sided.png-66.2kB><br>
图8.14 双面渲染的透明度混合的物体</p>
<h3 id=第9章-更复杂的光照>第9章 更复杂的光照</h3>
<p><img src=http://static.zybuluo.com/candycat/n67qqzd3bc0q3gca2heih70h/rendering_path_setting.png alt=rendering_path_setting.png-30kB><br>
图9.1 设置Unity项目的渲染路径</p>
<p><img src=http://static.zybuluo.com/candycat/7wi9c0vibxtig4s1r45bugri/rendering_path_camera.png alt=rendering_path_camera.png-37.8kB><br>
图9.2 摄像机组件的Rendering Path中的设置可以覆盖Project Settings中的设置</p>
<p><img src=http://static.zybuluo.com/candycat/skolpwg0h7zzcey4gtl1rvc9/light_type_mode.png alt=light_type_mode.png-30.6kB><br>
图9.3 设置光源的类型和渲染模式</p>
<p><img src=http://static.zybuluo.com/candycat/575lq2zgnsaop3nw2miyobt3/forward_rendering.png alt=forward_rendering.png-175.5kB><br>
图9.4 前向渲染的两种Pass</p>
<p><img src=http://static.zybuluo.com/candycat/uadla1q69533nc71z7g7ep0g/directional_ligth.png alt=directional_ligth.png-51.6kB><br>
图9.5 平行光</p>
<p><img src=http://static.zybuluo.com/candycat/tvbpd08wgc0s1o31v4nw20ad/point_ligtht.png alt=point_ligtht.png-89.4kB><br>
图9.6 点光源</p>
<p><img src=http://static.zybuluo.com/candycat/8cpddt5rwnxg6ox6bml57ld7/enable_light.png alt=enable_light.png-63.6kB><br>
图9.7 开启Scene视图中的光照</p>
<p><img src=http://static.zybuluo.com/candycat/tx45g2n04xypq5cdlyblecrv/spot_light.png alt=spot_light.png-74.5kB><br>
图9.8 聚光灯</p>
<p><img src=http://static.zybuluo.com/candycat/bz1q9kyglm17psychsn255aq/two_lights.png alt=two_lights.png-79.4kB><br>
图9.9 使用一个平行光和一个点光源共同照亮物体。右图显示了胶囊体、平行光和点光源在场景中的相对位置</p>
<p><img src=http://static.zybuluo.com/candycat/z4lor2cgc0gh8rwfjimk0ckq/multi_lights.png alt=multi_lights.png-56.6kB><br>
图9.10 使用1个平行光 + 4个点光源照亮一个物体</p>
<p><img src=http://static.zybuluo.com/candycat/78c7qwpppd0h5baure1l9t1q/frame_debugger.png alt=frame_debugger.png-103.3kB><br>
图9.11 打开帧调试器查看场景的绘制事件</p>
<p><img src=http://static.zybuluo.com/candycat/e4ruexwdln51zl9nrj8s6yrl/multi_lights_0.png alt=multi_lights_0.png-218.4kB><br>
图9.12 本例中的6个渲染事件，绘制顺序是从左到右、从上到下进行的</p>
<p><img src=http://static.zybuluo.com/candycat/d1wgzjrprligehvkdmq23pra/multi_lights_1.png alt=multi_lights_1.png-100.8kB><br>
图9.13 如果物体不在一个光源的光照范围内（从右图可以看出，胶囊体不在最左方的点光源的照明范围内），Unity是不会调用Additional Pass来为该物体处理该光源的</p>
<p><img src=http://static.zybuluo.com/candycat/joseae4o6388culiwx8tfntf/light_not_important.png alt=light_not_important.png-70.8kB><br>
图9.14 当把光源的Render Mode设为Not Important时，这些光源就不会按逐像素光来处理</p>
<p><img src=http://static.zybuluo.com/candycat/11n30be5vio56i8a35qdqzrd/light_shadow.png alt=light_shadow.png-32.8kB><br>
图9.15 开启光源的阴影效果</p>
<p><img src=http://static.zybuluo.com/candycat/tp559yfnp82fb3i5g5y5qc77/mesh_renderer.png alt=mesh_renderer.png-20.3kB><br>
图9.16 Mesh Renderer组件的Cast Shadows和Receive Shadows属性可以控制该物体是否投射/接收阴影</p>
<p><img src=http://static.zybuluo.com/candycat/rd60ljcaza6xcthui0q98m29/shadow_0.png alt=shadow_0.png-34.4kB><br>
图9.17 开启Cast Shadows和Receive Shadows，从而让正方体可以投射和接收阴影</p>
<p><img src=http://static.zybuluo.com/candycat/3t7vthpva2llk7madax2rcqs/shadow_1.png alt=shadow_1.png-89kB><br>
图9.18 把Cast Shadows设置为Two Sided可以让右侧平面的背光面也产生阴影</p>
<p><img src=http://static.zybuluo.com/candycat/d33yusj8nxye922idu6ws2xe/shadow_2.png alt=shadow_2.png-40.5kB><br>
图9.19 正方体可以接收来自右侧平面的阴影</p>
<p><img src=http://static.zybuluo.com/candycat/3sjunj4mk8gizha7fve184m4/shadow_frame_debugger.png alt=shadow_frame_debugger.png-81.6kB><br>
图9.20 使用帧调试器查看阴影绘制过程</p>
<p><img src=http://static.zybuluo.com/candycat/c3c1kldvrbicscs1opg7ihjn/shadow_frame_debugger_0.png alt=shadow_frame_debugger_0.png-83.1kB><br>
图9.21 正方体对深度纹理的更新结果</p>
<p><img src=http://static.zybuluo.com/candycat/88mxjbzlwzyxsbncd8337dd1/shadow_frame_debugger_1.png alt=shadow_frame_debugger_1.png-88.6kB><br>
图9.22 屏幕空间的阴影图</p>
<p><img src=http://static.zybuluo.com/candycat/fv1abzu7knq289amxegwxqki/shadow_frame_debugger_2.png alt=shadow_frame_debugger_2.png-175.1kB><br>
图9.23 Unity绘制屏幕阴影的过程</p>
<p><img src=http://static.zybuluo.com/candycat/v0wel6w64l5x0intcrfp3vdt/alpha_test_shadow_0.png alt=alpha_test_shadow_0.png-62.8kB><br>
图9.24 可以投射阴影的使用透明度测试的物体</p>
<p><img src=http://static.zybuluo.com/candycat/ap18z7090krmbw2ftx2u3e6z/alpha_test_shadow_1.png alt=alpha_test_shadow_1.png-66.2kB><br>
图9.25 正确设置了Fallback的使用透明度测试的物体</p>
<p><img src=http://static.zybuluo.com/candycat/g4hli2g5m1371d7h1bowc4jj/alpha_test_shadow_2.png alt=alpha_test_shadow_2.png-75.7kB><br>
图9.26 正确设置了Cast Shadow属性的使用透明度测试的物体</p>
<p><img src=http://static.zybuluo.com/candycat/4qjn2sb071h7akbwxx7n5nre/alpha_blend_shadow0.png alt=alpha_blend_shadow0.png-88.6kB><br>
图9.27 把使用了透明度混合的Unity Shader的Fallback设置为内置的Transparent/VertexLit。半透明物体不会向下方的平面投射阴影，也不会接收来自右侧平面的阴影，它看起来就像是完全透明一样</p>
<p><img src=http://static.zybuluo.com/candycat/00c0x6mhf74ru1kd9ejdwlko/alpha_blend_shadow1.png alt=alpha_blend_shadow1.png-94.9kB><br>
图9.28 把Fallback设为VertexLit来强制为半透明物体生成阴影</p>
<h3 id=第10章-高级纹理>第10章 高级纹理</h3>
<p><img src=http://static.zybuluo.com/candycat/2r8xxicnsapkqbteoto79pxu/cubemap_sample.png alt=cubemap_sample.png-20.1kB><br>
图10.1 对立方体纹理的采样</p>
<p><img src=http://static.zybuluo.com/candycat/wg85b0wb37t0q76lbq3y6zxs/skybox_mat.png alt=skybox_mat.png-159kB><br>
图10.2 天空盒子材质</p>
<p><img src=http://static.zybuluo.com/candycat/xyoodrunl4mbbgv5brqjyq0f/lighting_skybox.png alt=lighting_skybox.png-28.7kB><br>
图10.3 为场景使用自定义的天空盒子</p>
<p><img src=http://static.zybuluo.com/candycat/s0ntkfe1bez8zovfz9c9m7d2/skybox_scene.png alt=skybox_scene.png-346.5kB><br>
图10.4 使用了天空盒子的场景</p>
<p><img src=http://static.zybuluo.com/candycat/l0sdnfmt2sqz1me0ffh2lv83/render_into_cubemap.png alt=render_into_cubemap.png-123kB><br>
图10.5 使用脚本创建立方体纹理</p>
<p><img src=http://static.zybuluo.com/candycat/0xj35c2xyghr94qejg8gu75n/render_to_cubemap.png alt=render_to_cubemap.png-133.8kB><br>
图10.6 使用脚本渲染立方体纹理</p>
<p><img src=http://static.zybuluo.com/candycat/kvbrukc9u4z3gws4z4xyjzae/reflection.png alt=reflection.png-400.5kB><br>
图10.7 使用了反射效果的Teapot模型</p>
<p><img src=http://static.zybuluo.com/candycat/mrqwqi3up3itfrnw2gbc0v81/snell_law.png alt=snell_law.png-28.6kB><br>
图10.8 斯涅尔定律</p>
<p><img src=http://static.zybuluo.com/candycat/r895gindngpqsbtf3bt9s8iz/refraction.png alt=refraction.png-377.1kB><br>
图10.9 使用了折射效果的Teapot模型</p>
<p><img src=http://static.zybuluo.com/candycat/1wv42r40xkxm2px9kwdgmsd2/fresnel.png alt=fresnel.png-64.6kB><br>
图10.10 使用了菲涅耳反射的Teapot模型</p>
<p><img src=http://static.zybuluo.com/candycat/p6xmvccttgbwoontkcz2aw6s/mirror.png alt=mirror.png-342.1kB><br>
图10.11 镜子效果</p>
<p><img src=http://static.zybuluo.com/candycat/wnvt1efwxapznql1x19hp07i/render_texture.png alt=render_texture.png-113.3kB><br>
图10.12 左图：把摄像机的Target Texture设置成自定义的渲染纹理。右图：渲染纹理使用的纹理设置</p>
<p><img src=http://static.zybuluo.com/candycat/fwsiw50bmkvtvvfchazzjc4g/glass.png alt=glass.png-462.9kB><br>
图10.13 玻璃效果</p>
<p><img src=http://static.zybuluo.com/candycat/kk334ihfwvw6uf7d457kin3e/glass_cubemap.png alt=glass_cubemap.png-140.2kB><br>
图10.14 本例使用的立方体纹理</p>
<p><img src=http://static.zybuluo.com/candycat/5kw303ah2c3bgda33qhg69o1/procedural_texture.png alt=procedural_texture.png-111.3kB><br>
图10.15 脚本生成的程序纹理</p>
<p><img src=http://static.zybuluo.com/candycat/swke90qelg832pfi56wf5csa/procedural_texture_multi.png alt=procedural_texture_multi.png-62.8kB><br>
图10.16　调整程序纹理的参数来得到不同的程序纹理</p>
<p><img src=http://static.zybuluo.com/candycat/cvzw3s5ctqu6qcuglf73e867/subtance_material.png alt=subtance_material.png-41.1kB><br>
图10.17　后缀为.sbsar的Substance材质</p>
<p><img src=http://static.zybuluo.com/candycat/nsmnfpzjoomtmjk9q2ggvl9x/subtance_material_asset.png alt=subtance_material_asset.png-78.8kB><br>
图10.18　程序纹理资源</p>
<p><img src=http://static.zybuluo.com/candycat/qqtq4kuo1cioe5hr7r9idcs5/subtance_material_multi.png alt=subtance_material_multi.png-183.5kB><br>
图10.19　调整程序纹理属性可以得到看似完全不同的程序材质效果</p>
<h3 id=第11章-让画面动起来>第11章 让画面动起来</h3>
<p><img src=http://static.zybuluo.com/candycat/l0k525lbsoqgxvy6hx0qcypv/boom.png alt=boom.png-140.2kB><br>
图11.1 本节使用的序列帧图像</p>
<p><img src=http://static.zybuluo.com/candycat/i1erzd6uj2qtauhnhpyoghkw/boom_sequence.png alt=boom_sequence.png-37.6kB><br>
图11.2 使用序列帧动画来实现爆炸效果</p>
<p><img src=http://static.zybuluo.com/candycat/2kti0v0qeqdg3nh4k1g1tvd9/scroll_background.png alt=scroll_background.png-228.5kB><br>
图11.3 无限滚动的背景（纹理来源：forest-background © 2012-2013 Julien Jorge <a href=mailto:julien.jorge@stuff-o-matic.com>julien.jorge@stuff-o-matic.com</a>）</p>
<p><img src=http://static.zybuluo.com/candycat/zbckc0o5c8ygxj52o1vjl6gn/river.png alt=river.png-242.7kB><br>
图11.4 使用顶点动画来模拟2D的河流</p>
<p><img src=http://static.zybuluo.com/candycat/nmwj4c59j8dif8828fehq477/basis_vector.png alt=basis_vector.png-76.2kB><br>
图11.5 法线固定（总是指向视角方向）时，计算广告牌技术中的三个正交基的过程</p>
<p><img src=http://static.zybuluo.com/candycat/bndvgjiho7jr1zpercpxh6iu/billboard.png alt=billboard.png-86.8kB><br>
图11.6 广告牌效果。左图显示了摄像机和5个广告牌之间的位置关系，摄像机是从斜上方向下观察它们的。中间的图显示了当Vertical Restraints属性为1，即固定法线方向为观察视角时所得到的效果，可以看出，所有的广告牌都完全面朝摄像机。右图显示了当Vertical Restraints属性为0，即固定指向上的方向为(0, 1, 0)时所得到的效果，可以看出，广告牌虽然最大限度地面朝摄像机，但其指向上的方向并未发生改变</p>
<p><img src=http://static.zybuluo.com/candycat/29aprg3n5fsuxup63wk5ovzl/wrong_shadow.png alt=wrong_shadow.png-147.3kB><br>
图11.7 当进行顶点动画时，如果仍然使用内置的ShadowCaster Pass来渲染阴影，可能会得到错误的阴影效果</p>
<p><img src=http://static.zybuluo.com/candycat/bfvx4iycwdjnraykcnvjpw3g/right_shadow.png alt=right_shadow.png-43.8kB><br>
图11.8 使用自定义的ShadowCaster Pass 为变形物体绘制正确的阴影</p>
<h3 id=第12章-屏幕后处理效果>第12章 屏幕后处理效果</h3>
<p><img src=http://static.zybuluo.com/candycat/szhonaye4dir2otxjsjc0836/brtsatcon.png alt=brtsatcon.png-651.1kB><br>
图12.1 左图：原效果。右图：调整了亮度（值为1.2）、饱和度（值为1.6）和对比度（值为1.2）后的效果</p>
<p><img src=http://static.zybuluo.com/candycat/gj5f0q2eqsnw6vb6qjslw2u5/script_shader.png alt=script_shader.png-16.6kB><br>
图12.2 为脚本设置Shader的默认值</p>
<p><img src=http://static.zybuluo.com/candycat/88uix76d65ca3yu592w0okhh/edge_detection.png alt=edge_detection.png-717.9kB><br>
图12.3 左图：12.2节得到的结果。 右图：进行边缘检测后的效果</p>
<p><img src=http://static.zybuluo.com/candycat/dvch7lp9z5d9rp4o0c1edjep/convolution.png alt=convolution.png-15.1kB><br>
图12.4 卷积核与卷积。使用一个3×3大小的卷积核对一张5×5大小的图像进行卷积操作，当计算图中红色方块对应的像素的卷积结果时，我们首先把卷积核的中心放置在该像素位置，翻转核之后再依次计算核中每个元素和其覆盖的图像像素值的乘积并求和，得到新的像素值</p>
<p><img src=http://static.zybuluo.com/candycat/bm2nnarbl2h6fmmjq1gsfb7c/edge_detection_kernel.png alt=edge_detection_kernel.png-19.8kB><br>
图12.5 三种常见的边缘检测算子</p>
<p><img src=http://static.zybuluo.com/candycat/qg856glqkbkaw28vmwl59kic/edge_only.png alt=edge_only.png-266.5kB><br>
图12.6 只显示边缘的屏幕效果</p>
<p><img src=http://static.zybuluo.com/candycat/0y9xt8awtvueymd63g829vmu/gaussian_blur.png alt=gaussian_blur.png-703.8kB><br>
图12.7 左图：原效果。右图：高斯模糊后的效果</p>
<p><img src=http://static.zybuluo.com/candycat/qdi1a1gaicihr3tju2acbcdc/gaussian_kernel.png alt=gaussian_kernel.png-21.2kB><br>
图12.8 一个5×5大小的高斯核。左图显示了标准方差为1的高斯核的权重分布。我们可以把这个二维高斯核拆分成两个一维的高斯核（右图）</p>
<p><img src=http://static.zybuluo.com/candycat/0k9u1k5rrg9cq4gj4mwj1l0x/800px-Elephants_Dream_-_Emo_and_Proog.jpg alt=800px-Elephants_Dream_-_Emo_and_Proog.jpg-41.9kB><br>
图12.9 动画短片《大象之梦》中的Bloom效果。光线透过门扩散到了周围较暗的区域中</p>
<p><img src=http://static.zybuluo.com/candycat/gt2h3xoo89hmvm8o85pso5uh/bloom.png alt=bloom.png-772.3kB><br>
图12.10 左图：原效果。右图：Bloom处理后的效果</p>
<p><img src=http://static.zybuluo.com/candycat/ryde8k1k1bm5j7dxgdo5w0ks/motion_blur.png alt=motion_blur.png-770.9kB><br>
图12.11 左图：原效果。右图：应用运动模糊后的效果</p>
<h3 id=第13章-使用深度和法线纹理>第13章 使用深度和法线纹理</h3>
<p><img src=http://static.zybuluo.com/candycat/u6fma5c4boo56dgjbgczlb2i/projection_matrix.png alt=projection_matrix.png-150.4kB><br>
图13.1 在透视投影中，投影矩阵首先对顶点进行了缩放。在经过齐次除法后，透视投影的裁剪空间会变换到一个立方体。图中标注了4个关键点经过投影矩阵变换后的结果</p>
<p><img src=http://static.zybuluo.com/candycat/8idbd0mykpsqnj16t84uwsml/orthographic_matrix.png alt=orthographic_matrix.png-129.6kB><br>
图13.2 在正交投影中，投影矩阵对顶点进行了缩放。在经过齐次除法后，正交投影的裁剪空间会变换到一个立方体。图中标注了4个关键点经过投影矩阵变换后的结果</p>
<p><img src=http://static.zybuluo.com/candycat/xnqw3nkojdxml562evws8aug/check_texture.png alt=check_texture.png-161.3kB><br>
图13.3 使用Frame Debugger查看深度纹理（左）和深度+法线纹理（右）。如果当前摄像机需要生成深度和法线纹理，帧调试器的面板中就会出现相应的渲染事件。只要单击对应的事件就可以查看得到的深度和法线纹理</p>
<p><img src=http://static.zybuluo.com/candycat/kp57syi72i7jloyghgbeqy82/check_texture_code.png alt=check_texture_code.png-84kB><br>
图13.4 左图：线性空间下的深度纹理。右图：解码后并且被映射到[0, 1]范围内的视角空间下的法线纹理</p>
<p><img src=http://static.zybuluo.com/candycat/6yzf4h789v3117qpa4t2k931/fog.png alt=fog.png-627.5kB><br>
图13.5 左图：原效果。右图：添加全局雾效后的效果</p>
<p><img src=http://static.zybuluo.com/candycat/cisfq83ut1mx2ou313e1nqg2/frustum.png alt=frustum.png-33.5kB><br>
图13.6 计算interpolatedRay</p>
<p><img src=http://static.zybuluo.com/candycat/6h2nnw3gwzcio21jbji2o2dw/world_dist.png alt=world_dist.png-18.6kB><br>
图13.7 采样得到的深度值并非是点到摄像机的欧式距离</p>
<p><img src=http://static.zybuluo.com/candycat/20oe6ovk2wn4ko2el5ldwfs9/over_edge.png alt=over_edge.png-819kB><br>
图13.8 左图：原效果。右图：直接对颜色图像进行边缘检测的结果</p>
<p><img src=http://static.zybuluo.com/candycat/snzxjfahsz29po5mcrfrczmu/edge_detect.png alt=edge_detect.png-452.9kB><br>
图13.9 在深度和法线纹理上进行更健壮的边缘检测。左图：在原图上描边的效果。右图：只显示描边的效果</p>
<p><img src=http://static.zybuluo.com/candycat/ziah5yj1twj4nva7ldvw8dnk/Roberts.png alt=Roberts.png-15.7kB><br>
图13.10 Roberts算子</p>
<h3 id=第14章-非真实感渲染>第14章 非真实感渲染</h3>
<p><img src=http://static.zybuluo.com/candycat/aa2hjqkoibcqmq5g5azdkrfb/okami_announce_screens6.jpg alt=okami_announce_screens6.jpg-169.9kB><br>
图14.1 游戏《大神》（英文名：Okami）的游戏截图</p>
<p><img src=http://static.zybuluo.com/candycat/0x7o2vyl6fn74gwtunvdgufp/toon_shading.png alt=toon_shading.png-74.1kB><br>
图14.2 卡通风格的渲染效果</p>
<p><img src=http://static.zybuluo.com/candycat/z8c9f6kzclslbl0wdw7gxach/antialiasing.png alt=antialiasing.png-138.4kB><br>
图14.3 左图：未对高光区域进行抗锯齿处理。右图：使用fwidth函数对高光区域进行抗锯齿处理</p>
<p><img src=http://static.zybuluo.com/candycat/9h63lflg1a7f759pw5cwfqvz/TAM.png alt=TAM.png-127.6kB><br>
图14.4 一个TAM的例子（来源：Praun E, et al. Real-time hatching<a href=http://static.zybuluo.com/candycat/qwr4r6aglmod38w2k1e0dq7h/CopyDataToGPU.png>4</a>）</p>
<p><img src=http://static.zybuluo.com/candycat/60jzr7ly5yqqcg09rfrc3icb/hatching.png alt=hatching.png-268.1kB><br>
图14.5 素描风格的渲染效果</p>
<h3 id=第15章-使用噪声>第15章 使用噪声</h3>
<p><img src=http://static.zybuluo.com/candycat/43pgznadojl5el7s23zpki7x/burn.png alt=burn.png-429.1kB><br>
图15.1 箱子的消融效果</p>
<p><img src=http://static.zybuluo.com/candycat/l8caf290oitxfnenqu38ed95/burn_noise.png alt=burn_noise.png-84.8kB><br>
图15.2 消融效果使用的噪声纹理</p>
<p><img src=http://static.zybuluo.com/candycat/rgxn8cpsc4isivqouvbxtev7/water.png alt=water.png-722.5kB><br>
图15.3 包含菲涅耳反射的水面波动效果。在左图中，视角方向和水面法线的夹角越大，反射效果越强。在右图中，视角方向和水面法线的夹角越大，折射效果越强</p>
<p><img src=http://static.zybuluo.com/candycat/lh1zewua7dl2p8olhmctowoz/cubemap.png alt=cubemap.png-128.3kB><br>
图15.4 本例使用的立方体纹理</p>
<p><img src=http://static.zybuluo.com/candycat/unuc9j0kp9fffr7jcnbowvzi/water_noise.png alt=water_noise.png-202kB><br>
图15.5 水波效果使用的噪声纹理。左图：噪声纹理的灰度图。右图：由左图生成的法线纹理</p>
<p><img src=http://static.zybuluo.com/candycat/dmrvnch1muikmc6f50sdwdho/fog.png alt=fog.png-493.9kB><br>
图15.6 左图：均匀雾效。右图：使用噪声纹理后的非均匀雾效</p>
<p><img src=http://static.zybuluo.com/candycat/kfctu0s78fl2pepr9h1hgjpo/fog_noise.jpg alt=fog_noise.jpg-13kB><br>
图15.7 本节使用的噪声纹理</p>
<h3 id=第16章-unity中的渲染优化技术>第16章 Unity中的渲染优化技术</h3>
<p><img src=http://static.zybuluo.com/candycat/mw2e3pfqk097fps9wbcwv8ff/render_static_window.png alt=render_static_window.png-156.1kB><br>
图16.1 Unity 5的渲染统计窗口</p>
<p><img src=http://static.zybuluo.com/candycat/f1fpglqqgcg7q17tum55e8bh/profiler.png alt=profiler.png-122.5kB><br>
图16.2 使用Unity的性能分析器中的渲染区域来查看更多关于渲染的统计信息</p>
<p><img src=http://static.zybuluo.com/candycat/3qa6mzh0mc1q7jiqhaf3j7mv/frame_debugger.png alt=frame_debugger.png-84.3kB><br>
图16.3 使用帧调试器来查看单独的draw call的绘制结果</p>
<p><img src=http://static.zybuluo.com/candycat/ytyrujgdcz4dxpvm8nw3tibd/dynamic_batching0.png alt=dynamic_batching0.png-138.9kB><br>
图16.4 动态批处理</p>
<p><img src=http://static.zybuluo.com/candycat/0l9c6cjb4czi02hxr8e2ij0o/dynamic_batching1.png alt=dynamic_batching1.png-138.9kB><br>
图16.5 多光源对动态批处理的影响结果</p>
<p><img src=http://static.zybuluo.com/candycat/h7pzd9j05aelvv6cafs7juzv/static_batching0.png alt=static_batching0.png-112.9kB><br>
图16.6 静态批处理前的渲染统计数据</p>
<p><img src=http://static.zybuluo.com/candycat/jkgbb245hcnoxzq4k3go3yba/mark_static.png alt=mark_static.png-22.3kB><br>
图16.7 把物体标志为Static</p>
<p><img src=http://static.zybuluo.com/candycat/p7h3m5syxv9g7i928zohzhas/static_batching1.png alt=static_batching1.png-112.3kB><br>
图16.8 静态批处理</p>
<p><img src=http://static.zybuluo.com/candycat/kfz63didqcnctti7ft8lvtpw/combined_mesh.png alt=combined_mesh.png-152.1kB><br>
图16.9 静态批处理中Unity会合并所有被标识为“Static”的物体</p>
<p><img src=http://static.zybuluo.com/candycat/u9o9tk9oispyksk3ag41an3x/vbo.png alt=vbo.png-92kB><br>
图16.10 静态批处理会占用更多的内存。左图：静态批处理前的渲染统计数据。右图：静态批处理后的渲染统计数据</p>
<p><img src=http://static.zybuluo.com/candycat/zul250cb0n5x5w5821tu4xwd/static_batching2.png alt=static_batching2.png-113.6kB><br>
图16.11 处理其他逐像素光的Pass不会被静态批处理</p>
<p><img src=http://static.zybuluo.com/candycat/58dcw7v9r39i2p2izrtxq5bs/advance_texture.png alt=advance_texture.png-96.6kB><br>
图16.12 Unity的高级纹理设置面板</p>
<h3 id=第17章-surface-shader探秘>第17章 Surface Shader探秘</h3>
<p><img src=http://static.zybuluo.com/candycat/slo759tsffn90428bqqkt054/bumped_diffuse.png alt=bumped_diffuse.png-164.7kB><br>
图17.1 表面着色器的例子。左图：在一个平行光下的效果。右图：添加了一个点光源（蓝色）和一个聚光灯（紫色）后的效果</p>
<p><img src=http://static.zybuluo.com/candycat/rt3i7s74tdilo8185rexkowi/generated_code.png alt=generated_code.png-28.9kB><br>
图17.2 查看表面着色器生成的代码</p>
<p><img src=http://static.zybuluo.com/candycat/rokaz0qqzk11hyj7ntkss3ze/pipeline.png alt=pipeline.png-171.9kB><br>
图17.3 表面着色器的渲染计算流水线。黄色：可以自定义的函数。灰色：Unity自动生成的计算步骤</p>
<p><img src=http://static.zybuluo.com/candycat/bhggsxnr7rlhkzs8u68mqarn/normal_extrusion.png alt=normal_extrusion.png-127.3kB><br>
图17.4 沿顶点法线对模型进行膨胀。左图：膨胀前。右图：膨胀后</p>
<h3 id=第18章-基于物理的渲染>第18章 基于物理的渲染</h3>
<p><img src=http://static.zybuluo.com/candycat/nw3v0p25h9165552cshmr1t1/reflect_refract.png alt=reflect_refract.png-26.9kB><br>
图18.1 在理想的边界处，折射率的突变会把光线分成两个方向</p>
<p><img src=http://static.zybuluo.com/candycat/zmrvmeo27ach7kjpxm1grnwb/rought_smooth.png alt=rought_smooth.png-64.6kB><br>
图18.2 左图：光滑表面的微平面的法线变化较小，反射光线的方向变化也更小。 右图：粗糙表面的微平面的法线变化较大，反射光线的方向变化也更大</p>
<p><img src=http://static.zybuluo.com/candycat/ezo6d9xa3vv6l97hdy48jltc/subsurface_scattered_light.png alt=subsurface_scattered_light.png-36.3kB><br>
图18.3 微表面对光的折射。这些被折射的光中一部分被吸收，一部分又被散射到外部</p>
<p><img src=http://static.zybuluo.com/candycat/th1ophcgurbsh1jbobzz2d6k/surface.png alt=surface.png-42.5kB><br>
图18.4 次表面散射。左图：次表面散射的光线会从不同于入射点的位置射出。如果这些距离值小于需要被着色的像素大小，那么渲染就可以完全在局部完成（右图）。否则，就需要使用次表面散射渲染技术</p>
<p><img src=http://static.zybuluo.com/candycat/08orrgge69y3d3zgp4gfpcn9/brdf.png alt=brdf.png-47.1kB><br>
图18.5 BRDF描述的两种现象。高光反射部分用于描述反射，漫反射部分用于描述次表面散射</p>
<p><img src=http://static.zybuluo.com/candycat/d03qynt6prxeq7cep9b1jl91/m_h.png alt=m_h.png-90.5kB><br>
图18.6 （a）那些m=h的微面元会恰好把入射光从I反射到v上，只有这部分微面元才可以添加到BRDF的计算中。（b）一部分满足（a）的微面元会在I方向上被其他微面元遮挡住，它们不会接受到光照，因此会形成阴影。（c）还有一部分满足（a）的微面元会在反射方向v上被其他微面元挡住，因此，这部分反射光也不会被看到</p>
<p><img src=http://static.zybuluo.com/candycat/8yd8tgsx8x1tvdcwuxxowgt3/standard_shader.png alt=standard_shader.png-276.6kB><br>
图18.7 Standard Shader中前向渲染路径使用的Pass（简化版本的PBS使用了VertexOutputBaseSimple等结构体来代替相应的结构体）</p>
<p><img src=http://static.zybuluo.com/candycat/kpx9eqzt6xjtw7lp9uac9qc8/calibration_charts.png alt=calibration_charts.png-387.8kB><br>
图18.8 Unity提供的校准表格。左图：金属工作流 使用的校准表格。右图：高光反射工作流使用的校准表格</p>
<p><img src=http://static.zybuluo.com/candycat/0y8tojxhwa92hjy4oo20ii9p/metallic_workflow.png alt=metallic_workflow.png-181.6kB><br>
图18.9 使用金属工作流来实现不同类型的材质。左边的球体：金属材质。右边的球体：塑料材质</p>
<p><img src=http://static.zybuluo.com/candycat/rre47eai63qgeh811clxbev2/pbs_scene.png alt=pbs_scene.png-625.7kB><br>
图18.10 在Unity 5中使用基于物理的渲染技术，场景在不同光照下的渲染结果</p>
<p><img src=http://static.zybuluo.com/candycat/829ewyjmvzjm082xpyysvqfz/lighting_inspector.png alt=lighting_inspector.png-48.9kB><br>
图18.11 光照面板下的Scene标签页</p>
<p><img src=http://static.zybuluo.com/candycat/nlh6q7gqgwlbitske1z8938i/reflect_source.png alt=reflect_source.png-349.6kB><br>
图18.12 左图：当关闭场景中的所有光源并把环境光照强度设为0后，使用了Standard Shader的物体仍然具有光照效果。右图：在左图的基础上，把反射源设置为空，使得物体不接受任何默认的反射信息</p>
<p><img src=http://static.zybuluo.com/candycat/x7cxbmmb2xdzke3m0asowtu9/direction_light.png alt=direction_light.png-29.3kB><br>
图18.13 使用的平行光</p>
<p><img src=http://static.zybuluo.com/candycat/61ycjyc3k04bjh8sai6womkn/bounce_intensity.png alt=bounce_intensity.png-645.9kB><br>
图18.14 左图：将Bounce Intensity设置为0，物体不再受到间接光照的影响，木屋内阴影部分的可见细节很少。右图：将Bounce Intensity设为8，阴影部分的细节更加清楚</p>
<p><img src=http://static.zybuluo.com/candycat/twic91rz1143c14rc0t1n1ie/reflection_probe.png alt=reflection_probe.png-615.8kB><br>
图18.15 左图：未使用反射探针。右图：在场景中放置了两个反射探针，注意墙上的盾牌与左图的差别</p>
<p><img src=http://static.zybuluo.com/candycat/d7amfp6yscz10g5yk0kybwd1/interreflection.png alt=interreflection.png-338.2kB><br>
图18.16 使用反射探针实现相互反射的效果</p>
<p><img src=http://static.zybuluo.com/candycat/umachb7kklgerrvsphv7yyoj/linear_space.png alt=linear_space.png-611.4kB><br>
图18.17 左图：在线性空间下的渲染结果。右图：在伽马空间下的渲染结果</p>
<p><img src=http://static.zybuluo.com/candycat/uizo2ug3l5ovy68zbn9afde0/gamma_chart.png alt=gamma_chart.png-29.3kB><br>
图18.18 人眼更容易感知暗部区域的变换，而对较亮区域的变化比较不敏感</p>
<p><img src=http://static.zybuluo.com/candycat/2y5h6wx9hupw5nv2ugtseyqn/encoding_display_gamma.png alt=encoding_display_gamma.png-37.5kB><br>
图18.19 编码伽马和显示伽马</p>
<p>![gamma_light.png-32.1k《Unity Shader入门精要》随书彩色插图</p>
<hr>
<p>说明：本页面是书籍《Unity Shader入门精要》的随书彩图集锦，包含了书中所有的插图，使用时可通过图片编号进行搜索。<br>
作者：冯乐乐<br>
邮箱：lelefeng1992@gmail.com</p>
<hr>
<h3 id=前言-1>前言</h3>
<p><img src=http://static.zybuluo.com/candycat/x27bgzdj1cmfbzxa43z8t5qw/shadertoy.png alt=shadertoy.png-286.5kB></p>
<h3 id=第2章-渲染流水线-1>第2章 渲染流水线</h3>
<p><img src=http://static.zybuluo.com/candycat/zqt40itigpzl8qkn30m433g6/%E6%B5%81%E6%B0%B4%E7%BA%BF.png alt=流水线.png-83.4kB><br>
图2.1　真实生活中的流水线</p>
<p><img src=http://static.zybuluo.com/candycat/c0opg7bab4cwzyok5vek52hs/%E6%A6%82%E5%BF%B5%E6%B5%81%E6%B0%B4%E7%BA%BF.png alt=概念流水线.png-16.9kB><br>
图2.2 渲染流水线中的三个概念阶段</p>
<p><img src=http://static.zybuluo.com/candycat/qwr4r6aglmod38w2k1e0dq7h/CopyDataToGPU.png alt=CopyDataToGPU.png-86.5kB><br>
图2.3 渲染所需的数据（两张纹理以及3个网格）从硬盘最终加载到显存中。在渲染时，GPU可以快速访问这些数据</p>
<p><img src=http://static.zybuluo.com/candycat/gld5mfj5o10kardzyn10p5a6/SetRenderState.png alt=SetRenderState.png-157.1kB><br>
图2.4 在同一状态下渲染三个网格。由于没有更改渲染状态，因此三个网格的外观看起来像是同一种材质的物体。</p>
<p><img src=http://static.zybuluo.com/candycat/5nuo5d8oh1c8sxexr3d7e935/DrawCall.png alt=DrawCall.png-59.1kB><br>
图2.5 CPU通过调用Draw Call来告诉GPU开始进行一个渲染过程。一个Draw Call会指向本次调用需要渲染的图元列表</p>
<p><img src=http://static.zybuluo.com/candycat/jundxsf604yuoy2zr3r1qkzp/GPU%E6%B5%81%E6%B0%B4%E7%BA%BF.png alt=GPU流水线.png-82.2kB><br>
图2.6 GPU的渲染流水线实现。颜色表示了不同阶段的可配置性或可编程性：绿色表示该流水线阶段是完全可编程控制的，黄色表示该流水线阶段可以配置但不是可编程的，蓝色表示该流水线阶段是由GPU固定实现的，开发者没有任何控制权。实线表示该shader必须由开发者编程实现，虚线表示该Shader是可选的</p>
<p><img src=http://static.zybuluo.com/candycat/07rjqb1pkfipxiizr1nsywuf/VertexShaderProcess.png alt=VertexShaderProcess.png-43kB><br>
图2.7 GPU在每个输入的网格顶点上都会调用顶点着色器。顶点着色器必须进行顶点的坐标变换，需要时还可以计算和输出顶点的颜色。例如，我们可能需要进行逐顶点的光照</p>
<p><img src=http://static.zybuluo.com/candycat/2zpu3oh7n6kpy4rosqtjugcy/Vertex%20Shader.png alt="Vertex Shader.png-34.9kB"><br>
图2.8 顶点着色器会将模型顶点的位置变换到齐次裁剪坐标空间下，进行输出后再由硬件做透视除法得到NDC下的坐标</p>
<p><img src=http://static.zybuluo.com/candycat/08cvo0uahel9ygds4xkwrczp/Clipping.png alt=Clipping.png-25.5kB><br>
图2.9 只有在单位立方体的图元才需要被继续处理。因此，完全在单位立方体外部的图元（红色三角形）被舍弃，完全在单位立方体内部的图元（绿色三角形）将被保留。和单位立方体相交的图元（黄色三角形）会被裁剪，新的顶点会被生成，原来在外部的顶点会被舍弃</p>
<p><img src=http://static.zybuluo.com/candycat/7xtfj07anrw60g4y7cadkd8h/ScreenMapping.png alt=ScreenMapping.png-22.6kB><br>
图2.10 屏幕映射将x、y坐标从（-1, 1）范围转换到屏幕坐标系中</p>
<p><img src=http://static.zybuluo.com/candycat/ul58wnwn76vj0gm20m3xsi9g/Screen%20Mapping_OpenGL_DirectX.png alt="Screen Mapping_OpenGL_DirectX.png-26.9kB"><br>
图2.11 OpenGL和DirectX的屏幕坐标系差异。对于一张512*512大小的图像，在OpenGL中其（0, 0）点在左下角，而在DirectX中其(0, 0)点在左上角</p>
<p><img src=http://static.zybuluo.com/candycat/1ltkl388mkbbzbfgzm28f6gy/TriangleSetupAndTraversal.png alt=TriangleSetupAndTraversal.png-80kB><br>
图2.12 三角形遍历的过程。根据几何阶段输出的顶点信息，最终得到该三角网格覆盖的像素位置。对应像素会生成一个片元，而片元中的状态是对三个顶点的信息进行插值得到的。例如，对图2.12中三个顶点的深度进行插值得到其重心位置对应的片元的深度值为-10.0</p>
<p><img src=http://static.zybuluo.com/candycat/lowfuoi0r43oxfgxkp9darur/FragmentShader.png alt=FragmentShader.png-42.4kB><br>
图2.13 根据上一步插值后的片元信息，片元着色器计算该片元的输出颜色</p>
<p><img src=http://static.zybuluo.com/candycat/epejev04t6vudwsyo2el8rp0/Per-fragment%20Operations.png alt="Per-fragment Operations.png-23.1kB"><br>
图2.14 逐片元操作阶段所做的操作。只有通过了所有的测试后，新生成的片元才能和颜色缓冲区中已经存在的像素颜色进行混合，最后再写入颜色缓冲区中</p>
<p><img src=http://static.zybuluo.com/candycat/28t2ora2kenj1uudwfgfig95/Stencil%20Test_Depth%20Test.png alt="Stencil Test_Depth Test.png-93.5kB"><br>
图2.15 模板测试和深度测试的简化流程图。</p>
<p><img src=http://static.zybuluo.com/candycat/k7q79qcgoqkw8myu1lpuy7he/Blending.png alt=Blending.png-67.6kB><br>
图2.16 混合操作的简化流程图</p>
<p><img src=http://static.zybuluo.com/candycat/kqngym2i5cvgo5bnkpfjabpi/why_early_depth_test.png alt=why_early_depth_test.png-18.7kB><br>
图2.17 图示场景中包含了两个对象：球和长方体，绘制顺序是先绘制球（在屏幕上显示为圆），再绘制长方体（在屏幕上显示为长方形）。如果深度测试在片元着色器之后执行，那么在渲染长方体时，虽然它的大部分区域都被遮挡在球的后面，即它所覆盖的绝大部分片元根本无法通过深度测试，但是我们仍然需要对这些片元执行片元着色器，造成了很大的性能浪费</p>
<p><img src=http://static.zybuluo.com/candycat/4x54y4f2kjlhil8wq7oi1fpa/OpenGL%E5%92%8CDirectX.png alt=OpenGL和DirectX.png-56.1kB><br>
图2.18 CPU、OpenGL/DirectX、显卡驱动和GPU之间的关系</p>
<p><img src=http://static.zybuluo.com/candycat/h9oh7t35lbjrgogxywarmu55/CommandBuffer.png alt=CommandBuffer.png-49.9kB><br>
图2.19 命令缓冲区。CPU通过图像编程接口向命令缓冲区中添加命令，而GPU从中读取命令并执行。黄色方框内的命令就是Draw Call，而红色方框内的命令用于改变渲染状态。我们使用红色方框来表示改变渲染状态的命令， 是因为这些命令往往更加耗时</p>
<p><img src=http://static.zybuluo.com/candycat/pef7ujj1xdzmzwdwz3n261rz/SmallCommand.png alt=SmallCommand.png-107.7kB><br>
图2.20 命令缓冲区中的虚线方框表示GPU已经完成的命令。此时，命令缓冲区中没有可以执行的命令了，GPU处于空闲状态，而CPU还没有准备好下一个渲染命令。</p>
<p><img src=http://static.zybuluo.com/candycat/d6cxj75dc7hnzwd2jlcqlj4j/Batching.png alt=Batching.png-70.3kB><br>
图2.21 利用批处理，CPU在RAM把多个网格合并成一个更大的网格，再发送给GPU，然后在一个Draw Call中渲染它们。但要注意的是，使用批处理合并的网格将会使用同一种渲染状态。也就是说，如果网格之间需要使用不同的渲染状态，那么就无法使用批处理技术</p>
<h3 id=第3章-unity-shader基础-1>第3章 Unity Shader基础</h3>
<p><img src=http://static.zybuluo.com/candycat/hojqrwubqu22k9jo0ues60hd/material_shader.png alt=material_shader.png-125.8kB><br>
图3.1 Unity Shader和材质。首先创建需要的Unity Shader和材质，然后把Unity Shader赋给材质，并在材质面板上调整属性（如使用的纹理、漫反射系数等）。最后，将材质赋给相应的模型来查看最终的渲染效果</p>
<p><img src=http://static.zybuluo.com/candycat/fupmmv6n7raqei37v4jj6su1/mesh_renderer.png alt=mesh_renderer.png-41kB><br>
图3.2 将材质直接拖曳到模型的Mesh Renderer组件中</p>
<p><img src=http://static.zybuluo.com/candycat/936v924ooiux4x9v9l6nw7w2/material_inspector.png alt=material_inspector.png-119.4kB><br>
图3.3 材质提供了一种可视化的方式来调整着色器中使用的参数</p>
<p><img src=http://static.zybuluo.com/candycat/dwq288k4s50acnc7sx2wz9fp/shader_import_settings.png alt=shader_import_settings.png-38kB><br>
图3.4 Unity Shader的导入设置面板</p>
<p><img src=http://static.zybuluo.com/candycat/wvudje920on69gto9p9jq6bo/shader_compile_code.png alt=shader_compile_code.png-35.9kB><br>
图3.5 Gompile and show code下拉列表</p>
<p><img src=http://static.zybuluo.com/candycat/mfyfmiwipc220l4v8iowww6k/shaderlab_abstract.png alt=shaderlab_abstract.png-63.4kB><br>
图3.6 Unity Shader为控制渲染过程提供了一层抽象。如果没有使用Unity Shader（左图），开发者需要和很多文件和设置打交道，才能让画面呈现出想要的效果；而在Unity Shader的帮助下（右图），开发者只需要使用ShaderLab来编写Unity Shader文件就可以完成所有的工作</p>
<p><img src=http://static.zybuluo.com/candycat/7u7q53pfa4pbtapi9wz9b6f7/shader_name.png alt=shader_name.png-55.5kB><br>
图3.7 在Unity Shader的名称定义中利用 斜杠来组织在材质面板中的位置</p>
<p><img src=http://static.zybuluo.com/candycat/izzjwk3okp3r41uok617ry8t/shaderlab_properties.png alt=shaderlab_properties.png-33.2kB><br>
图3.8 不同属性类型在材质 面板中的显示结果</p>
<p><img src=http://static.zybuluo.com/candycat/55s9cmdps9zqm738ls4ibuho/shader_compile_code.png alt=shader_compile_code.png-35.9kB><br>
图3.9 在Unity Shader的导入设置面板中可以通过Compile and show code按钮来查看Unity对CG片段编译后的代码。通过单击Compile and show code按钮右端的倒三角可以打开下拉菜单，在这个下拉菜单中可以选择编译的平台种类，如只为当前的显卡设备编译特定的汇编代码，或为所有的平台编译汇编代码，我们也可以自定义选择编译到哪些平台上</p>
<h3 id=第4章-学习shader所需的数学基础-1>第4章 学习Shader所需的数学基础</h3>
<p><img src=http://static.zybuluo.com/candycat/tdhtbh0rhx1dw94fbegmfxg9/little_cow.png alt=little_cow.png-293.5kB><br>
图4.1 我们的农场游戏。我们的主角妞妞是一头长得最壮、好奇心很强的奶牛</p>
<p><img src=http://static.zybuluo.com/candycat/u6pb6kylub8zxfwxotxs3cbm/cartersian_fly.png alt=cartersian_fly.png-28kB><br>
图4.2 传说，笛卡尔坐标系来源于笛卡尔对天花板上一只苍蝇的运动轨迹的观察。笛卡尔发现，可以使用苍蝇距不同墙面的距离来描述它的当前位置</p>
<p><img src=http://static.zybuluo.com/candycat/in4byrrfu29pr19hhfmzaqsw/2d_cartesian.png alt=2d_cartesian.png-36.4kB><br>
图4.3 一个二维笛卡尔坐标系</p>
<p><img src=http://static.zybuluo.com/candycat/s4twn4lnbvlac7ci3mwwbe4d/2d_cartesian_opengl_directx.png alt=2d_cartesian_opengl_directx.png-33.1kB><br>
图4.4 在屏幕映射时，OpenGL和DirectX使用了不同方向的二维笛卡尔坐标系</p>
<p><img src=http://static.zybuluo.com/candycat/9n615pcahnqo38xx5dm8vxpi/cow_cartesian.png alt=cow_cartesian.png-211.8kB><br>
图4.5 笛卡尔坐标系可以让妞妞精确表述自己的位置</p>
<p><img src=http://static.zybuluo.com/candycat/tp39jr06yzo8u4gdzp0z1qqs/3d_cartesian.png alt=3d_cartesian.png-22.7kB><br>
图4.6 一个三维笛卡尔坐标系</p>
<p><img src=http://static.zybuluo.com/candycat/7vdjcritmzv94yosp538yq7w/left_hand.png alt=left_hand.png-40.5kB><br>
图4.7 左手坐标系</p>
<p><img src=http://static.zybuluo.com/candycat/5llpe09e7f8mtdu7h49s88r1/right_hand.png alt=right_hand.png-40kB><br>
图4.8 右手坐标系</p>
<p><img src=http://static.zybuluo.com/candycat/w5i9lq84fphxch5x8tjtzqo2/left_right_hand_rule.png alt=left_right_hand_rule.png-75.3kB><br>
图4.9 用左手法则和右手法则来判断旋转正方向</p>
<p><img src=http://static.zybuluo.com/candycat/i65z04v7mbcufxsjkx7n0n67/cow_left_right.png alt=cow_left_right.png-254.3kB><br>
图4.10 为了移动到新的位置，妞妞需要首先向某个方向平移1个单位，再向另一个方向平移4个单位，最后再向一个方向旋转60°</p>
<p><img src=http://static.zybuluo.com/candycat/janos0r95h321yeoeufigdog/cow_left_right_hand.png alt=cow_left_right_hand.png-295.8kB><br>
图4.11 左图和右图分别表示了在左手坐标系和右手坐标系中描述妞妞这次运动的结果，得到的数学描述是不同的</p>
<p><img src=http://static.zybuluo.com/candycat/7xx63gosl0504rj16wdcnare/unity_cartesian.png alt=unity_cartesian.png-173.2kB><br>
图4.12 在模型空间和世界空间中，Unity使用的是左手坐标系。图中，球的坐标轴显示了它在模型空间中的3个坐标轴（红色为x轴，绿色是y轴，蓝色是z轴）</p>
<p><img src=http://static.zybuluo.com/candycat/lrhkf34n8p5fz7mzyro7r72m/unity_camera_cartesian.png alt=unity_camera_cartesian.png-25.1kB><br>
图4.13 在Unity中，观察空间使用的是右手坐标系，摄像机的前向是z轴的负方向， z轴越小，物体的深度越大，离摄像机越远</p>
<p><img src=http://static.zybuluo.com/candycat/t5slprvqvmndc1yve7x0lquo/exercise_3.png alt=exercise_3.png-130.8kB><br>
图4.14 摄像机的位置是（0, 1, -10），球体的位置是（0, 1, 0）</p>
<p><img src=http://static.zybuluo.com/candycat/8e49l43g2xhp9wfs6r526226/vector.png alt=vector.png-8.9kB><br>
图4.15 一个二维向量以及它的头和尾</p>
<p><img src=http://static.zybuluo.com/candycat/jwojplbtid4z6xiuw7dso9t0/point_vector.png alt=point_vector.png-16.1kB><br>
图4.16 点和矢量之间的关系</p>
<p><img src=http://static.zybuluo.com/candycat/py5slc3wo9v78lpb25xcdas0/vector_scalar.png alt=vector_scalar.png-53.9kB><br>
图4.17 二维矢量和一些标量的乘法和除法</p>
<p><img src=http://static.zybuluo.com/candycat/2y7rr3t5j8bct6ocnlvpydp6/vector_add_sub.png alt=vector_add_sub.png-52.8kB><br>
图4.18 二维矢量的加法和减法</p>
<p><img src=http://static.zybuluo.com/candycat/051rzkws7n2ii9wep4b04t8f/vector_displacement.png alt=vector_displacement.png-22.5kB><br>
图4.19 使用矢量减法来计算从点a到点b的位移</p>
<p><img src=http://static.zybuluo.com/candycat/lk35xmttonr0qliblc5v5lpu/vector_magnitude.png alt=vector_magnitude.png-8.2kB><br>
图4.20 矢量的模</p>
<p><img src=http://static.zybuluo.com/candycat/mqfl49yeebwbqtc23i755qux/unit_vector.png alt=unit_vector.png-30.7kB><br>
图4.21 二维空间的单位矢量都会落在单位圆上</p>
<p><img src=http://static.zybuluo.com/candycat/rlo1hwsdb334yi9i9vimdtko/projection.png alt=projection.png-17.7kB><br>
图4.22 矢量b在单位矢量a方向上的投影</p>
<p><img src=http://static.zybuluo.com/candycat/wet7zoq1bssb0u8gm63zfmx6/dot_sign.png alt=dot_sign.png-22.9kB><br>
图4.23 点积的符号</p>
<p><img src=http://static.zybuluo.com/candycat/xnouckzvbcb59nqcanijjpx7/dot_cos.png alt=dot_cos.png-14.1kB><br>
图4.24 两个单位矢量进行点积</p>
<p><img src=http://static.zybuluo.com/candycat/yrl5ol849v5h8892l4bqlgrh/vector_cross_diagram.png alt=vector_cross_diagram.png-32.1kB><br>
图4.25 三维矢量叉积的计算规律。不同颜色的线表示了计算结果矢量中对应颜色的分量的计算路径。以红色为例，即结果矢量的第一个分量，它是从第一个矢量的y分量出发乘以第二个矢量的z分量，再减去第一个矢量的z分量和第二矢量的y分量的乘积</p>
<p><img src=http://static.zybuluo.com/candycat/fh9vcn0q1g5te175pqg9beu3/vector_cross_length.png alt=vector_cross_length.png-13kB><br>
图4.26 使用矢量a和矢量b构建一个平行四边形</p>
<p><img src=http://static.zybuluo.com/candycat/0d3l6dqc7q6d3h6vxkqjqo99/vector_cross.png alt=vector_cross.png-27.2kB><br>
图4.27 分别使用左手坐标系和右手坐标系得到的叉积结果</p>
<p><img src=http://static.zybuluo.com/candycat/t6i0a60k7rd05a5url0wljcl/vector_cross_right_hand.png alt=vector_cross_right_hand.png-46.6kB><br>
图4.28 使用右手法则判断右手坐标系中a×b的方向</p>
<p><img src=http://static.zybuluo.com/candycat/5oy7iqjnkyi69v1d2sayhxf0/exercise_cross.png alt=exercise_cross.png-26.1kB><br>
图4.29 三角形的三个顶点位于xy平面上，人眼位于z轴负方向，向z轴正方向观察</p>
<p><img src=http://static.zybuluo.com/candycat/u6urub3wacveq0qcr6112we5/matrix_mul.png alt=matrix_mul.png-25kB><br>
图4.30 计算c23的过程</p>
<p><img src=http://static.zybuluo.com/candycat/ncg6g1ragp0bfufbm2m3ir2m/niuniu.png alt=niuniu.png-273.2kB><br>
图4.31 场景中的妞妞（左图）和屏幕上的妞妞（右图）。妞妞想知道，自己的鼻子是如何被画到屏幕上的</p>
<p><img src=http://static.zybuluo.com/candycat/o85jqc1fw9rt10f0n485y9vt/object_space.png alt=object_space.png-84.5kB><br>
图4.32 在我们的农场游戏中，每个奶牛都有自己的模型坐标系。在模型坐标系中妞妞鼻子的位置是(0, 2, 4, 1)</p>
<p><img src=http://static.zybuluo.com/candycat/drp1660u59nwnw8d2hvb0rrg/unity_transform.png alt=unity_transform.png-151.9kB><br>
图4.33 Unity的Transform组件可以调节模型的位置.如果Transform有父节点，如图中的“Mesh”，那么Position将是在其父节点（这里是“Cow”）的模型空间中的位置；如果没有父节点，Position就是在世界空间中的位置</p>
<p><img src=http://static.zybuluo.com/candycat/ozup3egxnxqp21otm4z6jzhx/world_space.png alt=world_space.png-378.7kB><br>
图4.34 农场游戏中的世界空间。世界空间的原点被放置在农场的中心。左下角显示了妞妞在世界空间中所做的变换。我们想要把妞妞的鼻子从模型空间变换到世界空间中</p>
<p><img src=http://static.zybuluo.com/candycat/8q0v8m4wwkm2h9homadyeear/camera_space.png alt=camera_space.png-346.2kB><br>
图4.35 农场游戏中摄像机的观察空间。观察空间的原点位于摄像机处。注意在观察空间中，摄像机的前向是z轴的负方向（图中只画出了z轴正方向），这是因为Unity在观察空间中使用了右手坐标系。左下角显示了摄像机在世界空间中所做的变换。我们想要把妞妞的鼻子从世界空间变换到观察空间中</p>
<p><img src=http://static.zybuluo.com/candycat/wqkekwazaaordawbq21nj7hz/camera_projection.png alt=camera_projection.png-299.3kB><br>
图4.36 透视投影（左图）和正交投影（右图）。左下角分别显示了当前摄像机的投影模式和相关属性</p>
<p><img src=http://static.zybuluo.com/candycat/b6wiym3nlkwimvnvgjgohhbz/camera_frustum.png alt=camera_frustum.png-301.2kB><br>
图4.37 视锥体和裁剪平面。左图显示了透视投影的视锥体，右图显示了正交投影的视锥体</p>
<p><img src=http://static.zybuluo.com/candycat/j6w23tgb5a1acjq6mr73ietq/projection_frustum.png alt=projection_frustum.png-67.3kB><br>
图4.38 透视摄像机的参数对透视投影视锥体的影响</p>
<p><img src=http://static.zybuluo.com/candycat/tddwy4107pnswnbxydxc2rsp/projection_matrix0.png alt=projection_matrix0.png-135.1kB><br>
图4.39 在透视投影中，投影矩阵对顶点进行了缩放。图3.38中标注了4个关键点经过投影矩阵变换后的结果。从这些结果可以看出x、y、z和w分量的范围发生的变化</p>
<p><img src=http://static.zybuluo.com/candycat/0r3xdlarpzqf94nfb304qihx/orthographic_frustum.png alt=orthographic_frustum.png-33.5kB><br>
图4.40 正交摄像机的参数对正交投影视锥体的影响</p>
<p><img src=http://static.zybuluo.com/candycat/2j2ea1iexjim88y8towjkjlz/orthographic_matrix0.png alt=orthographic_matrix0.png-129.6kB><br>
图4.41 在正交投影中，投影矩阵对顶点进行了缩放。图中标注了4个关键点经过投影矩阵变换后的结果。从这些结果可以看出x、y、z和w分量范围发生的变化</p>
<p><img src=http://static.zybuluo.com/candycat/si6bqxafh76xku3i0bxp91lq/cow_camera.png alt=cow_camera.png-180.1kB><br>
图4.42 农场游戏使用的摄像机参数和游戏画面的横纵比</p>
<p><img src=http://static.zybuluo.com/candycat/7ozeba0c8nex3o4zr9z9nt4v/projection_matrix1.png alt=projection_matrix1.png-131kB><br>
图4.43 经过齐次除法后，透视投影的裁剪空间会变换到一个立方体</p>
<p><img src=http://static.zybuluo.com/candycat/8921u8zbn1m38conxbed0nz5/orthographic_matrix1.png alt=orthographic_matrix1.png-105.6kB><br>
图4.44 经过齐次除法后，正交投影的裁剪空间会变换到一个立方体</p>
<p><img src=http://static.zybuluo.com/candycat/z0ibvp779phr1hb0l902n1qy/vertex_conversion.png alt=vertex_conversion.png-100.9kB><br>
图4.45 渲染流水线中顶点的空间变换过程</p>
<p><img src=http://static.zybuluo.com/candycat/jxcomxjmrye6rczmlyw550wt/space_handness.png alt=space_handness.png-75.6kB><br>
图4.46 Unity中各个坐标空间的旋向性</p>
<p><img src=http://static.zybuluo.com/candycat/cjevn0tuacb13ssus1sj8ceo/normal_tangent.png alt=normal_tangent.png-167.3kB><br>
图4.47 顶点的切线和法线。切线和法线互相垂直</p>
<p><img src=http://static.zybuluo.com/candycat/80ofuzudfjzrrl8r1gcxinse/transform_normal.png alt=transform_normal.png-40.6kB><br>
图4.48 进行非统一缩放时，如果使用和变换顶点相同的变换矩阵来变换法线，就会得到错误的结果，即变换后的法线方向与平面不再垂直</p>
<p><img src=http://static.zybuluo.com/candycat/9puxwch79e92gzv5xfrsh3qm/screen_coord.png alt=screen_coord.png-9kB><br>
图4.49 由片元的像素位置得到的图像</p>
<p><img src=http://static.zybuluo.com/candycat/zvcl27rgm897ir8w18m1bii2/difference_between_left_right.png alt=difference_between_left_right.png-54.6kB><br>
图4.50 图中两个坐标系的x轴和y轴是重合的，区别仅在于z轴的方向。左手坐标系的（0, 0, 1）点和右手坐标系中的（0, 0, 1）点是不同的，但它们旋转后的点却对应到了同一点</p>
<p><img src=http://static.zybuluo.com/candycat/akhas8nqu68ps3rd1kuhi0hf/difference_between_left_right_2.png alt=difference_between_left_right_2.png-59.4kB><br>
图4.51 绝对空间中的同一点，在左手和右手坐标系中进行同样角度的旋转，其旋转方向是不一样的。在左手坐标系中将按顺时针方向旋转，在右手坐标系中将按逆时针方向旋转</p>
<p><img src=http://static.zybuluo.com/candycat/tw8il4lajuaf6dxx7l0yj9zd/exercise_cross2.png alt=exercise_cross2.png-34.4kB><br>
图4.52 在左手坐标系中，如果叉积结果为负，那么3点的顺序是顺时针方向</p>
<h3 id=第5章-开始unity-shader学习之旅-1>第5章 开始Unity Shader学习之旅</h3>
<p><img src=http://static.zybuluo.com/candycat/9b4lok82evuyq772bhbnnl6x/new_scene.png alt=new_scene.png-74.3kB><br>
图5.1 在Unity 5中新建一个场景得到的效果</p>
<p><img src=http://static.zybuluo.com/candycat/4se9aphevcooho5wm1bsqxm0/simple_shader.png alt=simple_shader.png-25.4kB><br>
图5.2 用一个最简单的顶点/片元着色器得到一个白色的球</p>
<p><img src=http://static.zybuluo.com/candycat/umffe4syp5ttjtilp9ydyd2k/cginclude.png alt=cginclude.png-27kB><br>
图5.3 Unity的内置着色器</p>
<p><img src=http://static.zybuluo.com/candycat/yao0f655aycbk2kehmleei2p/false_color.png alt=false_color.png-192.9kB><br>
图5.4 用假彩色对Unity Shader进行调试</p>
<p><img src=http://static.zybuluo.com/candycat/tx3a01nq92yshsc1y72n6s4j/color_picker.png alt=color_picker.png-53.8kB><br>
图5.5 使用颜色拾取器来查看调试信息</p>
<p><img src=http://static.zybuluo.com/candycat/dx8svpr4bxtegcns8e50lgf6/frame_debugger.png alt=frame_debugger.png-218.7kB><br>
图5.6 帧调试器</p>
<p><img src=http://static.zybuluo.com/candycat/11gb131ywty31xni4smc77ol/frame_debugger_0.png alt=frame_debugger_0.png-164.5kB><br>
图5.7 单击Knot的深度图渲染事件，在Game视图会显示该事件的效果，在Hierarchy视图中会高亮显示Knot对象，在帧调试器的右侧窗口会显示出该事件的细节</p>
<p><img src=http://static.zybuluo.com/candycat/ninmtxykcrk7oywzvxirhn04/2d_cartesian_opengl_directx.png alt=2d_cartesian_opengl_directx.png-33.1kB><br>
图5.8 OpenGL和DirectX使用了不同的屏幕空间坐标</p>
<h3 id=第6章-unity中的基础光照-1>第6章 Unity中的基础光照</h3>
<p><img src=http://static.zybuluo.com/candycat/tzgu5oq816ojbkjo4y05rvij/irradiance.png alt=irradiance.png-60.3kB><br>
图6.1 在左图中，光是垂直照射到物体表面，因此光线之间的垂直距离保持不变；而在右图中，光是斜着照射到物体表面，在物体表面光线之间的距离是d/cosθ，因此单位面积上接收到的光线数目要少于左图</p>
<p><img src=http://static.zybuluo.com/candycat/7gu6p5xdmzngz53iaa011joy/scattering.png alt=scattering.png-37.1kB><br>
图6.2 散射时，光线会发生折射和反射现象。对于不透明物体，折射的光线会在物体内部继续传播，最终有一部分光线会重新从物体表面被发射出去</p>
<p><img src=http://static.zybuluo.com/candycat/51iph9ayl3l22w3xuzeumwxf/specular.png alt=specular.png-31.2kB><br>
图6.3 使用Phong模型计算高光反射</p>
<p><img src=http://static.zybuluo.com/candycat/nntler7jilkso6zufrbw447c/Blinn.png alt=Blinn.png-32.1kB><br>
图6.4 Blinn模型</p>
<p><img src=http://static.zybuluo.com/candycat/4pgo8idyb8gsjlq5xbynoj8d/ambient.png alt=ambient.png-35.3kB><br>
图6.5 在Unity的Window -> Lighting面板中，我们可以通过Ambient Source/Ambient Color/Ambient Intensity来控制场景中的环境光的颜色和强度</p>
<p><img src=http://static.zybuluo.com/candycat/tow3hbf8of391rb7sumri3sy/diffuse_vertex_level.png alt=diffuse_vertex_level.png-40.4kB><br>
图6.6 逐顶点的漫反射光照效果</p>
<p><img src=http://static.zybuluo.com/candycat/6vlfiln2hnmhndp3m5uma9bs/diffuse_pixel_level.png alt=diffuse_pixel_level.png-40.1kB><br>
图6.7 逐像素的漫反射光照效果</p>
<p><img src=http://static.zybuluo.com/candycat/kc9sg9dsvf7i23my26yii8gt/diffuse_compare_all.png alt=diffuse_compare_all.png-86.9kB><br>
图6.8 逐顶点漫反射光照、逐像素漫反射光照、半兰伯特光照的对比效果</p>
<p><img src=http://static.zybuluo.com/candycat/zldeemd0807hp485mkgp6qkr/reflect.png alt=reflect.png-9.2kB><br>
图6.9 CG的reflect函数</p>
<p><img src=http://static.zybuluo.com/candycat/zw9y4jmxj7pivjakhb2tjcnm/specular_vertex_level.png alt=specular_vertex_level.png-41.5kB><br>
图6.10 逐顶点的高光反射光照效果</p>
<p><img src=http://static.zybuluo.com/candycat/ze75kza2bpckowcdfcuqsqx6/specular_pixel_level.png alt=specular_pixel_level.png-40.8kB><br>
图6.11 逐像素的高光反射光照效果</p>
<p><img src=http://static.zybuluo.com/candycat/5d2r1xz062iykspwapu0txq1/specular_compare_all.png alt=specular_compare_all.png-82.5kB><br>
图6.12 逐顶点的高光反射光照、逐像素的高光反射光照（Phong光照模型）和Blinn-Phong高光反射光照的对比结果</p>
<h3 id=第7章-基础纹理-1>第7章 基础纹理</h3>
<p><img src=http://static.zybuluo.com/candycat/rcl2u5im3ef0pb1esf4pvz06/texture_coordinate.png alt=texture_coordinate.png-349.3kB><br>
图7.1 Unity中的纹理坐标</p>
<p><img src=http://static.zybuluo.com/candycat/90xmbvepdh5lywclqutr989j/single_texture.png alt=single_texture.png-71.3kB><br>
图7.2 使用单张纹理</p>
<p><img src=http://static.zybuluo.com/candycat/p60yfqpxafslgw0b8m3t2vd6/texture_tiling_offset.png alt=texture_tiling_offset.png-16.9kB><br>
图7.3 调节纹理的平铺（缩放）和偏移（平移）属性</p>
<p><img src=http://static.zybuluo.com/candycat/nfnonexamcr821gvsqfwm0rc/texture_properties.png alt=texture_properties.png-29kB><br>
图7.4 纹理的属性</p>
<p><img src=http://static.zybuluo.com/candycat/fs3ikv46cf3h1rumombx5toy/wrap_mode.png alt=wrap_mode.png-68.9kB><br>
图7.5 Wrap Mode决定了当纹理坐标超过[0, 1]范围后将会如何被平铺</p>
<p><img src=http://static.zybuluo.com/candycat/3pu5fg044fhfd9zcvhmx1mue/texture_offset.png alt=texture_offset.png-68.4kB><br>
图7.6 偏移（Offset）属性决定了纹理坐标的偏移量</p>
<p><img src=http://static.zybuluo.com/candycat/e15n8gjm48ldr8eoavr7p7k1/magnification.png alt=magnification.png-256.2kB><br>
图7.7 在放大纹理时，分别使用三种Filter Mode得到的结果</p>
<p><img src=http://static.zybuluo.com/candycat/jtlnp9o3hnkv4sapauejzudg/mipmap.png alt=mipmap.png-35.9kB><br>
图7.8 在Advanced模式下可以设置多级渐远纹理的相关属性</p>
<p><img src=http://static.zybuluo.com/candycat/jphpd33ux984u48qtrebzb93/minification.png alt=minification.png-271.9kB><br>
图7.9 从上到下： Point滤波 + 多级渐远纹理技术，Bilinear滤波 + 多级渐远纹理技术，Trilinear滤波 + 多级渐远纹理技术</p>
<p><img src=http://static.zybuluo.com/candycat/3tqq3cu9wdo0z874ukzje19h/texture_quality.png alt=texture_quality.png-31.7kB><br>
图7.10 选择纹理的最大尺寸和纹理模式</p>
<p><img src=http://static.zybuluo.com/candycat/679mbns3qqorjgdlzjd9f64w/heightmap.png alt=heightmap.png-134.5kB><br>
图7.11 高度图</p>
<p><img src=http://static.zybuluo.com/candycat/fpgdxhkx2vrfag4wpxkubh08/tangent_space.png alt=tangent_space.png-165.3kB><br>
图7.12 模型顶点的切线空间。其中，原点对应了顶点坐标，x轴是切线方向（t），y轴是副切线方向（b），z轴是法线方向（n）</p>
<p><img src=http://static.zybuluo.com/candycat/cn4bj1pud3ttm5mrlfa4l891/object_tangent_space_normal.png alt=object_tangent_space_normal.png-320.3kB><br>
图7.13 左图：模型空间下的法线纹理。右图：切线空间下的法线纹理</p>
<p><img src=http://static.zybuluo.com/candycat/xwv6ca3g9fdhlnu1a48lw1o4/normal_map.png alt=normal_map.png-92.2kB><br>
图7.14 使用法线纹理</p>
<p><img src=http://static.zybuluo.com/candycat/ewkjgj08b94xafdzgroq7wgh/bump_scale.png alt=bump_scale.png-140.5kB><br>
图7.15 使用Bump Scale属性来调整模型的凹凸程度</p>
<p><img src=http://static.zybuluo.com/candycat/98ol95g0rx90mbdan3fiw4n7/texture_type_normal.png alt=texture_type_normal.png-29.8kB><br>
图7.16 当使用UnpackNormal函数计算法线纹理中的法线方向时，需要把纹理类型标识为Normal map</p>
<p><img src=http://static.zybuluo.com/candycat/nd93fm3dgv4obtkxjo6dg2sg/texture_type_heightmap.png alt=texture_type_heightmap.png-293.4kB><br>
图7.17 当勾选了Create from Grayscale后，Unity会根据高度图来生成一张切线空间下的法线纹理</p>
<p><img src=http://static.zybuluo.com/candycat/lqani27ay2sk4r52hgvz7fx1/ramp_texture.png alt=ramp_texture.png-119.2kB><br>
图7.18 使用不同的渐变纹理控制漫反射光照，左下角给出了每张图使用的渐变纹理</p>
<p><img src=http://static.zybuluo.com/candycat/0wnw5wpwv2stmazzurh32jpt/ramp_texture_wrap_mode.png alt=ramp_texture_wrap_mode.png-114.2kB><br>
图7.19 Wrap Mode分别为Repeat和Clamp模式的效果对比</p>
<p><img src=http://static.zybuluo.com/candycat/h82ljkimcijox5hwj7ftpymy/mask_specular.png alt=mask_specular.png-142.4kB><br>
图7.20 使用高光遮罩纹理。从左到右：只包含漫反射，未使用遮罩的高光反射，使用遮罩的高光反射</p>
<p><img src=http://static.zybuluo.com/candycat/bu4eyurnenwal307dwbhzp2r/mask.png alt=mask.png-671.4kB><br>
图7.21 本节使用的高光遮罩纹理</p>
<h3 id=第8章-透明效果-1>第8章 透明效果</h3>
<p><img src=http://static.zybuluo.com/candycat/48l0aapqc57v0gn367tk2akx/render_order_0.png alt=render_order_0.png-10.7kB><br>
图8.1 场景中有两个物体，其中A（黄色）是半透明物体，B（紫色）是不透明物体</p>
<p><img src=http://static.zybuluo.com/candycat/5k524ddo8qib31j6s4mhkekh/render_order_1.png alt=render_order_1.png-10.5kB><br>
图8.2 场景中有两个物体，其中A和B都是半透明物体</p>
<p><img src=http://static.zybuluo.com/candycat/sl85989h54upaju75zstyv0y/render_order_3.png alt=render_order_3.png-15.3kB><br>
图8.3 循环重叠的半透明物体总是无法得到正确的半透明效果</p>
<p><img src=http://static.zybuluo.com/candycat/hi3bbsss5t48uvmi83uzjle8/render_order_2.png alt=render_order_2.png-30.4kB><br>
图8.4 使用哪个深度对物体进行排序。红色点分别标明了网格上距离摄像机最近的点、最远的点以及网格中点</p>
<p><img src=http://static.zybuluo.com/candycat/fq123k86x5alcbccjmv7gogl/transparent_texture.png alt=transparent_texture.png-71.9kB><br>
图8.5 一张透明纹理，其中每个方格的透明度都不同</p>
<p><img src=http://static.zybuluo.com/candycat/w3n0yyn3rfwc0wv4dw7i02d2/alpha_test.png alt=alpha_test.png-55.9kB><br>
图8.6 透明度测试</p>
<p><img src=http://static.zybuluo.com/candycat/a4hmfr1eltd6shzthle7ed5q/alpha_test_0.png alt=alpha_test_0.png-166.4kB><br>
图8.7 随着Alpha cutoff参数的增大，更多的像素由于不满足透明度测试条件而被剔除</p>
<p><img src=http://static.zybuluo.com/candycat/0voinls84at3n3mg77a13tdu/alpha_blend.png alt=alpha_blend.png-55.1kB><br>
图8.8 透明度混合</p>
<p><img src=http://static.zybuluo.com/candycat/5a1af3bgca3z399huyud2kwr/alpha_blend_0.png alt=alpha_blend_0.png-138.7kB><br>
图8.9 随着Alpha Scale参数的增大，模型变得越来越透明</p>
<p><img src=http://static.zybuluo.com/candycat/4thev7v5xczq02bz824witrf/transparent_order_wrong.png alt=transparent_order_wrong.png-94.7kB><br>
图8.10 当模型网格之间有互相交叉的结构时，往往会得到错误的半透明效果</p>
<p><img src=http://static.zybuluo.com/candycat/1vknx9ilky82q0kmqnxns8aj/alpha_blend_zwrite.png alt=alpha_blend_zwrite.png-87.9kB><br>
图8.11 开启了深度写入的半透明效果</p>
<p><img src=http://static.zybuluo.com/candycat/uvoq8qpet472e7fquzdu479t/blend.png alt=blend.png-74.1kB><br>
图8.12 不同混合状态设置得到的效果</p>
<p><img src=http://static.zybuluo.com/candycat/zcu57h732mubbea9ib45wx9u/alpha_test_both_sided.png alt=alpha_test_both_sided.png-60.7kB><br>
图8.13 双面渲染的透明度测试的物体</p>
<p><img src=http://static.zybuluo.com/candycat/4tq24631e9aug7xswikf9awc/alpha_blend_both_sided.png alt=alpha_blend_both_sided.png-66.2kB><br>
图8.14 双面渲染的透明度混合的物体</p>
<h3 id=第9章-更复杂的光照-1>第9章 更复杂的光照</h3>
<p><img src=http://static.zybuluo.com/candycat/n67qqzd3bc0q3gca2heih70h/rendering_path_setting.png alt=rendering_path_setting.png-30kB><br>
图9.1 设置Unity项目的渲染路径</p>
<p><img src=http://static.zybuluo.com/candycat/7wi9c0vibxtig4s1r45bugri/rendering_path_camera.png alt=rendering_path_camera.png-37.8kB><br>
图9.2 摄像机组件的Rendering Path中的设置可以覆盖Project Settings中的设置</p>
<p><img src=http://static.zybuluo.com/candycat/skolpwg0h7zzcey4gtl1rvc9/light_type_mode.png alt=light_type_mode.png-30.6kB><br>
图9.3 设置光源的类型和渲染模式</p>
<p><img src=http://static.zybuluo.com/candycat/575lq2zgnsaop3nw2miyobt3/forward_rendering.png alt=forward_rendering.png-175.5kB><br>
图9.4 前向渲染的两种Pass</p>
<p><img src=http://static.zybuluo.com/candycat/uadla1q69533nc71z7g7ep0g/directional_ligth.png alt=directional_ligth.png-51.6kB><br>
图9.5 平行光</p>
<p><img src=http://static.zybuluo.com/candycat/tvbpd08wgc0s1o31v4nw20ad/point_ligtht.png alt=point_ligtht.png-89.4kB><br>
图9.6 点光源</p>
<p><img src=http://static.zybuluo.com/candycat/8cpddt5rwnxg6ox6bml57ld7/enable_light.png alt=enable_light.png-63.6kB><br>
图9.7 开启Scene视图中的光照</p>
<p><img src=http://static.zybuluo.com/candycat/tx45g2n04xypq5cdlyblecrv/spot_light.png alt=spot_light.png-74.5kB><br>
图9.8 聚光灯</p>
<p><img src=http://static.zybuluo.com/candycat/bz1q9kyglm17psychsn255aq/two_lights.png alt=two_lights.png-79.4kB><br>
图9.9 使用一个平行光和一个点光源共同照亮物体。右图显示了胶囊体、平行光和点光源在场景中的相对位置</p>
<p><img src=http://static.zybuluo.com/candycat/z4lor2cgc0gh8rwfjimk0ckq/multi_lights.png alt=multi_lights.png-56.6kB><br>
图9.10 使用1个平行光 + 4个点光源照亮一个物体</p>
<p><img src=http://static.zybuluo.com/candycat/78c7qwpppd0h5baure1l9t1q/frame_debugger.png alt=frame_debugger.png-103.3kB><br>
图9.11 打开帧调试器查看场景的绘制事件</p>
<p><img src=http://static.zybuluo.com/candycat/e4ruexwdln51zl9nrj8s6yrl/multi_lights_0.png alt=multi_lights_0.png-218.4kB><br>
图9.12 本例中的6个渲染事件，绘制顺序是从左到右、从上到下进行的</p>
<p><img src=http://static.zybuluo.com/candycat/d1wgzjrprligehvkdmq23pra/multi_lights_1.png alt=multi_lights_1.png-100.8kB><br>
图9.13 如果物体不在一个光源的光照范围内（从右图可以看出，胶囊体不在最左方的点光源的照明范围内），Unity是不会调用Additional Pass来为该物体处理该光源的</p>
<p><img src=http://static.zybuluo.com/candycat/joseae4o6388culiwx8tfntf/light_not_important.png alt=light_not_important.png-70.8kB><br>
图9.14 当把光源的Render Mode设为Not Important时，这些光源就不会按逐像素光来处理</p>
<p><img src=http://static.zybuluo.com/candycat/11n30be5vio56i8a35qdqzrd/light_shadow.png alt=light_shadow.png-32.8kB><br>
图9.15 开启光源的阴影效果</p>
<p><img src=http://static.zybuluo.com/candycat/tp559yfnp82fb3i5g5y5qc77/mesh_renderer.png alt=mesh_renderer.png-20.3kB><br>
图9.16 Mesh Renderer组件的Cast Shadows和Receive Shadows属性可以控制该物体是否投射/接收阴影</p>
<p><img src=http://static.zybuluo.com/candycat/rd60ljcaza6xcthui0q98m29/shadow_0.png alt=shadow_0.png-34.4kB><br>
图9.17 开启Cast Shadows和Receive Shadows，从而让正方体可以投射和接收阴影</p>
<p><img src=http://static.zybuluo.com/candycat/3t7vthpva2llk7madax2rcqs/shadow_1.png alt=shadow_1.png-89kB><br>
图9.18 把Cast Shadows设置为Two Sided可以让右侧平面的背光面也产生阴影</p>
<p><img src=http://static.zybuluo.com/candycat/d33yusj8nxye922idu6ws2xe/shadow_2.png alt=shadow_2.png-40.5kB><br>
图9.19 正方体可以接收来自右侧平面的阴影</p>
<p><img src=http://static.zybuluo.com/candycat/3sjunj4mk8gizha7fve184m4/shadow_frame_debugger.png alt=shadow_frame_debugger.png-81.6kB><br>
图9.20 使用帧调试器查看阴影绘制过程</p>
<p><img src=http://static.zybuluo.com/candycat/c3c1kldvrbicscs1opg7ihjn/shadow_frame_debugger_0.png alt=shadow_frame_debugger_0.png-83.1kB><br>
图9.21 正方体对深度纹理的更新结果</p>
<p><img src=http://static.zybuluo.com/candycat/88mxjbzlwzyxsbncd8337dd1/shadow_frame_debugger_1.png alt=shadow_frame_debugger_1.png-88.6kB><br>
图9.22 屏幕空间的阴影图</p>
<p><img src=http://static.zybuluo.com/candycat/fv1abzu7knq289amxegwxqki/shadow_frame_debugger_2.png alt=shadow_frame_debugger_2.png-175.1kB><br>
图9.23 Unity绘制屏幕阴影的过程</p>
<p><img src=http://static.zybuluo.com/candycat/v0wel6w64l5x0intcrfp3vdt/alpha_test_shadow_0.png alt=alpha_test_shadow_0.png-62.8kB><br>
图9.24 可以投射阴影的使用透明度测试的物体</p>
<p><img src=http://static.zybuluo.com/candycat/ap18z7090krmbw2ftx2u3e6z/alpha_test_shadow_1.png alt=alpha_test_shadow_1.png-66.2kB><br>
图9.25 正确设置了Fallback的使用透明度测试的物体</p>
<p><img src=http://static.zybuluo.com/candycat/g4hli2g5m1371d7h1bowc4jj/alpha_test_shadow_2.png alt=alpha_test_shadow_2.png-75.7kB><br>
图9.26 正确设置了Cast Shadow属性的使用透明度测试的物体</p>
<p><img src=http://static.zybuluo.com/candycat/4qjn2sb071h7akbwxx7n5nre/alpha_blend_shadow0.png alt=alpha_blend_shadow0.png-88.6kB><br>
图9.27 把使用了透明度混合的Unity Shader的Fallback设置为内置的Transparent/VertexLit。半透明物体不会向下方的平面投射阴影，也不会接收来自右侧平面的阴影，它看起来就像是完全透明一样</p>
<p><img src=http://static.zybuluo.com/candycat/00c0x6mhf74ru1kd9ejdwlko/alpha_blend_shadow1.png alt=alpha_blend_shadow1.png-94.9kB><br>
图9.28 把Fallback设为VertexLit来强制为半透明物体生成阴影</p>
<h3 id=第10章-高级纹理-1>第10章 高级纹理</h3>
<p><img src=http://static.zybuluo.com/candycat/2r8xxicnsapkqbteoto79pxu/cubemap_sample.png alt=cubemap_sample.png-20.1kB><br>
图10.1 对立方体纹理的采样</p>
<p><img src=http://static.zybuluo.com/candycat/wg85b0wb37t0q76lbq3y6zxs/skybox_mat.png alt=skybox_mat.png-159kB><br>
图10.2 天空盒子材质</p>
<p><img src=http://static.zybuluo.com/candycat/xyoodrunl4mbbgv5brqjyq0f/lighting_skybox.png alt=lighting_skybox.png-28.7kB><br>
图10.3 为场景使用自定义的天空盒子</p>
<p><img src=http://static.zybuluo.com/candycat/s0ntkfe1bez8zovfz9c9m7d2/skybox_scene.png alt=skybox_scene.png-346.5kB><br>
图10.4 使用了天空盒子的场景</p>
<p><img src=http://static.zybuluo.com/candycat/l0sdnfmt2sqz1me0ffh2lv83/render_into_cubemap.png alt=render_into_cubemap.png-123kB><br>
图10.5 使用脚本创建立方体纹理</p>
<p><img src=http://static.zybuluo.com/candycat/0xj35c2xyghr94qejg8gu75n/render_to_cubemap.png alt=render_to_cubemap.png-133.8kB><br>
图10.6 使用脚本渲染立方体纹理</p>
<p><img src=http://static.zybuluo.com/candycat/kvbrukc9u4z3gws4z4xyjzae/reflection.png alt=reflection.png-400.5kB><br>
图10.7 使用了反射效果的Teapot模型</p>
<p><img src=http://static.zybuluo.com/candycat/mrqwqi3up3itfrnw2gbc0v81/snell_law.png alt=snell_law.png-28.6kB><br>
图10.8 斯涅尔定律</p>
<p><img src=http://static.zybuluo.com/candycat/r895gindngpqsbtf3bt9s8iz/refraction.png alt=refraction.png-377.1kB><br>
图10.9 使用了折射效果的Teapot模型</p>
<p><img src=http://static.zybuluo.com/candycat/1wv42r40xkxm2px9kwdgmsd2/fresnel.png alt=fresnel.png-64.6kB><br>
图10.10 使用了菲涅耳反射的Teapot模型</p>
<p><img src=http://static.zybuluo.com/candycat/p6xmvccttgbwoontkcz2aw6s/mirror.png alt=mirror.png-342.1kB><br>
图10.11 镜子效果</p>
<p><img src=http://static.zybuluo.com/candycat/wnvt1efwxapznql1x19hp07i/render_texture.png alt=render_texture.png-113.3kB><br>
图10.12 左图：把摄像机的Target Texture设置成自定义的渲染纹理。右图：渲染纹理使用的纹理设置</p>
<p><img src=http://static.zybuluo.com/candycat/fwsiw50bmkvtvvfchazzjc4g/glass.png alt=glass.png-462.9kB><br>
图10.13 玻璃效果</p>
<p><img src=http://static.zybuluo.com/candycat/kk334ihfwvw6uf7d457kin3e/glass_cubemap.png alt=glass_cubemap.png-140.2kB><br>
图10.14 本例使用的立方体纹理</p>
<p><img src=http://static.zybuluo.com/candycat/5kw303ah2c3bgda33qhg69o1/procedural_texture.png alt=procedural_texture.png-111.3kB><br>
图10.15 脚本生成的程序纹理</p>
<p><img src=http://static.zybuluo.com/candycat/swke90qelg832pfi56wf5csa/procedural_texture_multi.png alt=procedural_texture_multi.png-62.8kB><br>
图10.16　调整程序纹理的参数来得到不同的程序纹理</p>
<p><img src=http://static.zybuluo.com/candycat/cvzw3s5ctqu6qcuglf73e867/subtance_material.png alt=subtance_material.png-41.1kB><br>
图10.17　后缀为.sbsar的Substance材质</p>
<p><img src=http://static.zybuluo.com/candycat/nsmnfpzjoomtmjk9q2ggvl9x/subtance_material_asset.png alt=subtance_material_asset.png-78.8kB><br>
图10.18　程序纹理资源</p>
<p><img src=http://static.zybuluo.com/candycat/qqtq4kuo1cioe5hr7r9idcs5/subtance_material_multi.png alt=subtance_material_multi.png-183.5kB><br>
图10.19　调整程序纹理属性可以得到看似完全不同的程序材质效果</p>
<h3 id=第11章-让画面动起来-1>第11章 让画面动起来</h3>
<p><img src=http://static.zybuluo.com/candycat/l0k525lbsoqgxvy6hx0qcypv/boom.png alt=boom.png-140.2kB><br>
图11.1 本节使用的序列帧图像</p>
<p><img src=http://static.zybuluo.com/candycat/i1erzd6uj2qtauhnhpyoghkw/boom_sequence.png alt=boom_sequence.png-37.6kB><br>
图11.2 使用序列帧动画来实现爆炸效果</p>
<p><img src=http://static.zybuluo.com/candycat/2kti0v0qeqdg3nh4k1g1tvd9/scroll_background.png alt=scroll_background.png-228.5kB><br>
图11.3 无限滚动的背景（纹理来源：forest-background © 2012-2013 Julien Jorge <a href=mailto:julien.jorge@stuff-o-matic.com>julien.jorge@stuff-o-matic.com</a>）</p>
<p><img src=http://static.zybuluo.com/candycat/zbckc0o5c8ygxj52o1vjl6gn/river.png alt=river.png-242.7kB><br>
图11.4 使用顶点动画来模拟2D的河流</p>
<p><img src=http://static.zybuluo.com/candycat/nmwj4c59j8dif8828fehq477/basis_vector.png alt=basis_vector.png-76.2kB><br>
图11.5 法线固定（总是指向视角方向）时，计算广告牌技术中的三个正交基的过程</p>
<p><img src=http://static.zybuluo.com/candycat/bndvgjiho7jr1zpercpxh6iu/billboard.png alt=billboard.png-86.8kB><br>
图11.6 广告牌效果。左图显示了摄像机和5个广告牌之间的位置关系，摄像机是从斜上方向下观察它们的。中间的图显示了当Vertical Restraints属性为1，即固定法线方向为观察视角时所得到的效果，可以看出，所有的广告牌都完全面朝摄像机。右图显示了当Vertical Restraints属性为0，即固定指向上的方向为(0, 1, 0)时所得到的效果，可以看出，广告牌虽然最大限度地面朝摄像机，但其指向上的方向并未发生改变</p>
<p><img src=http://static.zybuluo.com/candycat/29aprg3n5fsuxup63wk5ovzl/wrong_shadow.png alt=wrong_shadow.png-147.3kB><br>
图11.7 当进行顶点动画时，如果仍然使用内置的ShadowCaster Pass来渲染阴影，可能会得到错误的阴影效果</p>
<p><img src=http://static.zybuluo.com/candycat/bfvx4iycwdjnraykcnvjpw3g/right_shadow.png alt=right_shadow.png-43.8kB><br>
图11.8 使用自定义的ShadowCaster Pass 为变形物体绘制正确的阴影</p>
<h3 id=第12章-屏幕后处理效果-1>第12章 屏幕后处理效果</h3>
<p><img src=http://static.zybuluo.com/candycat/szhonaye4dir2otxjsjc0836/brtsatcon.png alt=brtsatcon.png-651.1kB><br>
图12.1 左图：原效果。右图：调整了亮度（值为1.2）、饱和度（值为1.6）和对比度（值为1.2）后的效果</p>
<p><img src=http://static.zybuluo.com/candycat/gj5f0q2eqsnw6vb6qjslw2u5/script_shader.png alt=script_shader.png-16.6kB><br>
图12.2 为脚本设置Shader的默认值</p>
<p><img src=http://static.zybuluo.com/candycat/88uix76d65ca3yu592w0okhh/edge_detection.png alt=edge_detection.png-717.9kB><br>
图12.3 左图：12.2节得到的结果。 右图：进行边缘检测后的效果</p>
<p><img src=http://static.zybuluo.com/candycat/dvch7lp9z5d9rp4o0c1edjep/convolution.png alt=convolution.png-15.1kB><br>
图12.4 卷积核与卷积。使用一个3×3大小的卷积核对一张5×5大小的图像进行卷积操作，当计算图中红色方块对应的像素的卷积结果时，我们首先把卷积核的中心放置在该像素位置，翻转核之后再依次计算核中每个元素和其覆盖的图像像素值的乘积并求和，得到新的像素值</p>
<p><img src=http://static.zybuluo.com/candycat/bm2nnarbl2h6fmmjq1gsfb7c/edge_detection_kernel.png alt=edge_detection_kernel.png-19.8kB><br>
图12.5 三种常见的边缘检测算子</p>
<p><img src=http://static.zybuluo.com/candycat/qg856glqkbkaw28vmwl59kic/edge_only.png alt=edge_only.png-266.5kB><br>
图12.6 只显示边缘的屏幕效果</p>
<p><img src=http://static.zybuluo.com/candycat/0y9xt8awtvueymd63g829vmu/gaussian_blur.png alt=gaussian_blur.png-703.8kB><br>
图12.7 左图：原效果。右图：高斯模糊后的效果</p>
<p><img src=http://static.zybuluo.com/candycat/qdi1a1gaicihr3tju2acbcdc/gaussian_kernel.png alt=gaussian_kernel.png-21.2kB><br>
图12.8 一个5×5大小的高斯核。左图显示了标准方差为1的高斯核的权重分布。我们可以把这个二维高斯核拆分成两个一维的高斯核（右图）</p>
<p><img src=http://static.zybuluo.com/candycat/0k9u1k5rrg9cq4gj4mwj1l0x/800px-Elephants_Dream_-_Emo_and_Proog.jpg alt=800px-Elephants_Dream_-_Emo_and_Proog.jpg-41.9kB><br>
图12.9 动画短片《大象之梦》中的Bloom效果。光线透过门扩散到了周围较暗的区域中</p>
<p><img src=http://static.zybuluo.com/candycat/gt2h3xoo89hmvm8o85pso5uh/bloom.png alt=bloom.png-772.3kB><br>
图12.10 左图：原效果。右图：Bloom处理后的效果</p>
<p><img src=http://static.zybuluo.com/candycat/ryde8k1k1bm5j7dxgdo5w0ks/motion_blur.png alt=motion_blur.png-770.9kB><br>
图12.11 左图：原效果。右图：应用运动模糊后的效果</p>
<h3 id=第13章-使用深度和法线纹理-1>第13章 使用深度和法线纹理</h3>
<p><img src=http://static.zybuluo.com/candycat/u6fma5c4boo56dgjbgczlb2i/projection_matrix.png alt=projection_matrix.png-150.4kB><br>
图13.1 在透视投影中，投影矩阵首先对顶点进行了缩放。在经过齐次除法后，透视投影的裁剪空间会变换到一个立方体。图中标注了4个关键点经过投影矩阵变换后的结果</p>
<p><img src=http://static.zybuluo.com/candycat/8idbd0mykpsqnj16t84uwsml/orthographic_matrix.png alt=orthographic_matrix.png-129.6kB><br>
图13.2 在正交投影中，投影矩阵对顶点进行了缩放。在经过齐次除法后，正交投影的裁剪空间会变换到一个立方体。图中标注了4个关键点经过投影矩阵变换后的结果</p>
<p><img src=http://static.zybuluo.com/candycat/xnqw3nkojdxml562evws8aug/check_texture.png alt=check_texture.png-161.3kB><br>
图13.3 使用Frame Debugger查看深度纹理（左）和深度+法线纹理（右）。如果当前摄像机需要生成深度和法线纹理，帧调试器的面板中就会出现相应的渲染事件。只要单击对应的事件就可以查看得到的深度和法线纹理</p>
<p><img src=http://static.zybuluo.com/candycat/kp57syi72i7jloyghgbeqy82/check_texture_code.png alt=check_texture_code.png-84kB><br>
图13.4 左图：线性空间下的深度纹理。右图：解码后并且被映射到[0, 1]范围内的视角空间下的法线纹理</p>
<p><img src=http://static.zybuluo.com/candycat/6yzf4h789v3117qpa4t2k931/fog.png alt=fog.png-627.5kB><br>
图13.5 左图：原效果。右图：添加全局雾效后的效果</p>
<p><img src=http://static.zybuluo.com/candycat/cisfq83ut1mx2ou313e1nqg2/frustum.png alt=frustum.png-33.5kB><br>
图13.6 计算interpolatedRay</p>
<p><img src=http://static.zybuluo.com/candycat/6h2nnw3gwzcio21jbji2o2dw/world_dist.png alt=world_dist.png-18.6kB><br>
图13.7 采样得到的深度值并非是点到摄像机的欧式距离</p>
<p><img src=http://static.zybuluo.com/candycat/20oe6ovk2wn4ko2el5ldwfs9/over_edge.png alt=over_edge.png-819kB><br>
图13.8 左图：原效果。右图：直接对颜色图像进行边缘检测的结果</p>
<p><img src=http://static.zybuluo.com/candycat/snzxjfahsz29po5mcrfrczmu/edge_detect.png alt=edge_detect.png-452.9kB><br>
图13.9 在深度和法线纹理上进行更健壮的边缘检测。左图：在原图上描边的效果。右图：只显示描边的效果</p>
<p><img src=http://static.zybuluo.com/candycat/ziah5yj1twj4nva7ldvw8dnk/Roberts.png alt=Roberts.png-15.7kB><br>
图13.10 Roberts算子</p>
<h3 id=第14章-非真实感渲染-1>第14章 非真实感渲染</h3>
<p><img src=http://static.zybuluo.com/candycat/aa2hjqkoibcqmq5g5azdkrfb/okami_announce_screens6.jpg alt=okami_announce_screens6.jpg-169.9kB><br>
图14.1 游戏《大神》（英文名：Okami）的游戏截图</p>
<p><img src=http://static.zybuluo.com/candycat/0x7o2vyl6fn74gwtunvdgufp/toon_shading.png alt=toon_shading.png-74.1kB><br>
图14.2 卡通风格的渲染效果</p>
<p><img src=http://static.zybuluo.com/candycat/z8c9f6kzclslbl0wdw7gxach/antialiasing.png alt=antialiasing.png-138.4kB><br>
图14.3 左图：未对高光区域进行抗锯齿处理。右图：使用fwidth函数对高光区域进行抗锯齿处理</p>
<p><img src=http://static.zybuluo.com/candycat/9h63lflg1a7f759pw5cwfqvz/TAM.png alt=TAM.png-127.6kB><br>
图14.4 一个TAM的例子（来源：Praun E, et al. Real-time hatching<a href=http://static.zybuluo.com/candycat/qwr4r6aglmod38w2k1e0dq7h/CopyDataToGPU.png>4</a>）</p>
<p><img src=http://static.zybuluo.com/candycat/60jzr7ly5yqqcg09rfrc3icb/hatching.png alt=hatching.png-268.1kB><br>
图14.5 素描风格的渲染效果</p>
<h3 id=第15章-使用噪声-1>第15章 使用噪声</h3>
<p><img src=http://static.zybuluo.com/candycat/43pgznadojl5el7s23zpki7x/burn.png alt=burn.png-429.1kB><br>
图15.1 箱子的消融效果</p>
<p><img src=http://static.zybuluo.com/candycat/l8caf290oitxfnenqu38ed95/burn_noise.png alt=burn_noise.png-84.8kB><br>
图15.2 消融效果使用的噪声纹理</p>
<p><img src=http://static.zybuluo.com/candycat/rgxn8cpsc4isivqouvbxtev7/water.png alt=water.png-722.5kB><br>
图15.3 包含菲涅耳反射的水面波动效果。在左图中，视角方向和水面法线的夹角越大，反射效果越强。在右图中，视角方向和水面法线的夹角越大，折射效果越强</p>
<p><img src=http://static.zybuluo.com/candycat/lh1zewua7dl2p8olhmctowoz/cubemap.png alt=cubemap.png-128.3kB><br>
图15.4 本例使用的立方体纹理</p>
<p><img src=http://static.zybuluo.com/candycat/unuc9j0kp9fffr7jcnbowvzi/water_noise.png alt=water_noise.png-202kB><br>
图15.5 水波效果使用的噪声纹理。左图：噪声纹理的灰度图。右图：由左图生成的法线纹理</p>
<p><img src=http://static.zybuluo.com/candycat/dmrvnch1muikmc6f50sdwdho/fog.png alt=fog.png-493.9kB><br>
图15.6 左图：均匀雾效。右图：使用噪声纹理后的非均匀雾效</p>
<p><img src=http://static.zybuluo.com/candycat/kfctu0s78fl2pepr9h1hgjpo/fog_noise.jpg alt=fog_noise.jpg-13kB><br>
图15.7 本节使用的噪声纹理</p>
<h3 id=第16章-unity中的渲染优化技术-1>第16章 Unity中的渲染优化技术</h3>
<p><img src=http://static.zybuluo.com/candycat/mw2e3pfqk097fps9wbcwv8ff/render_static_window.png alt=render_static_window.png-156.1kB><br>
图16.1 Unity 5的渲染统计窗口</p>
<p><img src=http://static.zybuluo.com/candycat/f1fpglqqgcg7q17tum55e8bh/profiler.png alt=profiler.png-122.5kB><br>
图16.2 使用Unity的性能分析器中的渲染区域来查看更多关于渲染的统计信息</p>
<p><img src=http://static.zybuluo.com/candycat/3qa6mzh0mc1q7jiqhaf3j7mv/frame_debugger.png alt=frame_debugger.png-84.3kB><br>
图16.3 使用帧调试器来查看单独的draw call的绘制结果</p>
<p><img src=http://static.zybuluo.com/candycat/ytyrujgdcz4dxpvm8nw3tibd/dynamic_batching0.png alt=dynamic_batching0.png-138.9kB><br>
图16.4 动态批处理</p>
<p><img src=http://static.zybuluo.com/candycat/0l9c6cjb4czi02hxr8e2ij0o/dynamic_batching1.png alt=dynamic_batching1.png-138.9kB><br>
图16.5 多光源对动态批处理的影响结果</p>
<p><img src=http://static.zybuluo.com/candycat/h7pzd9j05aelvv6cafs7juzv/static_batching0.png alt=static_batching0.png-112.9kB><br>
图16.6 静态批处理前的渲染统计数据</p>
<p><img src=http://static.zybuluo.com/candycat/jkgbb245hcnoxzq4k3go3yba/mark_static.png alt=mark_static.png-22.3kB><br>
图16.7 把物体标志为Static</p>
<p><img src=http://static.zybuluo.com/candycat/p7h3m5syxv9g7i928zohzhas/static_batching1.png alt=static_batching1.png-112.3kB><br>
图16.8 静态批处理</p>
<p><img src=http://static.zybuluo.com/candycat/kfz63didqcnctti7ft8lvtpw/combined_mesh.png alt=combined_mesh.png-152.1kB><br>
图16.9 静态批处理中Unity会合并所有被标识为“Static”的物体</p>
<p><img src=http://static.zybuluo.com/candycat/u9o9tk9oispyksk3ag41an3x/vbo.png alt=vbo.png-92kB><br>
图16.10 静态批处理会占用更多的内存。左图：静态批处理前的渲染统计数据。右图：静态批处理后的渲染统计数据</p>
<p><img src=http://static.zybuluo.com/candycat/zul250cb0n5x5w5821tu4xwd/static_batching2.png alt=static_batching2.png-113.6kB><br>
图16.11 处理其他逐像素光的Pass不会被静态批处理</p>
<p><img src=http://static.zybuluo.com/candycat/58dcw7v9r39i2p2izrtxq5bs/advance_texture.png alt=advance_texture.png-96.6kB><br>
图16.12 Unity的高级纹理设置面板</p>
<h3 id=第17章-surface-shader探秘-1>第17章 Surface Shader探秘</h3>
<p><img src=http://static.zybuluo.com/candycat/slo759tsffn90428bqqkt054/bumped_diffuse.png alt=bumped_diffuse.png-164.7kB><br>
图17.1 表面着色器的例子。左图：在一个平行光下的效果。右图：添加了一个点光源（蓝色）和一个聚光灯（紫色）后的效果</p>
<p><img src=http://static.zybuluo.com/candycat/rt3i7s74tdilo8185rexkowi/generated_code.png alt=generated_code.png-28.9kB><br>
图17.2 查看表面着色器生成的代码</p>
<p><img src=http://static.zybuluo.com/candycat/rokaz0qqzk11hyj7ntkss3ze/pipeline.png alt=pipeline.png-171.9kB><br>
图17.3 表面着色器的渲染计算流水线。黄色：可以自定义的函数。灰色：Unity自动生成的计算步骤</p>
<p><img src=http://static.zybuluo.com/candycat/bhggsxnr7rlhkzs8u68mqarn/normal_extrusion.png alt=normal_extrusion.png-127.3kB><br>
图17.4 沿顶点法线对模型进行膨胀。左图：膨胀前。右图：膨胀后</p>
<h3 id=第18章-基于物理的渲染-1>第18章 基于物理的渲染</h3>
<p><img src=http://static.zybuluo.com/candycat/nw3v0p25h9165552cshmr1t1/reflect_refract.png alt=reflect_refract.png-26.9kB><br>
图18.1 在理想的边界处，折射率的突变会把光线分成两个方向</p>
<p><img src=http://static.zybuluo.com/candycat/zmrvmeo27ach7kjpxm1grnwb/rought_smooth.png alt=rought_smooth.png-64.6kB><br>
图18.2 左图：光滑表面的微平面的法线变化较小，反射光线的方向变化也更小。 右图：粗糙表面的微平面的法线变化较大，反射光线的方向变化也更大</p>
<p><img src=http://static.zybuluo.com/candycat/ezo6d9xa3vv6l97hdy48jltc/subsurface_scattered_light.png alt=subsurface_scattered_light.png-36.3kB><br>
图18.3 微表面对光的折射。这些被折射的光中一部分被吸收，一部分又被散射到外部</p>
<p><img src=http://static.zybuluo.com/candycat/th1ophcgurbsh1jbobzz2d6k/surface.png alt=surface.png-42.5kB><br>
图18.4 次表面散射。左图：次表面散射的光线会从不同于入射点的位置射出。如果这些距离值小于需要被着色的像素大小，那么渲染就可以完全在局部完成（右图）。否则，就需要使用次表面散射渲染技术</p>
<p><img src=http://static.zybuluo.com/candycat/08orrgge69y3d3zgp4gfpcn9/brdf.png alt=brdf.png-47.1kB><br>
图18.5 BRDF描述的两种现象。高光反射部分用于描述反射，漫反射部分用于描述次表面散射</p>
<p><img src=http://static.zybuluo.com/candycat/d03qynt6prxeq7cep9b1jl91/m_h.png alt=m_h.png-90.5kB><br>
图18.6 （a）那些m=h的微面元会恰好把入射光从I反射到v上，只有这部分微面元才可以添加到BRDF的计算中。（b）一部分满足（a）的微面元会在I方向上被其他微面元遮挡住，它们不会接受到光照，因此会形成阴影。（c）还有一部分满足（a）的微面元会在反射方向v上被其他微面元挡住，因此，这部分反射光也不会被看到</p>
<p><img src=http://static.zybuluo.com/candycat/8yd8tgsx8x1tvdcwuxxowgt3/standard_shader.png alt=standard_shader.png-276.6kB><br>
图18.7 Standard Shader中前向渲染路径使用的Pass（简化版本的PBS使用了VertexOutputBaseSimple等结构体来代替相应的结构体）</p>
<p><img src=http://static.zybuluo.com/candycat/kpx9eqzt6xjtw7lp9uac9qc8/calibration_charts.png alt=calibration_charts.png-387.8kB><br>
图18.8 Unity提供的校准表格。左图：金属工作流 使用的校准表格。右图：高光反射工作流使用的校准表格</p>
<p><img src=http://static.zybuluo.com/candycat/0y8tojxhwa92hjy4oo20ii9p/metallic_workflow.png alt=metallic_workflow.png-181.6kB><br>
图18.9 使用金属工作流来实现不同类型的材质。左边的球体：金属材质。右边的球体：塑料材质</p>
<p><img src=http://static.zybuluo.com/candycat/rre47eai63qgeh811clxbev2/pbs_scene.png alt=pbs_scene.png-625.7kB><br>
图18.10 在Unity 5中使用基于物理的渲染技术，场景在不同光照下的渲染结果</p>
<p><img src=http://static.zybuluo.com/candycat/829ewyjmvzjm082xpyysvqfz/lighting_inspector.png alt=lighting_inspector.png-48.9kB><br>
图18.11 光照面板下的Scene标签页</p>
<p><img src=http://static.zybuluo.com/candycat/nlh6q7gqgwlbitske1z8938i/reflect_source.png alt=reflect_source.png-349.6kB><br>
图18.12 左图：当关闭场景中的所有光源并把环境光照强度设为0后，使用了Standard Shader的物体仍然具有光照效果。右图：在左图的基础上，把反射源设置为空，使得物体不接受任何默认的反射信息</p>
<p><img src=http://static.zybuluo.com/candycat/x7cxbmmb2xdzke3m0asowtu9/direction_light.png alt=direction_light.png-29.3kB><br>
图18.13 使用的平行光</p>
<p><img src=http://static.zybuluo.com/candycat/61ycjyc3k04bjh8sai6womkn/bounce_intensity.png alt=bounce_intensity.png-645.9kB><br>
图18.14 左图：将Bounce Intensity设置为0，物体不再受到间接光照的影响，木屋内阴影部分的可见细节很少。右图：将Bounce Intensity设为8，阴影部分的细节更加清楚</p>
<p><img src=http://static.zybuluo.com/candycat/twic91rz1143c14rc0t1n1ie/reflection_probe.png alt=reflection_probe.png-615.8kB><br>
图18.15 左图：未使用反射探针。右图：在场景中放置了两个反射探针，注意墙上的盾牌与左图的差别</p>
<p><img src=http://static.zybuluo.com/candycat/d7amfp6yscz10g5yk0kybwd1/interreflection.png alt=interreflection.png-338.2kB><br>
图18.16 使用反射探针实现相互反射的效果</p>
<p><img src=http://static.zybuluo.com/candycat/umachb7kklgerrvsphv7yyoj/linear_space.png alt=linear_space.png-611.4kB><br>
图18.17 左图：在线性空间下的渲染结果。右图：在伽马空间下的渲染结果</p>
<p><img src=http://static.zybuluo.com/candycat/uizo2ug3l5ovy68zbn9afde0/gamma_chart.png alt=gamma_chart.png-29.3kB><br>
图18.18 人眼更容易感知暗部区域的变换，而对较亮区域的变化比较不敏感</p>
<p><img src=http://static.zybuluo.com/candycat/2y5h6wx9hupw5nv2ugtseyqn/encoding_display_gamma.png alt=encoding_display_gamma.png-37.5kB><br>
图18.19 编码伽马和显示伽马</p>
<p><img src=http://static.zybuluo.com/candycat/xuxe7bp91pykknxybt6yu2wu/gamma_light.png alt=gamma_light.png-32.1kB><br>
图18.20 左图：伽马空间下的渲染结果。右图：线性空间下的渲染结果</p>
<p><img src=http://static.zybuluo.com/candycat/a4e1xfpbxduwotib6o4dty5s/gamma_blur.png alt=gamma_blur.png-85.2kB><br>
图18.21 左图：伽马空间下的混合结果。右图：线性空间下的混合结果</p>
<h3 id=第19章-unity-5更新了什么>第19章 Unity 5更新了什么</h3>
<p><img src=http://static.zybuluo.com/candycat/wosup72bju19rx6rkucnk7y6/show_fixed_function.png alt=show_fixed_function.png-29.5kB><br>
图19.1 在shader的导入面板中，单击图中按钮可查看Unity为该固定管线着色器生成的顶点/片元着色器代码B](<a href=http://static.zybuluo.com/candycat/xuxe7bp91pykknxybt6yu2wu/gamma_light.png>http://static.zybuluo.com/candycat/xuxe7bp91pykknxybt6yu2wu/gamma_light.png</a>)<br>
图18.20 左图：伽马空间下的渲染结果。右图：线性空间下的渲染结果</p>
<p><img src=http://static.zybuluo.com/candycat/a4e1xfpbxduwotib6o4dty5s/gamma_blur.png alt=gamma_blur.png-85.2kB><br>
图18.21 左图：伽马空间下的混合结果。右图：线性空间下的混合结果</p>
<h3 id=第19章-unity-5更新了什么-1>第19章 Unity 5更新了什么</h3>
<p><img src=http://static.zybuluo.com/candycat/wosup72bju19rx6rkucnk7y6/show_fixed_function.png alt=show_fixed_function.png-29.5kB><br>
图19.1 在shader的导入面板中，单击图中按钮可查看Unity为该固定管线着色器生成的顶点/片元着色器代码</p>
</article>
<script defer src=/js/clipboard.min.1626706afc88d95ebe1173b553ec732c6dc82a576989315fdf5e7779af738a44.js></script>
<script defer src=/js/helper/prev.min.js></script>
<script defer src=/js/helper/prop.min.js></script>
<script>'use strict';document.addEventListener('DOMContentLoaded',function(){var a=!1,b=document.querySelectorAll('pre.chroma'),c=document.querySelectorAll('.language-code'),d=document.querySelectorAll('div.language-\\$'),e=document.querySelectorAll('div.language-\\>'),f=function(c){var k=c,b=c.textContent,j,g,h,i,d,f,e;if(b.length>15){a||(j=new ClipboardJS('.copy-to-clipboard',{text:function(a){var c=prev(a).querySelectorAll('code');return c.length>1?b=prev(a).querySelector('code[class^="language-"]').textContent:b=prev(a).querySelector('code').textContent,b.replace(/^\$\s/gm,'')}}),j.on('success',function(a){a.clearSelection(),g=prop(a.trigger.parentNode,'tagName')=='PRE',a.trigger.setAttribute('aria-label','Copied to clipboard!'),a.trigger.classList.add('tooltipped'),a.trigger.classList.add('tooltipped-w')}),j.on('error',function(a){g=prop(a.trigger.parentNode,'tagName')=='PRE',a.trigger.setAttribute('aria-label',a.action.toString()),a.trigger.classList.add('tooltipped'),a.trigger.classList.add('tooltipped-w')}),a=!0),h=['language-mermaid','language-viz','language-wave','language-chart','language-msc','language-flowchart'],i=!1,d=k.getAttribute('class');for(f=0;f<h.length;f++)if(d&&d.startsWith(h[f])){i=!0;break}i||d&&(e=document.createElement('span'),e.setAttribute('class','copy-to-clipboard'),e.setAttribute('title','Copy to clipboard'),c.parentNode.parentNode.insertBefore(e,c.parentNode.nextElementSibling))}},g=function(b){var a=document.createElement('span');a.setAttribute('class','copy-to-clipboard'),a.setAttribute('title','Copy to clipboard'),b.parentNode.parentNode.insertBefore(a,b.parentNode.nextElementSibling)};b?b.forEach(function(a){a.querySelectorAll('code').forEach(function(a){f(a)})}):null,c?c.forEach(function(a){a.querySelectorAll('code').forEach(function(a){f(a)})}):null,d?d.forEach(function(a){a.querySelectorAll('code').forEach(function(a){g(a)})}):null,e?e.forEach(function(a){a.querySelectorAll('code').forEach(function(a){g(a)})}):null})</script>
<script>'use strict';var langCodeElem,dollarCodeElem,gtCodeElem;function wrap(a,b){a.parentNode.insertBefore(b,a),b.appendChild(a)}(function(){var a=document.querySelector('.single__contents');a?a.querySelectorAll('pre > code').forEach(function(b){var a=b.getAttribute('data-lang'),c=document.createElement('div'),e=null,d=null;a&&a.includes(':')?(e=a.split(':')[0],d=a.split(':')[1],c.className='language-'+e,c.setAttribute('data-lang',d),b.className='language-'+e,b.setAttribute('data-lang',d),b.setAttribute('id',d)):a||(c.setAttribute('data-lang','Code'),c.className='language-code'),(!a||d)&&wrap(b.parentNode,c)}):null})(),langCodeElem=document.querySelectorAll('.language-code'),langCodeElem?langCodeElem.forEach(function(b){var a=document.createElement('span');a.className='copy-to-clipboard',a.setAttribute('title','Copy to clipboard'),b.append(a)}):null,dollarCodeElem=document.querySelectorAll('div.language-\\$'),gtCodeElem=document.querySelectorAll('div.language-\\>'),dollarCodeElem?dollarCodeElem.forEach(function(a){var b=a.parentNode.parentNode?a.parentNode.parentNode.querySelectorAll('.lnt'):null;b?b.forEach(function(a){a.innerHTML='$<br/>'}):null}):null,gtCodeElem?gtCodeElem.forEach(function(a){var b=a.parentNode.parentNode?a.parentNode.parentNode.querySelectorAll('.lnt'):null;b?b.forEach(function(a){a.innerHTML='><br/>'}):null}):null</script>
<section class=related>
</section>
<div class=grow></div>
<nav class=pagination-single>
<a href=https://yslinwe.github.io/posts/%E5%85%B3%E4%BA%8E%E4%B8%80%E4%B8%AA%E6%8C%87%E9%92%88%E5%8F%96%E5%80%BC%E7%9A%84%E9%97%AE%E9%A2%98/ class=pagination-single__left>
<div class=pagination-single__icon><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentcolor" d="M19 11H7.83l4.88-4.88c.39-.39.39-1.03.0-1.42s-1.02-.39-1.41.0l-6.59 6.59c-.39.39-.39 1.02.0 1.41l6.59 6.59c.39.39 1.02.39 1.41.0s.39-1.02.0-1.41L7.83 13H19c.55.0 1-.45 1-1s-.45-1-1-1z"/></svg>
</div>
<div class=pagination-single__left-title>关于一个指针取值的问题</div>
</a>
<div class=grow></div>
<a href=https://yslinwe.github.io/posts/public-private-protected/ class=pagination-single__right>
<div class=pagination-single__right-title>public，private，protected的区别，继承方法与访问权限</div>
<div class=pagination-single__icon><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentcolor" d="M5 13h11.17l-4.88 4.88c-.39.39-.39 1.03.0 1.42.39.39 1.02.39 1.41.0l6.59-6.59c.39-.39.39-1.02.0-1.41l-6.58-6.6c-.39-.39-1.02-.39-1.41.0s-.39 1.02.0 1.41L16.17 11H5c-.55.0-1 .45-1 1s.45 1 1 1z"/></svg>
</div>
</a>
</nav>
<div class="modal micromodal-slide" id=modal aria-hidden=true>
<div class=modal__overlay tabindex=-1 data-micromodal-close>
<div class=modal__container role=dialog aria-modal=true aria-labelledby=modal-title>
<div class=modal__content id=modal-content>
<div id=mySwipe class=swipe>
<div class=swipe-wrap>
</div>
</div>
</div>
<span class=modal__items>
<span class=modal__header>
<div class=modal__paging title="Page Info" aria-label="Current Page">
</div>
<div class="modal__icon modal__toolbar modal__toolbar--close" title=Close aria-label="Close Button" data-micromodal-close><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="25" height="25"><path fill="currentcolor" d="M21.734375 19.640625l-2.097656 2.09375C19.253906 22.121094 18.628906 22.121094 18.242188 21.734375L13 16.496094 7.761719 21.734375C7.375 22.121094 6.746094 22.121094 6.363281 21.734375l-2.097656-2.09375c-.386719-.386718999999999-.386719-1.011719.0-1.398437L9.503906 13 4.265625 7.761719c-.382812-.390625-.382812-1.019531.0-1.398438L6.363281 4.265625C6.746094 3.878906 7.375 3.878906 7.761719 4.265625L13 9.507813l5.242188-5.242188c.386718000000002-.386719 1.015625-.386719 1.394531.0l2.097656 2.09375C22.121094 6.746094 22.121094 7.375 21.738281 7.761719L16.496094 13l5.238281 5.242188C22.121094 18.628906 22.121094 19.253906 21.734375 19.640625z"/></svg>
</div>
<div class="modal__icon modal__toolbar modal__toolbar--full" title="Full Screen" aria-label="Full Screen Button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="25" height="25"><path fill="currentcolor" d="M5 3C3.9069372 3 3 3.9069372 3 5V8A1.0001 1.0001.0 105 8V5H8A1.0001 1.0001.0 108 3H5zM16 3a1.0001 1.0001.0 100 2h3V8a1.0001 1.0001.0 102 0V5C21 3.9069372 20.093063 3 19 3H16zM3.984375 14.986328A1.0001 1.0001.0 003 16v3c0 1.093063.9069372 2 2 2H8a1.0001 1.0001.0 100-2H5V16A1.0001 1.0001.0 003.984375 14.986328zm16 0A1.0001 1.0001.0 0019 16v3H16a1.0001 1.0001.0 100 2h3C20.093063 21 21 20.093063 21 19V16a1.0001 1.0001.0 00-1.015625-1.013672z"/></svg>
</div>
<div class="modal__icon modal__toolbar modal__toolbar--normal" title="Normal Screen" aria-label="Normal Screen Button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" width="25" height="25"><path fill="currentcolor" d="M16.96875 4.972656C15.867188 4.988281 14.984375 5.894531 15 7v8H7C6.277344 14.988281 5.609375 15.367188 5.246094 15.992188 4.878906 16.613281 4.878906 17.386719 5.246094 18.007813 5.609375 18.632813 6.277344 19.011719 7 19H19V7C19.007813 6.460938 18.796875 5.941406 18.414063 5.558594 18.03125 5.175781 17.511719 4.964844 16.96875 4.972656zm16 0c-1.046875.015625-1.90625.839844-1.964844 1.886719C31 6.90625 31 6.953125 31 7V19H43C43.066406 19 43.132813 19 43.199219 18.992188 44.269531 18.894531 45.070313 17.972656 45.015625 16.902344 44.964844 15.828125 44.074219 14.988281 43 15H35V7C35.007813 6.460938 34.796875 5.941406 34.414063 5.558594 34.03125 5.175781 33.511719 4.964844 32.96875 4.972656zM7 31C6.277344 30.988281 5.609375 31.367188 5.246094 31.992188 4.878906 32.613281 4.878906 33.386719 5.246094 34.007813 5.609375 34.632813 6.277344 35.011719 7 35h8v8C14.988281 43.722656 15.367188 44.390625 15.992188 44.753906 16.613281 45.121094 17.386719 45.121094 18.007813 44.753906 18.632813 44.390625 19.011719 43.722656 19 43V31zm24 0V43C30.988281 43.722656 31.367188 44.390625 31.992188 44.753906 32.613281 45.121094 33.386719 45.121094 34.007813 44.753906 34.632813 44.390625 35.011719 43.722656 35 43V35h8C43.722656 35.011719 44.390625 34.632813 44.753906 34.007813 45.121094 33.386719 45.121094 32.613281 44.753906 31.992188 44.390625 31.367188 43.722656 30.988281 43 31z"/></svg>
</div>
</span>
<div class="modal__icon modal__arrow modal__arrow--left" title="Arrow Left" aria-label="Arrow Left Button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentcolor" d="M23.28125 11 10 10V6.851563C10 6.523438 9.839844 6.277344 9.519531 6.03125 9.199219 5.949219 8.878906 5.949219 8.640625 6.113281c-3.28125 2.296875-6.402344 6.144532-6.480469 6.308594-.078125.15625-.152343.390625-.15625.554688000000001C2.003906 12.980469 2 12.988281 2 12.992188 2 13.15625 2.078125 13.402344 2.160156 13.484375 2.238281 13.648438 5.28125 17.507813 8.640625 19.804688 8.960938 19.96875 9.28125 20.050781 9.519531 19.886719 9.839844 19.722656 10 19.476563 10 19.148438V16l13.28125-1C23.679688 14.679688 24 13.875 24 12.992188 24 12.195313 23.761719 11.320313 23.28125 11z"/></svg>
</div>
<div class="modal__icon modal__arrow modal__arrow--right" title="Arrow Right" aria-label="Arrow Right Button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 26 26" width="28" height="28"><path fill="currentcolor" d="M2.71875 11.023438l13.28125-1V6.875C16 6.546875 16.160156 6.300781 16.480469 6.054688 16.800781 5.972656 17.121094 5.972656 17.359375 6.136719c3.28125 2.296875 6.402344 6.144531 6.480469 6.308594.078125.15625.152343999999999.390625.15625.554687C23.996094 13.003906 24 13.011719 24 13.015625 24 13.179688 23.921875 13.425781 23.839844 13.507813 23.761719 13.671875 20.71875 17.53125 17.359375 19.828125 17.039063 19.992188 16.71875 20.074219 16.480469 19.910156 16.160156 19.746094 16 19.5 16 19.171875V16.023438L2.71875 15.023438C2.320313 14.703125 2 13.898438 2 13.015625c0-.796875.238281-1.671875.71875-1.992187z"/></svg>
</div>
<div class=modal__caption>
<div class=modal__caption--text>
</div>
</div>
</span>
</div>
</div>
</div>
<script defer src=/js/swipe.min.989e074dfb92ce7f57a92c1df7027f88b53c50a54fd9ad450a673a64aa91bfa4.js></script>
<script defer src=/js/micromodal.min.de01b44b2f383056bbcaf6ee921fd385d79108ec1129afd0eb2f3f5a07e11f45.js></script>
<script defer src=/js/helper/fadeinout.min.js></script>
<script>document.addEventListener('DOMContentLoaded',function(){var d=document.documentElement,g,f,s,r,m,o,l,b,c,i,n,e,h,j,a,p,q;function t(){d.requestFullscreen?d.requestFullscreen():d.mozRequestFullScreen?d.mozRequestFullScreen():d.webkitRequestFullscreen?d.webkitRequestFullscreen():d.msRequestFullscreen&&d.msRequestFullscreen()}function k(){(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)&&(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen())}g=document.getElementById('modal'),f=document.querySelector('.gallery__container'),s=document.querySelector('.swipe-wrap'),r=document.getElementById('mySwipe'),m=document.querySelector('.modal__arrow--left'),o=document.querySelector('.modal__arrow--right'),l=document.querySelector('.modal__toolbar--close'),b=document.querySelector('.modal__toolbar--full'),c=document.querySelector('.modal__toolbar--normal'),i=document.querySelector('.modal__caption'),n=document.querySelector('.modal__paging'),e=document.querySelector('.modal__items'),h=null,j=null,a=null,p=function(b){b.key==='ArrowRight'?g&&g.classList.contains('is-open')&&a.next():b.key==='ArrowLeft'&&g&&g.classList.contains('is-open')&&a.prev()},f?h=f.querySelectorAll('img').length:(f=document.querySelector('.single__contents'),h=f.querySelectorAll('img').length),MicroModal.init({onClose:function(){a&&(a.kill(),a=null,k()),window.removeEventListener('keydown',p)},disableScroll:!0,disableFocus:!0,awaitOpenAnimation:!1,awaitCloseAnimation:!1,debugMode:!1}),q=function(a){return new Promise(function(c,d){var b=new Image;b.onload=function(){c(b)},b.onerror=d,b.src=a})},f.querySelectorAll('img').forEach(function(g,k){var f,d;g.style.cursor='pointer',f=g.cloneNode(!0),f.style.maxHeight='100%',f.style.maxWidth='100%',f.onclick=function(a){a.stopPropagation()},d=document.createElement('div'),d.style.width='100%',d.style.height='100vh',d.setAttribute('data-micromodal-close',''),d.onclick=function(){a&&(a.kill(),a=null)},d.onmouseenter=function(){clearTimeout(j),fadeIn(e,200)},d.onmouseleave=function(){j=setTimeout(function(){fadeOut(e,200)},2500)},d.ontouchstart=function(){fadeIn(e,200)},d.append(f),s.append(d),g.addEventListener('click',async function(d){var m,l,g;MicroModal.show('modal'),a&&(a.kill(),a=null),m=d.target.getAttribute('data-src')||d.target.getAttribute('src'),l=await q(m),f.style.width=l.width+'px',f.style.height=l.height+'px',a=new Swipe(r,{startSlide:k,draggable:!0,autoRestart:!1,continuous:!1,disableScroll:!0,stopPropagation:!0,callback:async function(d,f){var a=f.querySelector('img'),g=a.getAttribute('data-src')||a.getAttribute('src'),c=await q(g),b;a.style.width=c.width+'px',a.style.height=c.height+'px',i&&a&&(b=null,a.getAttribute('data-caption')?b=a.getAttribute('data-caption'):a.getAttribute('title')?b=a.getAttribute('title'):a.getAttribute('alt')?b=a.getAttribute('alt'):b=a.getAttribute('src'),i.querySelector('.modal__caption--text').innerText=b,n.innerText=d+1+' / '+h,clearTimeout(j),fadeIn(e,200))}}),fadeIn(e),i&&(g=null,d.target.getAttribute('data-caption')?g=d.target.getAttribute('data-caption'):d.target.getAttribute('title')?g=d.target.getAttribute('title'):d.target.getAttribute('alt')?g=d.target.getAttribute('alt'):g=d.target.getAttribute('src'),i.querySelector('.modal__caption--text').innerText=g,n.innerText=k+1+' / '+h),c&&b&&(c.style.zIndex=-1,c.style.opacity=0,b.style.zIndex=25,b.style.opacity=1)}),window.addEventListener('keydown',p)}),m?m.addEventListener('click',function(b){a&&a.prev()}):null,o?o.addEventListener('click',function(b){a&&a.next()}):null,l?l.addEventListener('click',function(){a&&(a.kill(),a=null),k(),MicroModal.close('modal')}):null,b?b.addEventListener('click',function(a){t(),c&&(c.style.zIndex=25,c.style.opacity=1,b.style.zIndex=-1,b.style.opacity=0)}):null,c?c.addEventListener('click',function(a){k(),b&&(b.style.zIndex=25,b.style.opacity=1,c.style.zIndex=-1,c.style.opacity=0)}):null})</script>
<div class=hide>
<div class=search>
<span class=icon><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentcolor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49.0s.41-1.08.0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
</span>
<input id=search aria-label="Site Search" class=input type=text placeholder=搜索 autocomplete=off>
<div id=search-results class=dropdown>
<div id=search-menu class=dropdown-menu role=menu>
</div>
</div>
</div>
</div>
</div>
</main>
<aside class="single__side main-side">
<section class="sidebar hide">
<script>document.querySelector('.sidebar').classList.remove('hide')</script>
<div class=toc__flexbox data-position=fixed>
<h6 class=toc__title data-ani=true>目录</h6>
<label class=switch data-ani=true>
<input id=toggle-toc aria-label="Toggle TOC" type=checkbox checked>
<span class="slider round"></span>
</label>
</div>
<div class=toc data-dir=ltr data-folding=true data-ani=true>
<nav id=TableOfContents>
<ul>
<li>
<ul>
<li><a href=#前言>前言</a></li>
<li><a href=#第2章-渲染流水线>第2章 渲染流水线</a></li>
<li><a href=#第3章-unity-shader基础>第3章 Unity Shader基础</a></li>
<li><a href=#第4章-学习shader所需的数学基础>第4章 学习Shader所需的数学基础</a></li>
<li><a href=#第5章-开始unity-shader学习之旅>第5章 开始Unity Shader学习之旅</a></li>
<li><a href=#第6章-unity中的基础光照>第6章 Unity中的基础光照</a></li>
<li><a href=#第7章-基础纹理>第7章 基础纹理</a></li>
<li><a href=#第8章-透明效果>第8章 透明效果</a></li>
<li><a href=#第9章-更复杂的光照>第9章 更复杂的光照</a></li>
<li><a href=#第10章-高级纹理>第10章 高级纹理</a></li>
<li><a href=#第11章-让画面动起来>第11章 让画面动起来</a></li>
<li><a href=#第12章-屏幕后处理效果>第12章 屏幕后处理效果</a></li>
<li><a href=#第13章-使用深度和法线纹理>第13章 使用深度和法线纹理</a></li>
<li><a href=#第14章-非真实感渲染>第14章 非真实感渲染</a></li>
<li><a href=#第15章-使用噪声>第15章 使用噪声</a></li>
<li><a href=#第16章-unity中的渲染优化技术>第16章 Unity中的渲染优化技术</a></li>
<li><a href=#第17章-surface-shader探秘>第17章 Surface Shader探秘</a></li>
<li><a href=#第18章-基于物理的渲染>第18章 基于物理的渲染</a></li>
<li><a href=#前言-1>前言</a></li>
<li><a href=#第2章-渲染流水线-1>第2章 渲染流水线</a></li>
<li><a href=#第3章-unity-shader基础-1>第3章 Unity Shader基础</a></li>
<li><a href=#第4章-学习shader所需的数学基础-1>第4章 学习Shader所需的数学基础</a></li>
<li><a href=#第5章-开始unity-shader学习之旅-1>第5章 开始Unity Shader学习之旅</a></li>
<li><a href=#第6章-unity中的基础光照-1>第6章 Unity中的基础光照</a></li>
<li><a href=#第7章-基础纹理-1>第7章 基础纹理</a></li>
<li><a href=#第8章-透明效果-1>第8章 透明效果</a></li>
<li><a href=#第9章-更复杂的光照-1>第9章 更复杂的光照</a></li>
<li><a href=#第10章-高级纹理-1>第10章 高级纹理</a></li>
<li><a href=#第11章-让画面动起来-1>第11章 让画面动起来</a></li>
<li><a href=#第12章-屏幕后处理效果-1>第12章 屏幕后处理效果</a></li>
<li><a href=#第13章-使用深度和法线纹理-1>第13章 使用深度和法线纹理</a></li>
<li><a href=#第14章-非真实感渲染-1>第14章 非真实感渲染</a></li>
<li><a href=#第15章-使用噪声-1>第15章 使用噪声</a></li>
<li><a href=#第16章-unity中的渲染优化技术-1>第16章 Unity中的渲染优化技术</a></li>
<li><a href=#第17章-surface-shader探秘-1>第17章 Surface Shader探秘</a></li>
<li><a href=#第18章-基于物理的渲染-1>第18章 基于物理的渲染</a></li>
<li><a href=#第19章-unity-5更新了什么>第19章 Unity 5更新了什么</a></li>
<li><a href=#第19章-unity-5更新了什么-1>第19章 Unity 5更新了什么</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</section>
</aside>
<script>var enableToc=JSON.parse("true"),toc=JSON.parse("null"),tocPosition=JSON.parse('"inner"'),singleMainElem=document.querySelector('.single__main'),singleSideElem=document.querySelector('.single__side');enquire.register("screen and (max-width: 769px)",{match:function(){(enableToc||toc)&&tocPosition!=="outer"?singleMainElem&&singleSideElem&&(singleMainElem.classList.remove('main-main'),singleMainElem.classList.add('main'),singleSideElem.classList.remove('main-side'),singleSideElem.classList.add('hide')):tocPosition==="outer"&&(singleMainElem&&!singleMainElem.classList.contains('main-main')&&(singleMainElem.classList.remove('main-main'),singleMainElem.classList.add('main')),singleSideElem&&!singleSideElem.classList.contains('hide')&&singleSideElem.classList.add('hide'))},unmatch:function(){var b,a;(enableToc||toc)&&tocPosition!=="outer"?(singleMainElem.classList.remove('main'),singleMainElem.classList.add('main-main'),singleSideElem.classList.remove('hide'),singleSideElem.classList.add('main-side')):tocPosition==="outer"&&(singleMainElem&&!singleMainElem.classList.contains('main-main')&&(singleMainElem.classList.remove('main-main'),singleMainElem.classList.add('main')),singleSideElem&&!singleSideElem.classList.contains('hide')&&singleSideElem.classList.add('hide')),b=document.querySelector('.navbar__burger'),a=document.getElementsByClassName('navbarm__collapse')[0],a&&(a.setAttribute('data-open',!1),a.style.maxHeight=0,b.classList.remove('is-active')),document.getElementsByClassName('navbar__menu')[0].classList.remove('is-active'),document.getElementsByClassName('mobile-search')[0].classList.add('hide')},setup:function(){},deferSetup:!0,destroy:function(){}})</script>
<script defer src=/js/helper/getParents.min.js></script>
<script defer src=/js/helper/closest.min.js></script>
<script defer src=/js/helper/prev.min.js></script>
<script defer src=/js/helper/prop.min.js></script>
<script defer src=/js/helper/fadeinout.min.js></script>
<script defer src=/js/helper/throttle.min.js></script>
<script>'use strict';window.onload=function(){var f=document.querySelector('.navbar'),D=document.querySelector('.single__contents'),E=JSON.parse("false"),J=JSON.parse("true"),s,H,F,L,k,j,A,g,u,x,d,e,l,i,I,C,K,v,N,y,r,z,b,w,t,M,h,c,G,a,m,n,o,p,B,q;E&&J&&(s=document.querySelector('#busuanzi_value_page_pv'),s.textContent=s.textContent.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")),H=JSON.parse("true"),F=JSON.parse("null"),L=JSON.parse("false"),k=document.querySelector('.toc__flexbox'),j=document.querySelector('.toc__flexbox--outer'),A=JSON.parse("true"),(H||F)&&document.querySelector('.toc')&&(g=document.querySelector('.toc').querySelector('#TableOfContents'),g.onmouseenter=function(){f.classList.contains('scrolling')&&f.classList.remove('scrolling')},g.onmouseleave=function(){f.classList.contains('scrolling')||f.classList.add('scrolling')},!1===A||(g.querySelectorAll('ul')?g.querySelectorAll('ul').forEach(function(a){a.querySelectorAll('li').forEach(function(a){a.querySelectorAll('ul').forEach(function(a){a.style.display='none'})})}):null),g&&(g.querySelectorAll('a').length>0?g.querySelectorAll('a').forEach(function(a){a.addEventListener('click',function(){var c=a.getAttribute('id'),b;f.classList.contains('scrolling')||(f.classList.remove('navbar--show'),f.classList.remove('navbar--hide'),f.classList.add('navbar--hide')),document.querySelector('.toc').querySelectorAll('a').forEach(function(a){a.classList.remove('active')}),a.classList.add('active'),b=g.querySelector('[href="#'+c+'"]'),b&&b.nextElementSibling&&(b.nextElementSibling.style.display='block'),b&&(getParents(b,'ul')?getParents(b,'ul').forEach(function(a){a.style.display='block'}):null)})}):(k&&(k.setAttribute('data-position',''),k.classList.contains('hide')||k.classList.add('hide')),j&&(j.setAttribute('data-position',''),j.classList.contains('hide')||j.classList.add('hide')))),u=document.getElementById("toggle-toc"),x=document.getElementById('visible-toc'),d=document.querySelector('.toc'),e=document.querySelector('main'),l=document.querySelector('side'),i=document.querySelector('.toc__flexbox'),u?u.addEventListener('change',function(a){a.target.checked?(d&&fadeIn(d,200),i&&i.setAttribute('data-position','fixed'),e&&(e.classList.remove('main-main'),e.classList.remove('main'),e.classList.add('main-main')),l&&l.classList.remove('main-side')):(d&&fadeOut(d,200),i&&i.setAttribute('data-position','absolute'),e&&(e.classList.remove('main-main'),e.classList.remove('main'),e.classList.add('main')),l&&l.classList.remove('main-side'))}):null,x?x.addEventListener('change',function(a){a.target.checked?d&&fadeIn(d,200):d&&fadeOut(d,200)}):null),I=120,C=70,K=function(){d&&(d.style.maxHeight=window.innerHeight-I-C+'px')},v=throttle(K,300),v(),window.addEventListener('resize',v),y=new ClipboardJS('.anchor'),r=D.querySelectorAll("h1, h2, h3, h4"),z=JSON.parse('"ltr"'),r?r.forEach(function(c){var d=parseInt(c.tagName.substr(1),10)*2,e=encodeURI(document.location.origin+document.location.pathname),f=e+"#"+c.getAttribute('id'),b=document.createElement('span'),a;b.classList.add('anchor'),b.classList.add('hide'),b.setAttribute('data-clipboard-text',decodeURI(f)),b.style.position='relative',a=document.createElement('span'),a.style.position='absolute',a.style.top='50%',a.style.left='0.75rem',a.style.transform='translateY(-50%)',a.innerHTML=`
<svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="${32-d}px" height="${32-d}px"><path d="M 5.5625 0 C 4.136719 0 2.707031 0.542969 1.625 1.625 C -0.539063 3.789063 -0.539063 7.335938 1.625 9.5 L 5.28125 13.15625 C 5.667969 13.554688 6.304688 13.558594 6.703125 13.171875 C 7.101563 12.785156 7.105469 12.148438 6.71875 11.75 L 3.03125 8.0625 C 1.632813 6.664063 1.632813 4.429688 3.03125 3.03125 C 4.429688 1.632813 6.664063 1.632813 8.0625 3.03125 L 12.96875 7.9375 C 14.367188 9.335938 14.367188 11.570313 12.96875 12.96875 C 12.804688 13.132813 12.621094 13.25 12.4375 13.375 C 11.980469 13.6875 11.859375 14.308594 12.171875 14.765625 C 12.484375 15.222656 13.105469 15.34375 13.5625 15.03125 C 13.847656 14.835938 14.125 14.625 14.375 14.375 C 16.539063 12.210938 16.539063 8.664063 14.375 6.5 L 9.5 1.625 C 8.417969 0.542969 6.988281 0 5.5625 0 Z M 10.78125 8.875 C 10.738281 8.882813 10.695313 8.894531 10.65625 8.90625 C 10.507813 8.9375 10.371094 9 10.25 9.09375 C 10.039063 9.253906 9.820313 9.429688 9.625 9.625 C 7.460938 11.789063 7.460938 15.335938 9.625 17.5 L 14.5 22.375 C 16.664063 24.539063 20.210938 24.539063 22.375 22.375 C 24.539063 20.210938 24.539063 16.664063 22.375 14.5 L 18.71875 10.875 C 18.476563 10.578125 18.089844 10.441406 17.714844 10.527344 C 17.34375 10.613281 17.050781 10.90625 16.964844 11.277344 C 16.878906 11.652344 17.015625 12.039063 17.3125 12.28125 L 20.96875 15.9375 C 22.367188 17.335938 22.367188 19.570313 20.96875 20.96875 C 19.570313 22.367188 17.335938 22.367188 15.9375 20.96875 L 11.03125 16.0625 C 9.632813 14.664063 9.632813 12.429688 11.03125 11.03125 C 11.152344 10.90625 11.300781 10.820313 11.4375 10.71875 C 11.839844 10.472656 12.015625 9.976563 11.855469 9.53125 C 11.699219 9.085938 11.25 8.8125 10.78125 8.875 Z"/></svg>`,z==="rtl"?a.style.left='-2rem':a.style.right='-2rem',b.append(a),c.append(b),c.addEventListener('mouseenter',function(){this.querySelector('.anchor').classList.remove('hide')}),c.addEventListener('mouseleave',function(){this.querySelector('.anchor').classList.add('hide')})}):null,document.querySelectorAll('.anchor').forEach(function(a){a.addEventListener('mouseleave',function(){a.setAttribute('aria-label',null),a.classList.remove('tooltipped'),a.classList.remove('tooltipped-s'),a.classList.remove('tooltipped-w')})}),y.on('success',function(a){a.clearSelection(),a.trigger.setAttribute('aria-label','Link copied to clipboard!'),a.trigger.classList.add('tooltipped'),a.trigger.classList.add('tooltipped-s')}),b=JSON.parse("null"),b&&b.includes('mermaid')&&(w=localStorage.getItem('theme')||JSON.parse('"dark"'),w==="dark"||w==="hacker"?mermaid.initialize({theme:'dark'}):mermaid.initialize({theme:'default'}),t=[],[].push.apply(t,document.getElementsByClassName('language-mermaid')),t.forEach(function(b){var a=b.parentNode,c;a!==document.body&&(a.parentNode.insertBefore(b,a),a.parentNode.removeChild(a)),c=document.createElement('div'),c.classList.add('mermaid'),c.style.padding='34px 4px 6px',c.innerHTML=b.innerHTML,b.replaceWith(c)})),b&&b.includes('katex')&&(M=document.getElementsByClassName('math'),h={delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]},renderMathInElement(document.querySelector('.single__contents'),h)),b&&b.includes('flowchartjs')&&(h=JSON.parse('{"arrow-end":"block","element-color":"black","fill":"white","flowstate":{"approved":{"fill":"#58C4A3","font-size":12,"no-text":"n/a","yes-text":"APPROVED"},"current":{"fill":"yellow","font-color":"red","font-weight":"bold"},"future":{"fill":"#FFFF99"},"invalid":{"fill":"#444444"},"past":{"fill":"#CCCCCC","font-size":12},"rejected":{"fill":"#C45879","font-size":12,"no-text":"REJECTED","yes-text":"n/a"},"request":{"fill":"blue"}},"font-color":"black","font-size":14,"line-color":"black","line-length":50,"line-width":3,"no-text":"no","scale":1,"symbols":{"end":{"class":"end-element"},"start":{"element-color":"green","fill":"yellow","font-color":"red"}},"text-margin":10,"x":0,"y":0,"yes-text":"yes"}'),c=null,G="language-flowchart",a=0,Array.prototype.forEach.call(document.querySelectorAll("[class^="+G+"]"),function(b){var d,e;b.style.display='none',b.parentNode.style.backgroundColor="transparent",c=b.innerText,d=document.createElement('div'),d.id='flowchart'+a,b.parentNode.insertBefore(d,b),e=flowchart.parse(c),e.drawSVG("flowchart"+a,h),a+=1})),document.querySelectorAll("mjx-container").forEach(function(a){a.parentElement.classList+='has-jax'}),b&&b.includes('msc')&&(h=JSON.parse('{"theme":"hand"}'),c=null,a=0,m="language-msc",Array.prototype.forEach.call(document.querySelectorAll("[class^="+m+"]"),function(b){var d,e;b.style.display='none',b.parentNode.style.backgroundColor="transparent",c=b.innerText,d=document.createElement('div'),d.id='msc'+a,b.parentNode.insertBefore(d,b),e=Diagram.parse(c),e.drawSVG("msc"+a,h),a+=1})),b&&b.includes('chart')&&(n="#666",o="#ddd",p=2,Chart.defaults.global.elements.rectangle.borderWidth=p,Chart.defaults.global.elements.rectangle.borderColor=n,Chart.defaults.global.elements.rectangle.backgroundColor=o,Chart.defaults.global.elements.line.borderWidth=p,Chart.defaults.global.elements.line.borderColor=n,Chart.defaults.global.elements.line.backgroundColor=o,Chart.defaults.global.elements.point.borderWidth=p,Chart.defaults.global.elements.point.borderColor=n,Chart.defaults.global.elements.point.backgroundColor=o,m="language-chart",a=0,c=null,Array.prototype.forEach.call(document.querySelectorAll("[class^="+m+"]"),function(b){var d,e,f,g;b.style.display='none',b.parentNode.style.backgroundColor="transparent",c=b.innerText,d=document.createElement('canvas'),e=null,d.height=200,d.style.height=200,d.id='myChart'+a,e=JSON.parse(c),b.parentNode.insertBefore(d,b),f=document.getElementById('myChart'+a).getContext('2d'),g=new Chart(f,e),a+=1})),b&&b.includes('wavedrom')&&(B="language-wave",a=0,c=null,Array.prototype.forEach.call(document.querySelectorAll("[class^="+B+"]"),function(b){var d,e;b.style.display='none',b.parentNode.style.backgroundColor="transparent",c=b.innerText,d=document.createElement('div'),e=null,d.id='WaveDrom_Display_'+a,e=JSON.parse(c),b.parentNode.insertBefore(d,b),WaveDrom.RenderWaveForm(a,e,"WaveDrom_Display_"),a+=1})),b&&b.includes('viz')&&(q="language-viz-",Array.prototype.forEach.call(document.querySelectorAll("[class^="+q+"]"),function(a){var b,c;a.style.display='none',a.parentNode.style.backgroundColor="transparent",a.getAttribute("class").split(" ").forEach(function(a){a.startsWith(q)&&(b=a.substr(q.length))}),c=new Viz,c.renderSVGElement(a.innerText,{engine:b}).then(function(b){b.style.width="100%",a.parentNode.insertBefore(b,a)})}))}</script>
<footer class=footer>
<div id=gtt>
<div class=gtt><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentcolor" d="M8.12 14.71 12 10.83l3.88 3.88c.39.39 1.02.39 1.41.0s.39-1.02.0-1.41L12.7 8.71c-.39-.39-1.02-.39-1.41.0L6.7 13.3c-.39.39-.39 1.02.0 1.41.39.38 1.03.39 1.42.0z"/></svg>
</div>
</div>
<hr>
<div class="basicflex flexwrap">
</div>
<div class=footer__poweredby>
<p class=caption>
©2021, All Rights Reserved
</p>
<p class=caption>Powered by <a href=https://gohugo.io/ target=_blank rel=noreferrer>Hugo</a> and the <a href=https://github.com/zzossig/hugo-theme-zzo target=_blank rel=noreferrer>Zzo theme</a></p>
</div>
</footer>
</div>
<div class="wrapper__right hide" data-pad=true dir=ltr>
<script>document.querySelector('.wrapper__right').classList.remove('hide')</script>
</div>
</div>
</body>
<script src=L2Dwidget.min.js></script>
<script>L2Dwidget.init({model:{jsonPath:"https://cdn.jsdelivr.net/gh/wangsrGit119/wangsr-image-bucket/L2Dwidget/live2d-widget-model-hijiki/assets/hijiki.model.json"},display:{position:"right",width:100,height:175,hOffset:-10,vOffset:-50},mobile:{show:!0,scale:.5},react:{opacityDefault:1,opacityOnHover:.2}})</script>
</html>